[2025-12-23 00:01:07.119] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:01:07.433] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:01:07.452] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:01:07.558] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:01:07.560] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:01:07.634] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:01:07.636] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:01:07.637] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:01:07.978] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:01:08.085] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 107.4468ms
[2025-12-23 00:01:08.099] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:01:08.099] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:01:08.107] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 8.0726ms
[2025-12-23 00:01:08.123] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 23.9694ms
[2025-12-23 00:01:08.557] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:01:08.596] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 39.0298ms
[2025-12-23 00:01:12.667] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:01:12.667] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:01:12.667] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:01:12.675] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:12.675] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:12.675] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:12.678] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 11.0545ms
[2025-12-23 00:01:12.678] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 11.0534ms
[2025-12-23 00:01:12.678] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 11.163ms
[2025-12-23 00:01:12.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:01:12.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:01:12.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:01:12.694] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:12.695] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:12.697] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:12.759] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:01:12.759] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:01:12.760] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:01:12.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:01:12.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:01:12.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:01:13.010] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:01:13.012] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:13.013] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:13.017] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.9124ms
[2025-12-23 00:01:13.018] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:13.020] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:01:13.023] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 10.9901ms
[2025-12-23 00:01:13.025] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:13.026] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:13.032] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:13.037] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:13.037] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:13.053] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:13.053] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (28ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (34ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.365] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.365] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.372] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.372] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.378] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.378] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.400] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:01:14.400] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:01:14.407] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:14.407] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:01:14.440] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:01:14.440] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:01:14.449] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:14.449] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:14.449] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:01:14.463] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1235.8799ms
[2025-12-23 00:01:14.463] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1232.4695ms
[2025-12-23 00:01:14.466] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.467] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.473] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:14.473] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:14.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 1454.6374ms
[2025-12-23 00:01:14.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 1449.5426ms
[2025-12-23 00:01:14.477] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.479] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.488] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 15.3038ms
[2025-12-23 00:01:14.489] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 16.0028ms
[2025-12-23 00:01:14.491] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:14.491] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:14.499] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.501] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.503] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.503] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.505] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.507] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:01:14.507] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:01:14.508] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.510] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.510] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.518] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:01:14.520] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.521] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 1733.5688ms
[2025-12-23 00:01:14.521] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 1735.1614ms
[2025-12-23 00:01:14.523] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:01:14.524] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:01:14.525] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 1844.0869ms
[2025-12-23 00:01:14.525] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 1740.9453ms
[2025-12-23 00:01:14.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 1845.2095ms
[2025-12-23 00:01:14.530] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:01:14.534] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 1852.6544ms
[2025-12-23 00:01:14.548] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-11-30T21:00:00.0000000Z", Kind: "Utc", Local: "2025-12-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:01:14.550] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.552] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2025-12-31T23:59:59.9990000+03:00", Year: 2025
[2025-12-23 00:01:14.554] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.556] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.559] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.561] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.563] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:14.566] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:01:14.567] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:14.568] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 61.0319ms
[2025-12-23 00:01:14.570] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.570] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.571] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 80.4607ms
[2025-12-23 00:01:14.573] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 61.5074ms
[2025-12-23 00:01:14.575] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.576] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 84.781ms
[2025-12-23 00:01:14.579] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:14.579] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:14.581] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.583] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.584] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.5151ms
[2025-12-23 00:01:14.585] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.586] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:14.588] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.590] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.592] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.593] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.593] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.596] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-10-31T21:00:00.0000000Z", Kind: "Utc", Local: "2025-11-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:01:14.598] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.599] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-11-30T20:59:59.9990000Z", Kind: "Utc", Local: "2025-11-30T23:59:59.9990000+03:00", Year: 2025
[2025-12-23 00:01:14.601] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.602] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.604] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.605] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.607] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:14.608] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.0227ms
[2025-12-23 00:01:14.610] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:01:14.610] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.611] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:14.612] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 26.4238ms
[2025-12-23 00:01:14.613] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.3787ms
[2025-12-23 00:01:14.617] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.618] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 38.4594ms
[2025-12-23 00:01:14.621] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:14.621] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:01:14.623] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.626] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.627] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 5.6133ms
[2025-12-23 00:01:14.627] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 6.3943ms
[2025-12-23 00:01:14.629] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:01:14.629] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:14.635] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.637] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.638] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.638] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.639] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.640] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.644] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.644] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.646] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.649] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.650] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.651] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.653] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.654] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:14.657] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:14.658] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:14.659] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:01:14.660] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:01:14.661] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:14.662] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:14.663] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.3191ms
[2025-12-23 00:01:14.665] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.9839ms
[2025-12-23 00:01:14.665] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.666] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:14.667] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 37.9495ms
[2025-12-23 00:01:14.668] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 38.8132ms
[2025-12-23 00:01:14.671] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:01:14.675] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.676] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.3159ms
[2025-12-23 00:01:14.677] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:01:14.681] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.682] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:01:14.687] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:01:14.722] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:01:14.723] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.726] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 37.4671ms
[2025-12-23 00:01:14.727] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:01:14.728] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 50.8139ms
[2025-12-23 00:01:14.732] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:01:14.735] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.736] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 4.0701ms
[2025-12-23 00:01:14.738] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:01:14.741] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.742] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:01:14.746] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.766] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:01:14.769] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.773] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 24.3142ms
[2025-12-23 00:01:14.774] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:01:14.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 36.3331ms
[2025-12-23 00:01:14.778] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:14.780] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.781] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.9348ms
[2025-12-23 00:01:14.783] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:14.787] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.788] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.789] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.791] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2015-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2015-12-23T00:00:00.0000000+03:00", Year: 2015
[2025-12-23 00:01:14.793] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2035-12-23T20:59:59.9990000Z", Kind: "Utc", Local: "2035-12-23T23:59:59.9990000+03:00", Year: 2035
[2025-12-23 00:01:14.795] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.800] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.272ms
[2025-12-23 00:01:14.801] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.802] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 18.7682ms
[2025-12-23 00:01:14.804] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:14.806] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.807] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.5215ms
[2025-12-23 00:01:14.809] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:14.811] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:14.813] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.813] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:14.816] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2023-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2023-12-23T00:00:00.0000000+03:00", Year: 2023
[2025-12-23 00:01:14.818] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", Year: 2026
[2025-12-23 00:01:14.821] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:14.823] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:14.824] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.4902ms
[2025-12-23 00:01:14.826] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:14.827] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 18.1572ms
[2025-12-23 00:01:18.006] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2024-12-31T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:18.009] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:18.010] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2024-12-31T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 3.3888ms
[2025-12-23 00:01:18.012] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2024-12-31T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:18.015] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:18.017] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:18.018] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:18.021] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2024-12-31T21:00:00.0000000Z", Kind: "Utc", Local: "2025-01-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:01:18.022] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2025-12-31T23:59:59.9990000+03:00", Year: 2025
[2025-12-23 00:01:18.025] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:18.027] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:18.029] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.2781ms
[2025-12-23 00:01:18.030] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:18.030] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2024-12-31T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 18.7899ms
[2025-12-23 00:01:22.108] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-31T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:22.110] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:22.111] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-31T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.2751ms
[2025-12-23 00:01:22.113] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-31T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:22.117] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:22.118] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:22.119] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:22.123] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-12-31T21:00:00.0000000Z", Kind: "Utc", Local: "2026-01-01T00:00:00.0000000+03:00", Year: 2026
[2025-12-23 00:01:22.124] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", Year: 2026
[2025-12-23 00:01:22.127] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:22.129] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:22.130] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.0527ms
[2025-12-23 00:01:22.132] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:22.133] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-31T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 19.6665ms
[2025-12-23 00:01:23.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:23.529] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:23.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.5286ms
[2025-12-23 00:01:23.533] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:23.535] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:23.537] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:23.538] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:23.540] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2023-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2023-12-23T00:00:00.0000000+03:00", Year: 2023
[2025-12-23 00:01:23.541] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", Year: 2026
[2025-12-23 00:01:23.544] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:23.546] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:23.547] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.1578ms
[2025-12-23 00:01:23.548] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:23.549] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 16.7561ms
[2025-12-23 00:01:39.901] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:01:39.904] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:39.905] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 3.3026ms
[2025-12-23 00:01:39.906] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:01:39.910] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:39.911] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:01:39.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:01:39.930] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:39.950] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:01:40.015] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:01:40.018] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:40.022] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 102.0934ms
[2025-12-23 00:01:40.023] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:01:40.024] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 117.5958ms
[2025-12-23 00:01:40.026] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:01:40.028] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:40.029] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 2.6397ms
[2025-12-23 00:01:40.030] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:01:40.034] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:40.035] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:01:40.035] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:01:40.040] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:40.046] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:01:40.049] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:01:40.051] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:40.052] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 14.9806ms
[2025-12-23 00:01:40.053] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:01:40.053] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 22.9867ms
[2025-12-23 00:01:40.056] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:01:40.058] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:40.059] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 2.5941ms
[2025-12-23 00:01:40.060] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:01:40.063] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:40.064] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:01:40.069] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:01:40.079] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:40.095] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:01:40.123] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 24, Страница: 1
[2025-12-23 00:01:40.124] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:40.132] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 62.593ms
[2025-12-23 00:01:40.134] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:01:40.134] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 74.2555ms
[2025-12-23 00:01:41.802] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:01:41.805] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:41.805] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.807] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.808] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 5.3572ms
[2025-12-23 00:01:41.809] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 3.9381ms
[2025-12-23 00:01:41.812] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:01:41.812] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:41.818] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.820] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.821] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.821] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.822] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.823] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.828] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.829] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.830] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.833] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.834] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.836] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.837] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.840] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.840] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:01:41.843] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:01:41.845] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:41.845] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:41.846] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.8377ms
[2025-12-23 00:01:41.848] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:01:41.849] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.850] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:41.851] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 39.0219ms
[2025-12-23 00:01:41.852] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 26.0914ms
[2025-12-23 00:01:41.856] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.856] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 44.6474ms
[2025-12-23 00:01:41.860] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:41.860] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:41.862] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.863] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.864] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 4.0436ms
[2025-12-23 00:01:41.865] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 4.6392ms
[2025-12-23 00:01:41.867] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:41.867] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:41.872] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.874] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.875] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:41.875] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.876] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.877] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.879] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-11-30T21:00:00.0000000Z", Kind: "Utc", Local: "2025-12-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:01:41.881] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2025-12-31T23:59:59.9990000+03:00", Year: 2025
[2025-12-23 00:01:41.882] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.885] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.885] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.888] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:41.890] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.890] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.1267ms
[2025-12-23 00:01:41.892] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:41.893] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.893] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 26.8358ms
[2025-12-23 00:01:41.896] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:41.899] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:01:41.900] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:41.901] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.9085ms
[2025-12-23 00:01:41.902] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.903] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 36.1917ms
[2025-12-23 00:01:41.906] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:41.906] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:41.907] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.909] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.909] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 3.8972ms
[2025-12-23 00:01:41.910] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.911] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:01:41.913] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.915] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.918] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:41.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.919] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.921] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-10-31T21:00:00.0000000Z", Kind: "Utc", Local: "2025-11-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:01:41.923] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.923] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-11-30T20:59:59.9990000Z", Kind: "Utc", Local: "2025-11-30T23:59:59.9990000+03:00", Year: 2025
[2025-12-23 00:01:41.925] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.927] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.928] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.929] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:41.931] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.0818ms
[2025-12-23 00:01:41.932] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:41.932] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:41.934] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:01:41.935] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 23.7048ms
[2025-12-23 00:01:41.936] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:41.939] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.6569ms
[2025-12-23 00:01:41.940] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 34.5607ms
[2025-12-23 00:01:41.943] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:41.943] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:01:41.945] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.947] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 4.521ms
[2025-12-23 00:01:41.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 5.176ms
[2025-12-23 00:01:41.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:41.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:01:41.956] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.957] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.958] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.959] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.959] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.960] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:41.964] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.965] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.967] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.969] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:41.970] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.971] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.973] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.974] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:01:41.976] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:41.978] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:01:41.979] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:01:41.980] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:01:41.981] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:41.982] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:01:41.983] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.4903ms
[2025-12-23 00:01:41.984] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 20.9719ms
[2025-12-23 00:01:41.985] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.985] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:01:41.986] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 36.4195ms
[2025-12-23 00:01:41.987] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 36.868ms
[2025-12-23 00:01:41.991] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:01:41.993] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:41.994] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 2.4866ms
[2025-12-23 00:01:41.995] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:01:41.999] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.000] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:01:42.000] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:42.012] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:01:42.014] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:01:42.015] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:42.017] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 14.7425ms
[2025-12-23 00:01:42.018] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:01:42.018] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 23.3648ms
[2025-12-23 00:01:42.021] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:01:42.023] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.023] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.4142ms
[2025-12-23 00:01:42.025] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:01:42.027] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.028] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:01:42.029] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:42.038] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:01:42.040] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:42.041] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 10.4737ms
[2025-12-23 00:01:42.042] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:01:42.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 18.0552ms
[2025-12-23 00:01:42.054] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:42.056] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 3.0217ms
[2025-12-23 00:01:42.058] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:01:42.061] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.062] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:42.063] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:42.066] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2015-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2015-12-23T00:00:00.0000000+03:00", Year: 2015
[2025-12-23 00:01:42.068] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2035-12-23T20:59:59.9990000Z", Kind: "Utc", Local: "2035-12-23T23:59:59.9990000+03:00", Year: 2035
[2025-12-23 00:01:42.071] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:42.072] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:42.074] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.8943ms
[2025-12-23 00:01:42.075] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:42.076] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 17.375ms
[2025-12-23 00:01:42.079] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:42.082] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.083] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.4202ms
[2025-12-23 00:01:42.085] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:01:42.088] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:01:42.089] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:42.090] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:01:42.092] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2023-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2023-12-23T00:00:00.0000000+03:00", Year: 2023
[2025-12-23 00:01:42.094] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", Year: 2026
[2025-12-23 00:01:42.096] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:01:42.099] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:01:42.100] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.7519ms
[2025-12-23 00:01:42.101] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:01:42.102] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 17.5104ms
[2025-12-23 00:08:02.254] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:08:02.465] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:08:02.485] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:08:02.569] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:08:02.570] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:08:02.636] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:08:02.638] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:08:02.638] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:08:02.663] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:08:02.726] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:02.726] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:08:02.735] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:02.735] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:02.738] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 11.8477ms
[2025-12-23 00:08:02.738] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 11.817ms
[2025-12-23 00:08:02.742] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:08:02.742] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:02.751] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:02.751] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:02.784] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 122.5988ms
[2025-12-23 00:08:02.795] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:08:02.795] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:08:02.803] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 7.6441ms
[2025-12-23 00:08:02.811] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:02.811] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:02.821] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.9654ms
[2025-12-23 00:08:02.834] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:02.834] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:03.198] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:08:03.225] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 27.1329ms
[2025-12-23 00:08:03.718] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:03.718] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:03.753] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:03.753] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:03.761] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:03.761] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:03.768] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:03.768] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:03.796] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:03.796] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:03.800] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:08:03.800] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:08:03.805] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:03.805] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:03.817] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 977.2322ms
[2025-12-23 00:08:03.817] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 978.6836ms
[2025-12-23 00:08:03.818] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:03.818] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:03.823] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:08:03.823] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 1081.1482ms
[2025-12-23 00:08:03.823] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 1081.1991ms
[2025-12-23 00:08:03.825] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:03.829] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.8171ms
[2025-12-23 00:08:03.831] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:08:03.833] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:03.836] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:08:03.840] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:03.934] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:08:03.939] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:08:03.940] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:03.945] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 104.0881ms
[2025-12-23 00:08:03.947] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:08:03.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 116.9028ms
[2025-12-23 00:08:03.951] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:08:03.954] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:03.954] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.9504ms
[2025-12-23 00:08:03.956] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:08:03.959] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:03.960] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:08:03.964] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:03.982] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:08:03.984] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:03.987] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 21.2328ms
[2025-12-23 00:08:03.988] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:08:03.989] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 32.8506ms
[2025-12-23 00:08:03.992] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:03.993] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:03.994] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.1729ms
[2025-12-23 00:08:03.995] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:03.998] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:03.999] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:04.003] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:04.009] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2015-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2015-12-23T00:00:00.0000000+03:00", DateOnly: "2015-12-23T00:00:00.0000000+03:00", Year: 2015
[2025-12-23 00:08:04.011] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2035-12-23T20:59:59.9990000Z", Kind: "Utc", Local: "2035-12-23T23:59:59.9990000+03:00", DateOnly: "2035-12-23T23:59:59.9999999+03:00", Year: 2035
[2025-12-23 00:08:04.043] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:04.076] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:04.077] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 73.6068ms
[2025-12-23 00:08:04.079] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:04.080] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 84.8411ms
[2025-12-23 00:08:04.086] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:04.088] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:04.088] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.2345ms
[2025-12-23 00:08:04.090] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:04.091] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:04.092] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:04.093] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:04.095] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2023-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2023-12-23T00:00:00.0000000+03:00", DateOnly: "2023-12-23T00:00:00.0000000+03:00", Year: 2023
[2025-12-23 00:08:04.096] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", DateOnly: "2026-12-31T23:59:59.9999999+03:00", Year: 2026
[2025-12-23 00:08:04.099] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:04.103] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:04.104] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.8436ms
[2025-12-23 00:08:04.105] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:04.105] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 15.6707ms
[2025-12-23 00:08:06.396] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:08:06.398] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:08:06.398] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:08:06.401] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.403] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.406] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.406] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 10.0969ms
[2025-12-23 00:08:06.407] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 9.0012ms
[2025-12-23 00:08:06.408] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 9.9752ms
[2025-12-23 00:08:06.410] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:08:06.410] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:08:06.410] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:08:06.420] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.421] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.423] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.424] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:08:06.424] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:08:06.425] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:08:06.431] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:08:06.431] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:08:06.432] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:08:06.531] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.531] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.537] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.567] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:08:06.567] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:08:06.577] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:08:06.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:08:06.633] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:06.635] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.637] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.638] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.097ms
[2025-12-23 00:08:06.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 6.4642ms
[2025-12-23 00:08:06.641] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:08:06.641] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:06.647] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:08:06.648] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:08:06.650] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.653] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.655] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:06.656] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:06.657] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.657] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.660] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:08:06.660] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.661] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.662] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 225.6372ms
[2025-12-23 00:08:06.662] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 226.5584ms
[2025-12-23 00:08:06.663] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:06.668] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:08:06.669] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:08:06.669] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.671] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 260.2062ms
[2025-12-23 00:08:06.672] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 261.5398ms
[2025-12-23 00:08:06.673] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.673] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 240.0547ms
[2025-12-23 00:08:06.675] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.681] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:08:06.684] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 273.6763ms
[2025-12-23 00:08:06.684] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.685] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.690] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.692] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.694] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:06.697] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.698] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:08:06.701] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:06.703] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 36.6172ms
[2025-12-23 00:08:06.704] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.706] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 64.1535ms
[2025-12-23 00:08:06.707] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:08:06.710] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:08:06.711] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:06.713] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 47.893ms
[2025-12-23 00:08:06.715] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.716] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 74.4937ms
[2025-12-23 00:08:06.720] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:06.720] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:06.722] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.724] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.724] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 4.6819ms
[2025-12-23 00:08:06.725] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.4771ms
[2025-12-23 00:08:06.727] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:06.727] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:06.733] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.734] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.735] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.736] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.736] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.738] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.741] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-11-30T21:00:00.0000000Z", Kind: "Utc", Local: "2025-12-01T00:00:00.0000000+03:00", DateOnly: "2025-12-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:08:06.741] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.743] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2025-12-31T23:59:59.9990000+03:00", DateOnly: "2025-12-31T23:59:59.9999999+03:00", Year: 2025
[2025-12-23 00:08:06.746] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.750] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.750] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:06.753] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.757] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:06.759] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.1737ms
[2025-12-23 00:08:06.760] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:06.761] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.762] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:08:06.763] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 36.0108ms
[2025-12-23 00:08:06.764] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:06.768] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.628ms
[2025-12-23 00:08:06.770] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.770] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 43.8499ms
[2025-12-23 00:08:06.773] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:06.773] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:06.776] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.777] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.778] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.3769ms
[2025-12-23 00:08:06.779] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.780] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:06.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.784] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.786] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.787] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.788] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.790] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-10-31T21:00:00.0000000Z", Kind: "Utc", Local: "2025-11-01T00:00:00.0000000+03:00", DateOnly: "2025-11-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:08:06.792] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.792] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-11-30T20:59:59.9990000Z", Kind: "Utc", Local: "2025-11-30T23:59:59.9990000+03:00", DateOnly: "2025-11-30T23:59:59.9999999+03:00", Year: 2025
[2025-12-23 00:08:06.794] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.798] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:06.798] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.803] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:06.805] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.1773ms
[2025-12-23 00:08:06.805] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:06.806] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.808] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:08:06.808] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 28.3878ms
[2025-12-23 00:08:06.809] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:06.813] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.2472ms
[2025-12-23 00:08:06.814] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.815] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 41.7517ms
[2025-12-23 00:08:06.820] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:08:06.820] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:06.822] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.824] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.825] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.825] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.826] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.827] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.830] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.832] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.834] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.836] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:06.838] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.841] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.842] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.844] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:06.846] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:06.849] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:08:06.851] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:06.852] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.3988ms
[2025-12-23 00:08:06.854] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.855] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 34.9652ms
[2025-12-23 00:08:06.869] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:06.871] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:08:06.872] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:06.874] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.3986ms
[2025-12-23 00:08:06.875] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:06.876] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 56.0802ms
[2025-12-23 00:08:06.881] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:08:06.884] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.886] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:08:06.887] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.893] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:08:06.895] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:08:06.897] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:06.898] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 9.7424ms
[2025-12-23 00:08:06.900] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:08:06.901] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 20.3857ms
[2025-12-23 00:08:06.904] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:08:06.908] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.909] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:08:06.910] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.915] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:08:06.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:06.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 10.1855ms
[2025-12-23 00:08:06.923] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:08:06.924] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 20.0052ms
[2025-12-23 00:08:06.928] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:06.931] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.933] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.935] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.939] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2015-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2015-12-23T00:00:00.0000000+03:00", DateOnly: "2015-12-23T00:00:00.0000000+03:00", Year: 2015
[2025-12-23 00:08:06.941] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2035-12-23T20:59:59.9990000Z", Kind: "Utc", Local: "2035-12-23T23:59:59.9990000+03:00", DateOnly: "2035-12-23T23:59:59.9999999+03:00", Year: 2035
[2025-12-23 00:08:06.945] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:06.962] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:06.964] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 27.1339ms
[2025-12-23 00:08:06.965] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.967] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 38.7563ms
[2025-12-23 00:08:06.970] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:06.972] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:06.974] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.975] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:06.978] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2023-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2023-12-23T00:00:00.0000000+03:00", DateOnly: "2023-12-23T00:00:00.0000000+03:00", Year: 2023
[2025-12-23 00:08:06.980] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", DateOnly: "2026-12-31T23:59:59.9999999+03:00", Year: 2026
[2025-12-23 00:08:06.985] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:06.992] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:06.993] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.1008ms
[2025-12-23 00:08:06.995] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:06.996] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 25.2695ms
[2025-12-23 00:08:12.956] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:08:12.961] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:12.963] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 7.0318ms
[2025-12-23 00:08:12.965] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:08:12.969] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:12.971] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:08:12.976] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:08:12.987] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:08:12.988] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:13.002] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.004] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 17.012ms
[2025-12-23 00:08:13.005] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 17.7733ms
[2025-12-23 00:08:13.007] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:13.007] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:08:13.013] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.015] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.016] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.017] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.018] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.018] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.024] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.024] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.027] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.029] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.031] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.033] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.034] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.036] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.038] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:08:13.040] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:13.041] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:08:13.043] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:08:13.044] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:13.045] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:13.047] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.3297ms
[2025-12-23 00:08:13.049] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.8894ms
[2025-12-23 00:08:13.050] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.051] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 44.2647ms
[2025-12-23 00:08:13.053] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 45.4002ms
[2025-12-23 00:08:13.053] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:08:13.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:13.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:13.062] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.064] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.065] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 7.8679ms
[2025-12-23 00:08:13.066] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 8.548ms
[2025-12-23 00:08:13.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:13.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:13.073] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.076] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.077] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.077] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.078] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.080] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.084] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-11-30T21:00:00.0000000Z", Kind: "Utc", Local: "2025-12-01T00:00:00.0000000+03:00", DateOnly: "2025-12-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:08:13.086] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:08:13.086] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2025-12-31T23:59:59.9990000+03:00", DateOnly: "2025-12-31T23:59:59.9999999+03:00", Year: 2025
[2025-12-23 00:08:13.087] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.090] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 111.6286ms
[2025-12-23 00:08:13.092] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:08:13.092] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.093] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:13.093] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 127.7463ms
[2025-12-23 00:08:13.096] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.100] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:13.105] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.105] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 22.7995ms
[2025-12-23 00:08:13.108] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.108] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:13.109] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 40.8058ms
[2025-12-23 00:08:13.111] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:08:13.114] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:13.115] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 31.2922ms
[2025-12-23 00:08:13.117] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.118] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 49.5431ms
[2025-12-23 00:08:13.120] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:13.120] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:13.122] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.125] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.125] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.9663ms
[2025-12-23 00:08:13.126] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:08:13.129] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.131] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.133] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.134] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.135] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.137] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2025-10-31T21:00:00.0000000Z", Kind: "Utc", Local: "2025-11-01T00:00:00.0000000+03:00", DateOnly: "2025-11-01T00:00:00.0000000+03:00", Year: 2025
[2025-12-23 00:08:13.138] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.139] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2025-11-30T20:59:59.9990000Z", Kind: "Utc", Local: "2025-11-30T23:59:59.9990000+03:00", DateOnly: "2025-11-30T23:59:59.9999999+03:00", Year: 2025
[2025-12-23 00:08:13.141] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.144] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.145] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:13.148] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:13.152] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:13.153] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:08:13.154] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 18.3838ms
[2025-12-23 00:08:13.155] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:13.156] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.158] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.1156ms
[2025-12-23 00:08:13.158] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 31.4338ms
[2025-12-23 00:08:13.159] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.163] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 42.4509ms
[2025-12-23 00:08:13.166] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:13.166] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:08:13.168] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.170] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.171] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 4.6212ms
[2025-12-23 00:08:13.172] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 5.2878ms
[2025-12-23 00:08:13.173] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:13.173] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:08:13.178] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.180] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.181] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.182] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.182] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.183] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.187] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.188] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.189] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.191] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:08:13.193] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.194] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.198] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.199] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:08:13.202] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:13.203] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:08:13.204] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:08:13.206] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:08:13.207] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:13.208] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:08:13.209] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.9198ms
[2025-12-23 00:08:13.210] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.7029ms
[2025-12-23 00:08:13.211] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.212] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:08:13.213] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 40.219ms
[2025-12-23 00:08:13.214] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 41.268ms
[2025-12-23 00:08:13.218] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:08:13.222] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.223] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.1433ms
[2025-12-23 00:08:13.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:08:13.227] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.228] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:08:13.228] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.235] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:08:13.237] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:08:13.238] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:13.240] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 9.3476ms
[2025-12-23 00:08:13.241] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:08:13.241] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 17.2468ms
[2025-12-23 00:08:13.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:08:13.247] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.248] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.5557ms
[2025-12-23 00:08:13.250] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:08:13.253] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.254] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:08:13.255] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.259] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:08:13.261] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:08:13.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 5.5926ms
[2025-12-23 00:08:13.264] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:08:13.265] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 15.233ms
[2025-12-23 00:08:13.269] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:13.271] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.8119ms
[2025-12-23 00:08:13.274] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:08:13.277] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.278] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.278] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.283] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2015-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2015-12-23T00:00:00.0000000+03:00", DateOnly: "2015-12-23T00:00:00.0000000+03:00", Year: 2015
[2025-12-23 00:08:13.295] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2035-12-23T20:59:59.9990000Z", Kind: "Utc", Local: "2035-12-23T23:59:59.9990000+03:00", DateOnly: "2035-12-23T23:59:59.9999999+03:00", Year: 2035
[2025-12-23 00:08:13.301] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:13.307] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:13.308] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 27.1142ms
[2025-12-23 00:08:13.309] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.309] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 35.9715ms
[2025-12-23 00:08:13.314] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:13.317] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.317] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.6396ms
[2025-12-23 00:08:13.319] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:08:13.325] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:08:13.326] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.327] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String, System.Nullable`1[System.Int32]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:08:13.331] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате начала: "2023-12-22T21:00:00.0000000Z", Kind: "Utc", Local: "2023-12-23T00:00:00.0000000+03:00", DateOnly: "2023-12-23T00:00:00.0000000+03:00", Year: 2023
[2025-12-23 00:08:13.334] [INF] [RestaurantAPI.Controllers.StatisticsController] Фильтр по дате конца: "2026-12-31T20:59:59.9990000Z", Kind: "Utc", Local: "2026-12-31T23:59:59.9990000+03:00", DateOnly: "2026-12-31T23:59:59.9999999+03:00", Year: 2026
[2025-12-23 00:08:13.338] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __startDateOnly_0)
    .Where(o => o.CreatedAt <= __endDateOnly_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period, Nullable`1 filterYear) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 185
[2025-12-23 00:08:13.343] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:08:13.345] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.9855ms
[2025-12-23 00:08:13.346] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:08:13.348] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 28.3585ms
[2025-12-23 00:11:38.404] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:11:38.615] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:11:38.635] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:11:38.725] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:11:38.726] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:11:38.798] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:11:38.800] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:11:38.801] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:11:38.808] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:11:38.928] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 120.2851ms
[2025-12-23 00:11:38.945] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:11:38.945] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:11:38.957] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 11.9006ms
[2025-12-23 00:11:38.972] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 27.1798ms
[2025-12-23 00:11:39.142] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:11:39.183] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 40.7449ms
[2025-12-23 00:11:47.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:11:47.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:11:47.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:11:47.692] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.692] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.694] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.696] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 14.8119ms
[2025-12-23 00:11:47.696] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 14.7731ms
[2025-12-23 00:11:47.696] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 15.1834ms
[2025-12-23 00:11:47.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:11:47.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:11:47.700] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:11:47.712] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.712] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.714] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.776] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:11:47.776] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:11:47.777] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:11:47.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:11:47.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:11:47.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:11:47.890] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:11:47.893] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:11:47.893] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.897] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.575ms
[2025-12-23 00:11:47.897] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.899] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:11:47.901] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 7.9987ms
[2025-12-23 00:11:47.903] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.903] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:11:47.911] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:47.913] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:47.913] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:47.918] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:47.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.170] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.170] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.170] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (24ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.170] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (24ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.170] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.200] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.200] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.208] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.208] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.215] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.215] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.237] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:11:49.239] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:11:49.243] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:11:49.243] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:11:49.246] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:11:49.248] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:11:49.257] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:11:49.257] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:11:49.262] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:11:49.274] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1350.1097ms
[2025-12-23 00:11:49.274] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1348.3848ms
[2025-12-23 00:11:49.275] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.277] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 1384.5589ms
[2025-12-23 00:11:49.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 1380.9426ms
[2025-12-23 00:11:49.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:49.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:49.296] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.298] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.299] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 14.6103ms
[2025-12-23 00:11:49.299] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 15.3752ms
[2025-12-23 00:11:49.301] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:49.301] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:49.308] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.310] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.311] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.312] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.314] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.317] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:11:49.317] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:11:49.317] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.319] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:49.320] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:49.329] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:11:49.330] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 1529.1124ms
[2025-12-23 00:11:49.330] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 1530.4738ms
[2025-12-23 00:11:49.331] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:49.332] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:11:49.333] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:11:49.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 1634.8771ms
[2025-12-23 00:11:49.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 1636.089ms
[2025-12-23 00:11:49.338] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 1535.0004ms
[2025-12-23 00:11:49.343] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:11:49.344] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 1644.2766ms
[2025-12-23 00:11:49.357] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.360] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.362] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.365] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.391] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (23ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:11:49.394] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:11:49.396] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:11:49.399] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 83.036ms
[2025-12-23 00:11:49.401] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.402] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 100.916ms
[2025-12-23 00:11:49.406] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 159
[2025-12-23 00:11:49.428] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:49.430] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 108.0365ms
[2025-12-23 00:11:49.431] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.432] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 130.3253ms
[2025-12-23 00:11:49.436] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:11:49.436] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:11:49.438] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.440] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.441] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.441] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 5.1283ms
[2025-12-23 00:11:49.442] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.443] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:11:49.448] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.449] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.450] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.452] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.456] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.457] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 159
[2025-12-23 00:11:49.459] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.463] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:49.465] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.466] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.6133ms
[2025-12-23 00:11:49.468] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.469] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:11:49.470] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 26.9481ms
[2025-12-23 00:11:49.472] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:11:49.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:11:49.476] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.9903ms
[2025-12-23 00:11:49.477] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.478] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 41.9116ms
[2025-12-23 00:11:49.481] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:11:49.481] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:11:49.483] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.485] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.486] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 5.5925ms
[2025-12-23 00:11:49.487] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 6.3358ms
[2025-12-23 00:11:49.489] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:11:49.490] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:11:49.494] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.496] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.496] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.497] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.498] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.498] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.502] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.503] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.506] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.507] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:49.508] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.509] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.511] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.513] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:11:49.515] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:11:49.517] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:11:49.517] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:11:49.519] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:11:49.520] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:11:49.521] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:11:49.522] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.8975ms
[2025-12-23 00:11:49.523] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.3959ms
[2025-12-23 00:11:49.524] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.525] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:11:49.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 36.8374ms
[2025-12-23 00:11:49.527] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 37.5165ms
[2025-12-23 00:11:49.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:11:49.534] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.535] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.8759ms
[2025-12-23 00:11:49.538] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:11:49.540] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.541] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:11:49.546] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.572] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:11:49.575] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:11:49.576] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:49.580] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 33.0542ms
[2025-12-23 00:11:49.581] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:11:49.582] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 44.2565ms
[2025-12-23 00:11:49.585] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:11:49.588] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.589] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.6563ms
[2025-12-23 00:11:49.591] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:11:49.594] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.595] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:11:49.599] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.618] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:11:49.621] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:49.625] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 25.1391ms
[2025-12-23 00:11:49.626] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:11:49.627] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 35.8ms
[2025-12-23 00:11:49.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:11:49.632] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.633] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.9459ms
[2025-12-23 00:11:49.636] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:11:49.639] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.640] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.641] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.646] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 159
[2025-12-23 00:11:49.650] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:49.651] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.6797ms
[2025-12-23 00:11:49.653] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.654] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 17.9596ms
[2025-12-23 00:11:49.658] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:49.660] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.661] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.9537ms
[2025-12-23 00:11:49.662] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:49.666] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:49.667] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.668] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:49.673] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 159
[2025-12-23 00:11:49.678] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:49.680] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.5482ms
[2025-12-23 00:11:49.681] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:49.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 18.9965ms
[2025-12-23 00:11:52.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:52.777] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:52.778] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.8867ms
[2025-12-23 00:11:52.781] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:52.784] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:52.785] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:52.785] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:52.797] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:52.804] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:52.808] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.9555ms
[2025-12-23 00:11:52.809] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:52.809] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 28.4966ms
[2025-12-23 00:11:53.680] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:53.682] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:53.684] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:53.685] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:53.690] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 159
[2025-12-23 00:11:53.696] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:53.698] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.5383ms
[2025-12-23 00:11:53.699] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:53.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 18.9933ms
[2025-12-23 00:11:54.583] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:54.585] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:54.586] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:54.587] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:54.591] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:54.594] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:54.595] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 6.2724ms
[2025-12-23 00:11:54.596] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:54.597] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 14.417ms
[2025-12-23 00:11:55.549] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:55.551] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:55.552] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.8368ms
[2025-12-23 00:11:55.553] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:55.559] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:55.560] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:55.561] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:55.567] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 127
[2025-12-23 00:11:55.573] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:55.574] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.0251ms
[2025-12-23 00:11:55.576] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:55.576] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 23.2414ms
[2025-12-23 00:11:56.525] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:56.529] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:56.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 4.4284ms
[2025-12-23 00:11:56.532] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:56.536] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:56.537] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:56.538] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:56.545] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        Date = g.Key.ToString("D4"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 149
[2025-12-23 00:11:56.550] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:56.551] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.1289ms
[2025-12-23 00:11:56.552] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:56.553] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 21.0345ms
[2025-12-23 00:11:57.477] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:57.479] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:57.481] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:57.482] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:57.486] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:11:57.488] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:11:57.490] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 5.8931ms
[2025-12-23 00:11:57.491] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:57.492] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 15.023ms
[2025-12-23 00:11:58.999] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:59.001] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:59.002] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.1933ms
[2025-12-23 00:11:59.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:11:59.008] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:11:59.009] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:59.010] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:11:59.016] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 159
[2025-12-23 00:11:59.020] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:11:59.022] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.9537ms
[2025-12-23 00:11:59.023] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:11:59.024] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 19.418ms
[2025-12-23 00:16:53.257] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:16:53.467] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:16:53.486] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:16:53.573] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:16:53.574] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:16:53.645] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:16:53.647] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:16:53.648] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:16:53.659] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:16:53.674] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:16:53.693] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:53.696] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 39.0779ms
[2025-12-23 00:16:53.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:16:53.706] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:53.766] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:16:53.774] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 100.5101ms
[2025-12-23 00:16:53.790] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:16:53.792] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:16:53.792] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:16:53.800] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 8.2424ms
[2025-12-23 00:16:53.815] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 22.9987ms
[2025-12-23 00:16:54.152] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:16:54.181] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 28.5172ms
[2025-12-23 00:16:54.739] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:16:54.766] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:16:54.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 988.5256ms
[2025-12-23 00:16:54.785] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:16:54.791] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:16:54.791] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 1091.6896ms
[2025-12-23 00:16:54.793] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:54.796] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 5.3582ms
[2025-12-23 00:16:54.800] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:16:54.801] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:54.804] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:16:54.809] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:16:54.829] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:16:54.853] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:16:54.878] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:16:54.879] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 68.6614ms
[2025-12-23 00:16:54.880] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:16:54.881] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 81.746ms
[2025-12-23 00:16:54.885] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:16:54.887] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:54.887] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.0419ms
[2025-12-23 00:16:54.890] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:16:54.893] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:54.896] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:16:54.897] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:16:54.937] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:16:54.941] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:16:54.947] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:16:54.948] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 49.5837ms
[2025-12-23 00:16:54.949] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:16:54.951] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 60.3779ms
[2025-12-23 00:16:59.900] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:16:59.908] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:59.910] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 10.0519ms
[2025-12-23 00:16:59.912] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:16:59.915] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:59.917] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:16:59.923] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:16:59.935] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:16:59.936] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:16:59.948] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:59.950] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:59.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 15.4976ms
[2025-12-23 00:16:59.951] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 15.1741ms
[2025-12-23 00:16:59.955] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:16:59.955] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:16:59.961] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:59.963] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:16:59.964] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:16:59.964] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:16:59.969] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:16:59.969] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:16:59.990] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.008] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.011] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.017] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.023] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.028] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.028] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.032] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.038] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:17:00.040] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:17:00.042] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:17:00.042] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:17:00.044] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:17:00.046] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:17:00.049] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 75.0872ms
[2025-12-23 00:17:00.049] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 78.0885ms
[2025-12-23 00:17:00.050] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.051] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 97.4405ms
[2025-12-23 00:17:00.054] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 98.6402ms
[2025-12-23 00:17:00.058] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:00.058] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:00.063] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.065] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.065] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 6.9956ms
[2025-12-23 00:17:00.066] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 7.6718ms
[2025-12-23 00:17:00.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:00.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:00.076] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.078] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.079] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.079] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.080] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.080] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.084] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:00.087] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.089] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:17:00.091] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.095] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:00.098] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.098] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.6995ms
[2025-12-23 00:17:00.101] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.101] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.102] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 33.6212ms
[2025-12-23 00:17:00.107] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:17:00.109] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:17:00.111] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:17:00.112] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.6207ms
[2025-12-23 00:17:00.114] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.115] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 46.9121ms
[2025-12-23 00:17:00.118] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:17:00.118] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:17:00.121] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.121] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:17:00.124] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.124] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 5.6879ms
[2025-12-23 00:17:00.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:17:00.127] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.132] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.132] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.133] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.135] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.137] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.139] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:17:00.141] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.144] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.144] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:17:00.147] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.151] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:00.154] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.1681ms
[2025-12-23 00:17:00.154] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:17:00.156] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.157] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:17:00.158] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 32.577ms
[2025-12-23 00:17:00.159] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:17:00.163] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.2712ms
[2025-12-23 00:17:00.164] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.165] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 46.7589ms
[2025-12-23 00:17:00.168] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:17:00.168] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:17:00.171] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.174] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.175] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 6.1886ms
[2025-12-23 00:17:00.175] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 6.8587ms
[2025-12-23 00:17:00.178] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:17:00.178] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:17:00.184] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.185] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.186] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.188] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.189] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.194] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.195] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:17:00.195] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.197] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.200] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:00.201] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 276.0192ms
[2025-12-23 00:17:00.203] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.202] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.204] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:17:00.208] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.209] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:17:00.209] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 296.9926ms
[2025-12-23 00:17:00.212] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:17:00.214] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:17:00.217] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:17:00.219] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:17:00.220] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:17:00.221] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:17:00.223] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.7328ms
[2025-12-23 00:17:00.224] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 32.854ms
[2025-12-23 00:17:00.225] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.226] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:17:00.227] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 48.6712ms
[2025-12-23 00:17:00.227] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 49.5539ms
[2025-12-23 00:17:00.231] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:17:00.234] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.235] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.6792ms
[2025-12-23 00:17:00.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:17:00.241] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.242] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:17:00.247] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.271] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:17:00.275] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:17:00.276] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:17:00.279] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 30.8075ms
[2025-12-23 00:17:00.280] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:17:00.281] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 43.6749ms
[2025-12-23 00:17:00.285] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:17:00.287] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.288] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.3547ms
[2025-12-23 00:17:00.291] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:17:00.294] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.296] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:17:00.297] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.313] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:17:00.315] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:17:00.316] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 18.327ms
[2025-12-23 00:17:00.317] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:17:00.319] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 28.0448ms
[2025-12-23 00:17:00.322] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:17:00.324] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.325] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 3.5575ms
[2025-12-23 00:17:00.328] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:17:00.330] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.332] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.333] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.335] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:17:00.340] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:17:00.345] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:00.347] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.3309ms
[2025-12-23 00:17:00.348] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.349] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 20.6544ms
[2025-12-23 00:17:00.352] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:00.354] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.355] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.9019ms
[2025-12-23 00:17:00.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:00.361] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:00.362] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.364] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:00.366] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:00.370] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:17:00.375] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:00.377] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.8461ms
[2025-12-23 00:17:00.378] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:00.379] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 21.9371ms
[2025-12-23 00:17:03.032] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:03.035] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:03.036] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.9216ms
[2025-12-23 00:17:03.039] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:03.042] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:03.044] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:03.044] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:03.048] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:03.060] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:03.066] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:17:03.069] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.6317ms
[2025-12-23 00:17:03.070] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:03.072] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 32.9137ms
[2025-12-23 00:17:04.892] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:04.895] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:04.896] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.6696ms
[2025-12-23 00:17:04.898] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:04.902] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:04.903] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:04.904] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:04.907] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:04.913] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 139
[2025-12-23 00:17:04.918] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:04.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.7629ms
[2025-12-23 00:17:04.921] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:04.922] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 23.6784ms
[2025-12-23 00:17:05.725] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:05.728] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:05.729] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.5756ms
[2025-12-23 00:17:05.730] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:05.733] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:05.734] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:05.735] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:05.737] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:05.742] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        Date = g.Key.ToString("D4"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 161
[2025-12-23 00:17:05.747] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:05.748] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.6286ms
[2025-12-23 00:17:05.749] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:05.750] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 19.862ms
[2025-12-23 00:17:06.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:06.477] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:06.478] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:06.479] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:06.481] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:06.483] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:17:06.485] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:17:06.486] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 6.1376ms
[2025-12-23 00:17:06.487] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:06.488] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 12.6542ms
[2025-12-23 00:17:07.179] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:07.181] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:07.181] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.7392ms
[2025-12-23 00:17:07.183] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:17:07.186] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:17:07.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:07.189] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:17:07.191] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:17:07.195] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:17:07.201] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:17:07.202] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.033ms
[2025-12-23 00:17:07.204] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:17:07.205] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 21.6029ms
[2025-12-23 00:18:05.647] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:18:05.658] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.659] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 11.9477ms
[2025-12-23 00:18:05.671] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:18:05.671] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:18:05.672] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:18:05.674] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.676] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.679] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.680] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.8257ms
[2025-12-23 00:18:05.681] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:18:05.682] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 10.1775ms
[2025-12-23 00:18:05.685] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:18:05.688] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:18:05.688] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:18:05.693] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.694] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.699] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.700] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.701] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.702] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.707] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.708] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:18:05.710] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.716] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:18:05.714] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.717] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 20.1026ms
[2025-12-23 00:18:05.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.720] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:18:05.721] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.722] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 51.2436ms
[2025-12-23 00:18:05.723] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.725] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.733] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:18:05.734] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.735] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:18:05.737] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:18:05.739] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 35.4101ms
[2025-12-23 00:18:05.739] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:18:05.740] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.741] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:18:05.742] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 56.9636ms
[2025-12-23 00:18:05.743] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:18:05.750] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.9033ms
[2025-12-23 00:18:05.751] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.751] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 63.6244ms
[2025-12-23 00:18:05.756] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:18:05.756] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:18:05.757] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.759] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.760] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 4.4029ms
[2025-12-23 00:18:05.761] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.0951ms
[2025-12-23 00:18:05.762] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:18:05.766] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:18:05.771] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.773] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.774] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:05.774] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.775] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.775] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.777] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:18:05.782] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.784] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:18:05.786] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.790] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:18:05.792] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.792] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.8358ms
[2025-12-23 00:18:05.795] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.796] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:05.800] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 37.5009ms
[2025-12-23 00:18:05.800] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:18:05.804] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:18:05.805] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:18:05.806] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.2906ms
[2025-12-23 00:18:05.807] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.808] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 42.62ms
[2025-12-23 00:18:05.810] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:18:05.810] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:18:05.814] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.817] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.817] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 6.8189ms
[2025-12-23 00:18:05.818] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.819] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:18:05.821] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.823] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.825] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:05.825] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.825] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.827] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:18:05.832] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.834] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:18:05.835] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.840] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:18:05.842] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.842] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.1803ms
[2025-12-23 00:18:05.844] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:18:05.845] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:05.848] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:18:05.849] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 30.325ms
[2025-12-23 00:18:05.850] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:18:05.853] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.5393ms
[2025-12-23 00:18:05.855] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.855] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 45.0185ms
[2025-12-23 00:18:05.858] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:18:05.858] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:18:05.860] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.863] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.863] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 4.5882ms
[2025-12-23 00:18:05.864] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 6.1047ms
[2025-12-23 00:18:05.866] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:18:05.866] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:18:05.871] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.872] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.873] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.874] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.874] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.875] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.878] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.880] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.883] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.885] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:18:05.886] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.888] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.889] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.891] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:18:05.893] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:18:05.895] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:18:05.896] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:18:05.899] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:18:05.900] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:18:05.901] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:18:05.902] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.8937ms
[2025-12-23 00:18:05.903] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.6244ms
[2025-12-23 00:18:05.904] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.905] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:18:05.906] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 39.4056ms
[2025-12-23 00:18:05.906] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 40.0557ms
[2025-12-23 00:18:05.909] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:18:05.913] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.914] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.2058ms
[2025-12-23 00:18:05.917] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:18:05.919] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.920] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:18:05.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.935] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:18:05.937] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:18:05.938] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:18:05.939] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 16.1109ms
[2025-12-23 00:18:05.940] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:18:05.941] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 23.9229ms
[2025-12-23 00:18:05.943] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:18:05.946] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.947] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 4.2007ms
[2025-12-23 00:18:05.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:18:05.952] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.953] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:18:05.954] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.964] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:18:05.967] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:18:05.968] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 13.0993ms
[2025-12-23 00:18:05.969] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:18:05.970] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 20.5041ms
[2025-12-23 00:18:05.973] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:18:05.975] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.975] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.4605ms
[2025-12-23 00:18:05.977] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:18:05.983] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:05.985] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:05.986] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:05.989] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:18:05.992] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:18:05.999] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:18:06.001] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.1479ms
[2025-12-23 00:18:06.003] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:06.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 27.1454ms
[2025-12-23 00:18:06.007] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:18:06.009] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:06.010] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.9519ms
[2025-12-23 00:18:06.013] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:18:06.018] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:18:06.020] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:06.021] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:18:06.024] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:18:06.027] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:18:06.035] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:18:06.036] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.3893ms
[2025-12-23 00:18:06.037] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:18:06.038] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 25.0012ms
[2025-12-23 00:20:50.052] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:20:50.373] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:20:50.402] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:20:50.521] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:20:50.523] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:20:50.608] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:20:50.612] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:20:50.614] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:20:51.089] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:20:51.257] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 167.7954ms
[2025-12-23 00:20:51.285] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:20:51.285] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:20:51.294] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 8.6436ms
[2025-12-23 00:20:51.323] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 38.7275ms
[2025-12-23 00:20:51.982] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:20:52.058] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 75.8026ms
[2025-12-23 00:20:55.054] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:20:55.063] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:55.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 14.3532ms
[2025-12-23 00:20:55.070] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:20:55.078] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:55.096] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:20:55.098] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:20:55.101] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:55.104] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:55.105] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.7734ms
[2025-12-23 00:20:55.106] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 7.904ms
[2025-12-23 00:20:55.108] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:20:55.113] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:20:55.120] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:55.122] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:55.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:55.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:55.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:20:55.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:20:55.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:55.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.043] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.044] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (59ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:20:57.044] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (59ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.084] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.084] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.095] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.095] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.104] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.104] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.123] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:20:57.134] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:20:57.135] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:20:57.139] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:20:57.140] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:20:57.142] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 1911.5148ms
[2025-12-23 00:20:57.142] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:20:57.143] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:20:57.144] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:20:57.149] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1921.6376ms
[2025-12-23 00:20:57.149] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1921.6636ms
[2025-12-23 00:20:57.151] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.151] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 2080.6336ms
[2025-12-23 00:20:57.152] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.152] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 2039.1021ms
[2025-12-23 00:20:57.155] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 2047.2412ms
[2025-12-23 00:20:57.159] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:57.159] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:57.162] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.164] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.164] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.2613ms
[2025-12-23 00:20:57.165] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.8941ms
[2025-12-23 00:20:57.167] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:57.167] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:57.172] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.174] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.177] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.177] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.178] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.183] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.224] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:20:57.226] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.229] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.232] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.235] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.238] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:20:57.240] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:20:57.242] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:20:57.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 62.4397ms
[2025-12-23 00:20:57.244] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 78.5861ms
[2025-12-23 00:20:57.247] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:20:57.261] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:20:57.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 77.8543ms
[2025-12-23 00:20:57.264] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.264] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 97.5441ms
[2025-12-23 00:20:57.268] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:20:57.268] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:20:57.270] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.272] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.351ms
[2025-12-23 00:20:57.273] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.274] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:20:57.276] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.278] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.280] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.281] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.284] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:20:57.285] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.288] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.288] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:20:57.290] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.295] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:20:57.296] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.9324ms
[2025-12-23 00:20:57.297] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:20:57.298] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.299] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:20:57.300] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 26.0998ms
[2025-12-23 00:20:57.301] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:20:57.304] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.2009ms
[2025-12-23 00:20:57.305] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.306] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 37.975ms
[2025-12-23 00:20:57.310] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:20:57.310] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:20:57.312] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.314] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.315] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 4.7886ms
[2025-12-23 00:20:57.316] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 5.6655ms
[2025-12-23 00:20:57.318] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:20:57.318] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:20:57.322] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.324] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.325] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.326] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.326] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.327] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.331] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.331] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.334] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:57.336] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.338] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.339] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.340] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:20:57.343] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:20:57.344] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:20:57.345] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:20:57.347] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:20:57.348] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:20:57.348] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:20:57.349] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.2141ms
[2025-12-23 00:20:57.350] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.0261ms
[2025-12-23 00:20:57.351] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.352] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:20:57.353] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 35.0491ms
[2025-12-23 00:20:57.354] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 35.9681ms
[2025-12-23 00:20:57.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:20:57.361] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.362] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.1007ms
[2025-12-23 00:20:57.364] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:20:57.367] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.368] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:20:57.373] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.406] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:20:57.410] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:20:57.411] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:20:57.415] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 40.4642ms
[2025-12-23 00:20:57.416] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:20:57.417] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 52.2527ms
[2025-12-23 00:20:57.419] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:20:57.421] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.422] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.4449ms
[2025-12-23 00:20:57.423] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:20:57.427] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.428] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:20:57.432] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.451] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:20:57.453] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:20:57.456] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 22.78ms
[2025-12-23 00:20:57.458] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:20:57.459] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 35.3049ms
[2025-12-23 00:20:57.462] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:20:57.464] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.465] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.512ms
[2025-12-23 00:20:57.466] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:20:57.469] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.470] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.471] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.473] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:20:57.485] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:20:57.490] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:20:57.492] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.7852ms
[2025-12-23 00:20:57.494] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.495] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 28.4685ms
[2025-12-23 00:20:57.499] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:57.500] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.501] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.7087ms
[2025-12-23 00:20:57.503] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:57.506] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:57.507] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.508] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:57.511] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:20:57.515] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:20:57.520] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:20:57.522] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.9464ms
[2025-12-23 00:20:57.523] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:57.524] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 20.423ms
[2025-12-23 00:20:59.190] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:59.192] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:59.193] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.4607ms
[2025-12-23 00:20:59.195] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:20:59.198] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:20:59.200] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:59.201] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:20:59.204] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:20:59.214] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:20:59.220] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:20:59.224] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 21.3406ms
[2025-12-23 00:20:59.225] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:20:59.226] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 30.4109ms
[2025-12-23 00:21:00.337] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:21:00.339] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:21:00.339] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.6907ms
[2025-12-23 00:21:00.341] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:21:00.344] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:21:00.345] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:21:00.346] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:21:00.350] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:21:00.355] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        Date = g.Key.ToString("D4"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 161
[2025-12-23 00:21:00.360] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:21:00.362] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.4335ms
[2025-12-23 00:21:00.363] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:21:00.364] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 22.7853ms
[2025-12-23 00:21:01.350] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:21:01.353] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:21:01.353] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.4213ms
[2025-12-23 00:21:01.356] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:21:01.359] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:21:01.360] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:21:01.361] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:21:01.363] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:21:01.368] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 139
[2025-12-23 00:21:01.372] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:21:01.373] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.9586ms
[2025-12-23 00:21:01.374] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:21:01.376] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 19.8452ms
[2025-12-23 00:21:02.662] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:21:02.665] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:21:02.666] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.1618ms
[2025-12-23 00:21:02.668] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:21:02.671] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:21:02.672] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:21:02.673] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:21:02.677] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:21:02.680] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:21:02.685] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:21:02.686] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.3252ms
[2025-12-23 00:21:02.687] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:21:02.688] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 19.6783ms
[2025-12-23 00:22:25.114] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:22:25.115] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:25.117] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.122] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.124] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.1167ms
[2025-12-23 00:22:25.125] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 9.6183ms
[2025-12-23 00:22:25.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:22:25.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:25.135] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.138] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.141] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.142] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.142] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.144] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.156] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.156] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.162] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.164] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.167] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.168] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.173] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.174] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.182] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:25.183] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:22:25.185] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:22:25.188] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:22:25.190] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:25.192] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:25.194] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 45.4463ms
[2025-12-23 00:22:25.196] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 48.831ms
[2025-12-23 00:22:25.197] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.198] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.199] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 71.9252ms
[2025-12-23 00:22:25.200] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 73.5726ms
[2025-12-23 00:22:25.208] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:25.208] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:25.211] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.215] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.216] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 7.6915ms
[2025-12-23 00:22:25.217] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 8.4841ms
[2025-12-23 00:22:25.218] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:25.219] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:25.229] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.232] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.233] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.234] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.235] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.237] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.241] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:22:25.246] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.248] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:25.250] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.257] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:25.262] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 22.3543ms
[2025-12-23 00:22:25.266] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.267] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 53.2621ms
[2025-12-23 00:22:25.272] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:25.279] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:22:25.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:25.282] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 40.1049ms
[2025-12-23 00:22:25.284] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.286] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 67.2573ms
[2025-12-23 00:22:25.289] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:25.289] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:25.293] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.297] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.298] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 8.6197ms
[2025-12-23 00:22:25.299] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.300] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:25.305] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.308] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.313] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.314] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.315] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.318] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:22:25.320] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.323] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:25.323] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.335] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:25.336] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.337] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.6289ms
[2025-12-23 00:22:25.340] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:25.341] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.344] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:22:25.346] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 45.6524ms
[2025-12-23 00:22:25.347] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:25.352] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 40.6255ms
[2025-12-23 00:22:25.354] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.356] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 66.0936ms
[2025-12-23 00:22:25.361] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:25.361] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:22:25.365] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.368] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.368] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 7.2998ms
[2025-12-23 00:22:25.369] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 8.0422ms
[2025-12-23 00:22:25.372] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:25.372] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:22:25.381] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.383] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.384] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.385] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.386] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.387] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.391] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.392] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.395] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.399] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:25.399] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.403] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.405] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.407] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:25.411] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:25.414] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:25.416] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:22:25.418] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:22:25.420] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:25.421] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:25.423] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 34.2548ms
[2025-12-23 00:22:25.425] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 34.9987ms
[2025-12-23 00:22:25.427] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.428] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:25.430] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 58.1694ms
[2025-12-23 00:22:25.431] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 58.4489ms
[2025-12-23 00:22:25.439] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:22:25.443] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.444] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.3437ms
[2025-12-23 00:22:25.447] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:22:25.452] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.453] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:22:25.455] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.481] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:22:25.485] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:22:25.487] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:25.491] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 32.9303ms
[2025-12-23 00:22:25.494] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:22:25.495] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 48.2905ms
[2025-12-23 00:22:25.502] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:22:25.506] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.508] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 5.6246ms
[2025-12-23 00:22:25.510] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:22:25.515] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.517] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:22:25.519] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.546] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:22:25.549] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:25.551] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 27.0848ms
[2025-12-23 00:22:25.552] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:22:25.555] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 45.1699ms
[2025-12-23 00:22:25.562] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:25.565] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.566] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 4.0208ms
[2025-12-23 00:22:25.569] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:25.574] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.576] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.578] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.582] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:22:25.589] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:25.599] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:25.602] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.8688ms
[2025-12-23 00:22:25.604] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.606] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 37.6662ms
[2025-12-23 00:22:25.613] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:25.615] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.617] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 4.0395ms
[2025-12-23 00:22:25.619] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:25.625] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:25.627] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.628] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:25.632] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:22:25.637] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:25.728] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:25.729] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 99.0058ms
[2025-12-23 00:22:25.731] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:25.733] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 113.7751ms
[2025-12-23 00:22:46.045] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:22:46.048] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:46.051] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 6.1938ms
[2025-12-23 00:22:46.054] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:22:46.057] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:46.059] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:22:46.068] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:22:46.082] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:46.109] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:22:46.203] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:22:46.205] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:46.210] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 139.532ms
[2025-12-23 00:22:46.211] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:22:46.212] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 157.3827ms
[2025-12-23 00:22:46.214] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:22:46.217] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:46.219] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 4.65ms
[2025-12-23 00:22:46.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:22:46.226] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:46.227] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:22:46.231] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:22:46.244] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:46.268] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:22:46.329] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:22:46.331] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:46.338] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 103.6771ms
[2025-12-23 00:22:46.340] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:22:46.341] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 117.1638ms
[2025-12-23 00:22:46.345] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:22:46.347] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:46.348] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 2.9315ms
[2025-12-23 00:22:46.352] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:22:46.355] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:46.356] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:22:46.360] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:22:46.374] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:46.398] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:22:46.450] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 24, Страница: 1
[2025-12-23 00:22:46.454] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:46.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 110.1721ms
[2025-12-23 00:22:46.474] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:22:46.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 123.0077ms
[2025-12-23 00:22:47.570] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:22:47.573] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:47.575] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.577] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.577] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 7.462ms
[2025-12-23 00:22:47.578] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.7482ms
[2025-12-23 00:22:47.580] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:22:47.580] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:47.590] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.592] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.593] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.594] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.595] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.596] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.601] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.604] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.605] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.608] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.610] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.611] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.613] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.618] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.619] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:22:47.622] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:47.623] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:22:47.626] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:22:47.627] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:47.628] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:47.629] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 30.7592ms
[2025-12-23 00:22:47.631] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 30.581ms
[2025-12-23 00:22:47.635] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.636] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 57.0598ms
[2025-12-23 00:22:47.638] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 57.8033ms
[2025-12-23 00:22:47.642] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:47.642] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:47.646] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.650] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.652] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 9.9295ms
[2025-12-23 00:22:47.653] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 10.8762ms
[2025-12-23 00:22:47.657] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:47.657] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:47.661] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.664] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.665] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.667] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.668] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.670] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.674] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:22:47.676] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.679] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:47.679] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.688] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:47.690] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.691] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.9941ms
[2025-12-23 00:22:47.694] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.694] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.694] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 37.8393ms
[2025-12-23 00:22:47.697] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:47.704] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:22:47.705] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:47.707] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 32.3139ms
[2025-12-23 00:22:47.708] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.709] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 52.5412ms
[2025-12-23 00:22:47.712] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:47.712] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:47.714] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.719] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.720] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 8.3676ms
[2025-12-23 00:22:47.721] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.722] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:47.724] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.726] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.728] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.729] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.729] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.735] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.737] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:22:47.739] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.741] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:47.742] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.746] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:47.751] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.7878ms
[2025-12-23 00:22:47.753] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.753] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:47.754] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 31.4848ms
[2025-12-23 00:22:47.756] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:22:47.759] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:47.760] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 33.2352ms
[2025-12-23 00:22:47.762] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.763] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 50.5502ms
[2025-12-23 00:22:47.768] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:22:47.768] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:47.772] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.774] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.774] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 5.9164ms
[2025-12-23 00:22:47.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 6.5172ms
[2025-12-23 00:22:47.776] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:22:47.777] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:47.785] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.787] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.789] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.789] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.790] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.791] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.794] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.796] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.797] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.801] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:47.804] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.805] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.807] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.809] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:47.811] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:47.813] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:47.814] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:22:47.817] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:22:47.818] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:47.820] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:47.821] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.0846ms
[2025-12-23 00:22:47.822] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.6848ms
[2025-12-23 00:22:47.823] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.824] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:47.825] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 48.466ms
[2025-12-23 00:22:47.826] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 48.8545ms
[2025-12-23 00:22:47.829] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:22:47.836] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.837] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 7.5948ms
[2025-12-23 00:22:47.839] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:22:47.842] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.843] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:22:47.844] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.852] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:22:47.855] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:22:47.856] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:47.857] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 11.8412ms
[2025-12-23 00:22:47.858] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:22:47.859] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 20.629ms
[2025-12-23 00:22:47.863] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:22:47.868] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.869] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 5.6587ms
[2025-12-23 00:22:47.871] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:22:47.874] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.875] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:22:47.876] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.880] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:22:47.885] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:47.886] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 8.9155ms
[2025-12-23 00:22:47.888] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:22:47.889] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 18.4571ms
[2025-12-23 00:22:47.892] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:47.894] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.895] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.6897ms
[2025-12-23 00:22:47.897] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:47.900] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.903] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.904] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.908] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:22:47.911] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:47.918] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:47.920] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.5933ms
[2025-12-23 00:22:47.921] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.922] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 25.5008ms
[2025-12-23 00:22:47.925] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:47.928] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.928] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.9035ms
[2025-12-23 00:22:47.930] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:47.936] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:47.937] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.938] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:47.941] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:22:47.944] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:47.951] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:47.953] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.2865ms
[2025-12-23 00:22:47.955] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:47.955] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 25.2535ms
[2025-12-23 00:22:57.220] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:22:57.227] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.230] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 10.2543ms
[2025-12-23 00:22:57.234] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:57.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:22:57.244] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.251] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.255] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.253] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 19.1058ms
[2025-12-23 00:22:57.258] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:57.259] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.270] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.274] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.274] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.275] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.280] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.285] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.287] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.291] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.292] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.296] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.298] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:22:57.303] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.304] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:22:57.309] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:57.310] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:57.313] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:22:57.316] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 43.9386ms
[2025-12-23 00:22:57.317] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:57.320] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.322] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 39.5185ms
[2025-12-23 00:22:57.323] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 84.5555ms
[2025-12-23 00:22:57.324] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.331] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 72.7158ms
[2025-12-23 00:22:57.342] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:57.343] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:57.347] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.351] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.353] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 10.4332ms
[2025-12-23 00:22:57.354] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 11.0915ms
[2025-12-23 00:22:57.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:57.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:57.372] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.369] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.373] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.374] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.385] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.386] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.389] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:22:57.393] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.393] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:57.401] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.409] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:57.420] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.421] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 32.4552ms
[2025-12-23 00:22:57.425] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.426] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.430] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 72.9723ms
[2025-12-23 00:22:57.429] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:57.443] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:22:57.445] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:57.447] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 57.5044ms
[2025-12-23 00:22:57.455] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.468] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 110.7567ms
[2025-12-23 00:22:57.477] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:57.478] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:57.484] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.488] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.490] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 12.3802ms
[2025-12-23 00:22:57.494] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:22:57.495] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.505] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.506] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.507] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.511] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.512] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.517] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.520] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:22:57.522] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.526] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:57.527] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.535] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:57.540] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:57.541] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.5971ms
[2025-12-23 00:22:57.544] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:22:57.546] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.549] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:57.551] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 57.0743ms
[2025-12-23 00:22:57.553] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.6244ms
[2025-12-23 00:22:57.561] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.601] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 122.4885ms
[2025-12-23 00:22:57.612] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:57.640] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.641] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 28.96ms
[2025-12-23 00:22:57.612] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:22:57.644] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:57.650] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.654] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.655] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 42.8666ms
[2025-12-23 00:22:57.658] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:22:57.658] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.666] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.668] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.670] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.673] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.675] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.677] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.677] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.685] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.686] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:22:57.690] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.693] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.695] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:57.699] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:22:57.702] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:22:57.705] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:22:57.708] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:57.710] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:22:57.711] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 39.6724ms
[2025-12-23 00:22:57.713] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:22:57.719] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.721] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 46.1705ms
[2025-12-23 00:22:57.722] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 77.6935ms
[2025-12-23 00:22:57.723] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:22:57.729] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 71.0234ms
[2025-12-23 00:22:57.740] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:22:57.744] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.746] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.9883ms
[2025-12-23 00:22:57.754] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:22:57.757] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.758] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:22:57.760] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.770] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:22:57.774] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:22:57.776] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:57.787] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 25.3131ms
[2025-12-23 00:22:57.790] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:22:57.791] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 37.1538ms
[2025-12-23 00:22:57.800] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:22:57.804] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.805] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 4.3173ms
[2025-12-23 00:22:57.807] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:22:57.813] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.815] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:22:57.817] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.824] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:22:57.826] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:22:57.830] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 11.08ms
[2025-12-23 00:22:57.839] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:22:57.844] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 37.1479ms
[2025-12-23 00:22:57.860] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:57.869] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.873] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 13.5767ms
[2025-12-23 00:22:57.888] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:22:57.896] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.899] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.904] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.907] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:22:57.911] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:57.924] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:57.926] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.0087ms
[2025-12-23 00:22:57.928] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.929] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 41.3601ms
[2025-12-23 00:22:57.947] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:57.953] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.955] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 8.4569ms
[2025-12-23 00:22:57.958] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:22:57.964] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:22:57.966] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:57.968] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:22:57.973] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:22:57.977] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:22:58.003] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:22:58.004] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 32.3717ms
[2025-12-23 00:22:58.006] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:22:58.008] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 50.4273ms
[2025-12-23 00:23:04.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:23:04.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:23:04.633] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.636] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.4686ms
[2025-12-23 00:23:04.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 6.9408ms
[2025-12-23 00:23:04.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:23:04.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:23:04.645] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.647] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.648] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.649] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.649] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.651] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.655] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.656] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.657] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.659] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.660] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.663] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.665] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.667] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.670] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:23:04.671] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:23:04.672] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:23:04.674] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:23:04.675] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:23:04.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:23:04.677] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.1062ms
[2025-12-23 00:23:04.679] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 23.8617ms
[2025-12-23 00:23:04.680] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.684] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.685] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 46.2019ms
[2025-12-23 00:23:04.687] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 47.2681ms
[2025-12-23 00:23:04.693] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:23:04.694] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:23:04.696] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.698] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 6.0884ms
[2025-12-23 00:23:04.701] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 6.8105ms
[2025-12-23 00:23:04.704] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:23:04.704] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:23:04.711] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.712] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.713] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:04.713] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.720] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.720] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.723] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:23:04.725] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.727] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:23:04.728] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.740] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:23:04.742] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.742] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.8366ms
[2025-12-23 00:23:04.746] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.747] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:04.750] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:23:04.754] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 49.495ms
[2025-12-23 00:23:04.756] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:23:04.759] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:23:04.760] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 37.241ms
[2025-12-23 00:23:04.762] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.763] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 58.8625ms
[2025-12-23 00:23:04.769] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:23:04.771] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:23:04.772] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.774] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.774] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 5.4571ms
[2025-12-23 00:23:04.775] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.776] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:23:04.781] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.779] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.782] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:04.785] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.787] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.788] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:23:04.790] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.793] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:23:04.793] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.799] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:23:04.801] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.802] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.6308ms
[2025-12-23 00:23:04.805] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:23:04.805] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:04.807] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:23:04.808] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 31.4869ms
[2025-12-23 00:23:04.809] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:23:04.813] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.7348ms
[2025-12-23 00:23:04.816] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.817] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 46.0311ms
[2025-12-23 00:23:04.823] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:23:04.823] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:23:04.825] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.828] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.828] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 5.4504ms
[2025-12-23 00:23:04.829] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 6.3007ms
[2025-12-23 00:23:04.831] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:23:04.834] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:23:04.840] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.842] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.844] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.845] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.846] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.846] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.852] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.854] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.854] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.856] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:23:04.859] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.861] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.862] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.865] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:23:04.866] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:23:04.869] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:23:04.870] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:23:04.872] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:23:04.873] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:23:04.874] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:23:04.876] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 26.5233ms
[2025-12-23 00:23:04.877] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.2925ms
[2025-12-23 00:23:04.878] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.879] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:23:04.880] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 48.4575ms
[2025-12-23 00:23:04.884] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 50.3989ms
[2025-12-23 00:23:04.892] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:23:04.894] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.895] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 2.8209ms
[2025-12-23 00:23:04.898] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:23:04.903] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.905] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:23:04.906] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.913] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:23:04.917] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:23:04.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:23:04.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 12.8792ms
[2025-12-23 00:23:04.923] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:23:04.924] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 26.7412ms
[2025-12-23 00:23:04.935] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:23:04.938] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.939] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.7471ms
[2025-12-23 00:23:04.941] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:23:04.945] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.947] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:23:04.948] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.955] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:23:04.958] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:23:04.959] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 7.2751ms
[2025-12-23 00:23:04.960] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:23:04.961] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 19.7198ms
[2025-12-23 00:23:04.974] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:23:04.977] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.978] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 3.7479ms
[2025-12-23 00:23:04.981] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:23:04.988] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:04.990] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:04.991] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:04.993] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:23:04.997] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:23:05.007] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:23:05.008] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.623ms
[2025-12-23 00:23:05.010] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:05.011] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 30.615ms
[2025-12-23 00:23:05.024] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:23:05.028] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:05.029] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 4.9143ms
[2025-12-23 00:23:05.031] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:23:05.039] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:23:05.041] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:05.046] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:23:05.061] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:23:05.098] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:23:05.123] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:23:05.125] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 64.4552ms
[2025-12-23 00:23:05.127] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:23:05.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 97.6128ms
[2025-12-23 00:24:44.326] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:24:44.627] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:24:44.647] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:24:44.735] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:24:44.736] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:24:44.797] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:24:44.799] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:24:44.800] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:24:44.899] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:24:45.008] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 109.3927ms
[2025-12-23 00:24:45.025] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:24:45.025] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:24:45.032] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 6.9933ms
[2025-12-23 00:24:45.048] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 23.2787ms
[2025-12-23 00:24:45.247] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:24:45.282] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 35.0236ms
[2025-12-23 00:24:51.456] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:24:51.465] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:51.469] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 12.6618ms
[2025-12-23 00:24:51.471] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:24:51.480] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:51.490] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:24:51.490] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:24:51.493] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:51.497] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.9968ms
[2025-12-23 00:24:51.497] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:51.499] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:24:51.506] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 15.2417ms
[2025-12-23 00:24:51.508] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:24:51.508] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:51.516] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:51.564] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:51.564] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:24:51.564] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:51.586] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:51.586] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:51.586] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:24:53.565] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.566] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (66ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:24:53.566] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (65ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.604] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.606] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.621] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.621] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.629] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.629] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.647] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:24:53.661] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:24:53.663] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:24:53.665] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 2068.7572ms
[2025-12-23 00:24:53.665] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:24:53.666] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:24:53.668] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:24:53.670] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:24:53.670] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:24:53.676] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 2204.5486ms
[2025-12-23 00:24:53.677] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 2087.7695ms
[2025-12-23 00:24:53.677] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 2085.4631ms
[2025-12-23 00:24:53.679] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.680] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 2182.0701ms
[2025-12-23 00:24:53.682] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 2173.8578ms
[2025-12-23 00:24:53.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:24:53.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:24:53.690] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.691] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.692] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.7103ms
[2025-12-23 00:24:53.693] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 6.4361ms
[2025-12-23 00:24:53.695] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:24:53.695] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:24:53.700] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.702] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.706] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:53.706] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.708] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.711] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.754] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:24:53.756] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.761] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.764] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.768] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.772] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:24:53.774] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:24:53.776] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:24:53.777] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 67.8291ms
[2025-12-23 00:24:53.779] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.780] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 85.1755ms
[2025-12-23 00:24:53.783] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:24:53.797] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:24:53.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 85.6793ms
[2025-12-23 00:24:53.799] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:53.800] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 105.115ms
[2025-12-23 00:24:53.803] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:24:53.803] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:24:53.805] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.807] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.807] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.3919ms
[2025-12-23 00:24:53.808] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.809] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:24:53.811] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.813] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.815] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:53.816] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.817] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.819] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:24:53.820] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.824] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:24:53.824] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.828] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:24:53.830] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.831] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.8079ms
[2025-12-23 00:24:53.833] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:53.833] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:24:53.834] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 24.9888ms
[2025-12-23 00:24:53.836] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:24:53.839] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:24:53.840] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 26.2681ms
[2025-12-23 00:24:53.841] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.842] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 39.1882ms
[2025-12-23 00:24:53.845] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:24:53.845] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:24:53.847] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.849] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.850] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 4.5973ms
[2025-12-23 00:24:53.851] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 5.4932ms
[2025-12-23 00:24:53.853] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:24:53.853] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:24:53.858] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.860] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.861] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.861] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.862] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.862] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.866] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.866] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.869] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.870] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:24:53.873] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.874] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.876] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.877] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:24:53.879] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:24:53.881] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:24:53.882] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:24:53.883] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:24:53.884] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:24:53.885] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:24:53.886] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.6751ms
[2025-12-23 00:24:53.888] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.9129ms
[2025-12-23 00:24:53.889] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.889] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:24:53.890] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 37.2706ms
[2025-12-23 00:24:53.891] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 38.2249ms
[2025-12-23 00:24:53.894] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:24:53.898] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.899] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.8504ms
[2025-12-23 00:24:53.901] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:24:53.904] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.905] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:24:53.909] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.942] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:24:53.946] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:24:53.947] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:24:53.950] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 39.672ms
[2025-12-23 00:24:53.951] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:24:53.952] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 51.1525ms
[2025-12-23 00:24:53.956] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:24:53.957] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.958] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.3921ms
[2025-12-23 00:24:53.960] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:24:53.963] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:53.964] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:24:53.967] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:53.988] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:24:53.991] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:24:54.002] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 32.7538ms
[2025-12-23 00:24:54.003] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:24:54.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 44.4677ms
[2025-12-23 00:24:54.007] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:24:54.009] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:54.009] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 2.4131ms
[2025-12-23 00:24:54.011] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:24:54.014] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:54.015] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:54.015] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:54.018] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:24:54.021] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:24:54.026] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:24:54.027] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.9201ms
[2025-12-23 00:24:54.029] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:54.029] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 18.61ms
[2025-12-23 00:24:54.033] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:24:54.035] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:54.035] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.3459ms
[2025-12-23 00:24:54.037] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:24:54.040] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:24:54.041] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:54.042] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:24:54.045] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:24:54.048] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:24:54.053] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:24:54.054] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.974ms
[2025-12-23 00:24:54.056] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:24:54.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 19.922ms
[2025-12-23 00:29:23.694] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:29:23.694] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:29:23.698] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.699] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.700] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.0432ms
[2025-12-23 00:29:23.701] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 6.7835ms
[2025-12-23 00:29:23.703] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:29:23.703] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:29:23.708] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.710] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.713] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.713] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.714] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.714] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.722] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.724] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:23.730] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.732] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:23.735] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.735] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.740] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.740] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.748] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:29:23.749] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:29:23.751] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:29:23.752] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:29:23.753] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:29:23.754] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:29:23.756] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 38.1838ms
[2025-12-23 00:29:23.757] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 40.9946ms
[2025-12-23 00:29:23.759] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.763] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.764] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 61.0396ms
[2025-12-23 00:29:23.764] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 60.9213ms
[2025-12-23 00:29:23.771] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:29:23.771] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:29:23.773] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.775] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.776] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.5814ms
[2025-12-23 00:29:23.776] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.3266ms
[2025-12-23 00:29:23.781] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:29:23.781] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:29:23.784] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.787] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.787] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.788] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:23.788] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.789] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.797] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:29:23.798] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:23.802] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:23.803] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:29:23.805] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.810] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:29:23.813] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.9388ms
[2025-12-23 00:29:23.813] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.814] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:23.817] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 36.1971ms
[2025-12-23 00:29:23.817] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:29:23.822] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:29:23.823] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:29:23.825] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 34.6385ms
[2025-12-23 00:29:23.828] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.830] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 49.5274ms
[2025-12-23 00:29:23.835] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:29:23.836] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:29:23.837] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.839] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.840] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.6757ms
[2025-12-23 00:29:23.841] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.846] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.852] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:23.853] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:29:23.857] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.857] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:23.858] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:23.865] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.865] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.881] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:29:23.884] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:23.890] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:29:23.903] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:29:23.918] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:29:23.913] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:29:23.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:29:23.920] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 46.5489ms
[2025-12-23 00:29:23.923] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:23.922] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 73.6433ms
[2025-12-23 00:29:23.930] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 77.1352ms
[2025-12-23 00:29:23.938] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.945] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 108.9985ms
[2025-12-23 00:29:23.967] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:29:23.967] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:29:23.980] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.982] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.983] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 16.4396ms
[2025-12-23 00:29:23.984] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 16.6916ms
[2025-12-23 00:29:23.985] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:29:23.992] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.986] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:29:23.995] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:23.997] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:23.998] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:23.999] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:24.001] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:24.003] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:24.005] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:24.006] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:24.009] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:29:24.012] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:24.014] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:24.015] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:24.017] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:29:24.019] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:29:24.021] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:29:24.021] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:29:24.023] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:29:24.024] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:29:24.026] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:29:24.028] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.6018ms
[2025-12-23 00:29:24.030] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 26.781ms
[2025-12-23 00:29:24.031] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:24.032] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:29:24.033] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 47.3831ms
[2025-12-23 00:29:24.034] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 47.7196ms
[2025-12-23 00:29:24.045] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:29:24.048] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.091] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 45.7795ms
[2025-12-23 00:29:24.097] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:29:24.105] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.106] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:29:24.107] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:24.133] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:29:24.135] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:29:24.136] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:29:24.138] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 21.6698ms
[2025-12-23 00:29:24.139] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:29:24.140] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 43.4805ms
[2025-12-23 00:29:24.149] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:29:24.152] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.153] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.4106ms
[2025-12-23 00:29:24.159] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:29:24.164] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.165] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:29:24.167] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:24.185] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:29:24.188] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:29:24.189] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 15.9972ms
[2025-12-23 00:29:24.197] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:29:24.199] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 39.9639ms
[2025-12-23 00:29:24.206] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:29:24.211] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.212] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 5.8901ms
[2025-12-23 00:29:24.215] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:29:24.217] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.218] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:24.219] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:24.222] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:29:24.229] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:29:24.235] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:29:24.236] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.4696ms
[2025-12-23 00:29:24.238] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:24.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 23.8447ms
[2025-12-23 00:29:24.247] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:29:24.249] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.249] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 2.5963ms
[2025-12-23 00:29:24.251] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:29:24.254] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:29:24.255] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:24.256] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:29:24.260] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:29:24.265] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 171
[2025-12-23 00:29:24.270] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:29:24.271] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.4089ms
[2025-12-23 00:29:24.273] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:29:24.273] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 22.0838ms
[2025-12-23 00:30:05.635] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:30:05.859] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:30:05.879] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:30:05.970] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:30:05.971] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:30:06.032] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:30:06.035] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:30:06.036] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:30:06.104] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:30:06.217] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 113.1676ms
[2025-12-23 00:30:06.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/swagger-ui-bundle.js - null null
[2025-12-23 00:30:06.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/swagger-ui-standalone-preset.js - null null
[2025-12-23 00:30:06.247] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:30:06.252] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 5.3066ms
[2025-12-23 00:30:06.253] [INF] [Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
[2025-12-23 00:30:06.256] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:30:06.259] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 26.1597ms
[2025-12-23 00:30:06.262] [INF] [Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
[2025-12-23 00:30:06.265] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 31.9578ms
[2025-12-23 00:30:06.285] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 28.9224ms
[2025-12-23 00:30:06.688] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:30:06.724] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 36.5518ms
[2025-12-23 00:30:11.078] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:30:11.087] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:11.089] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 11.6421ms
[2025-12-23 00:30:11.094] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:30:11.104] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:11.130] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:30:11.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:30:11.134] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:11.138] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:11.139] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.2851ms
[2025-12-23 00:30:11.146] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 14.8093ms
[2025-12-23 00:30:11.146] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:30:11.149] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:30:11.155] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:11.158] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:11.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:30:11.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:11.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:11.207] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:30:11.207] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:11.207] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.645] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.645] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (29ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:30:12.645] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.679] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.680] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.692] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.692] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.700] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.700] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.713] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:30:12.729] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 1517.3607ms
[2025-12-23 00:30:12.729] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:30:12.730] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:30:12.731] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:30:12.734] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:30:12.734] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:30:12.737] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:30:12.737] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:30:12.741] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 1647.2843ms
[2025-12-23 00:30:12.744] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1533.6459ms
[2025-12-23 00:30:12.744] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1531.9815ms
[2025-12-23 00:30:12.746] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.746] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.747] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 1598.274ms
[2025-12-23 00:30:12.748] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 1601.8998ms
[2025-12-23 00:30:12.752] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:30:12.752] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:30:12.755] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.757] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.758] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 5.9485ms
[2025-12-23 00:30:12.759] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 204 null null 6.7853ms
[2025-12-23 00:30:12.761] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:30:12.761] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - null null
[2025-12-23 00:30:12.766] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.768] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.772] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.772] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:12.774] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.779] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.821] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-30T21:00:00.0000000Z", EndDate: "2025-12-31T20:59:59.9990000Z"
[2025-12-23 00:30:12.823] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.827] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.830] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.833] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.836] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:30:12.839] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:30:12.840] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:30:12.842] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 65.8423ms
[2025-12-23 00:30:12.843] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.844] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 200 null application/json; charset=utf-8 83.2945ms
[2025-12-23 00:30:12.846] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:30:12.876] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:30:12.877] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 96.3354ms
[2025-12-23 00:30:12.878] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:12.879] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-30T21:00:00.000Z&endDate=2025-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 118.587ms
[2025-12-23 00:30:12.883] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:30:12.883] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:30:12.884] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.886] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.887] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 204 null null 4.2185ms
[2025-12-23 00:30:12.888] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.888] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - null null
[2025-12-23 00:30:12.891] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.893] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.895] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:12.896] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.897] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.899] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-10-31T21:00:00.0000000Z", EndDate: "2025-11-30T20:59:59.9990000Z"
[2025-12-23 00:30:12.901] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.904] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.904] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:30:12.906] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.911] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:30:12.913] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.688ms
[2025-12-23 00:30:12.913] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:30:12.914] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:12.915] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:30:12.916] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 500 null text/plain; charset=utf-8 27.6476ms
[2025-12-23 00:30:12.917] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:30:12.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 26.5109ms
[2025-12-23 00:30:12.922] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.923] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-10-31T21:00:00.000Z&endDate=2025-11-30T20:59:59.999Z - 200 null application/json; charset=utf-8 39.9396ms
[2025-12-23 00:30:12.926] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:30:12.926] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:30:12.929] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.931] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.932] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 204 null null 5.3717ms
[2025-12-23 00:30:12.932] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 204 null null 5.9471ms
[2025-12-23 00:30:12.934] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - null null
[2025-12-23 00:30:12.934] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - null null
[2025-12-23 00:30:12.939] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.942] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.943] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.943] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.944] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.945] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:12.948] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.949] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.951] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.953] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
[2025-12-23 00:30:12.954] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.956] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.958] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.960] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:12.962] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:30:12.963] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__localStartDate_0='?' (DbType = DateTime), @__localEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__localStartDate_0 AND [o].[CreatedAt] <= @__localEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:30:12.964] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:30:12.965] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 5760.00, Заказов: 2
[2025-12-23 00:30:12.966] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:30:12.967] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:30:12.968] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.7687ms
[2025-12-23 00:30:12.970] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.5616ms
[2025-12-23 00:30:12.971] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.971] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:30:12.972] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T21:00:00.000Z&endDate=2025-12-22T20:59:59.999Z - 200 null application/json; charset=utf-8 38.1737ms
[2025-12-23 00:30:12.973] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T21:00:00.000Z&endDate=2025-12-23T20:59:59.999Z - 200 null application/json; charset=utf-8 38.8752ms
[2025-12-23 00:30:12.977] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:30:12.981] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.981] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.5241ms
[2025-12-23 00:30:12.983] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:30:12.986] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:12.987] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:30:12.993] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:13.032] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:30:13.035] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:30:13.036] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:30:13.041] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 45.7669ms
[2025-12-23 00:30:13.043] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:30:13.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 60.1195ms
[2025-12-23 00:30:13.047] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:30:13.050] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:13.050] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.9395ms
[2025-12-23 00:30:13.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:30:13.056] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:13.057] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:30:13.062] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:13.083] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:30:13.086] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:30:13.090] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 26.1528ms
[2025-12-23 00:30:13.092] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:30:13.093] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 41.0268ms
[2025-12-23 00:30:13.096] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:30:13.099] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:13.099] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 204 null null 3.0709ms
[2025-12-23 00:30:13.102] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - null null
[2025-12-23 00:30:13.105] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:13.106] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:13.106] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:13.110] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-12-22T21:00:00.0000000Z", EndDate: "2035-12-23T20:59:59.9990000Z"
[2025-12-23 00:30:13.115] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:30:13.122] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:30:13.124] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.3701ms
[2025-12-23 00:30:13.126] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:13.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-12-22T21:00:00.000Z&endDate=2035-12-23T20:59:59.999Z - 500 null text/plain; charset=utf-8 24.8891ms
[2025-12-23 00:30:13.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:30:13.133] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:13.134] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 204 null null 3.3055ms
[2025-12-23 00:30:13.136] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - null null
[2025-12-23 00:30:13.139] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:13.141] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:13.143] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:30:13.147] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-12-22T21:00:00.0000000Z", EndDate: "2026-12-31T20:59:59.9990000Z"
[2025-12-23 00:30:13.152] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __localStartDate_0)
    .Where(o => o.CreatedAt <= __localEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:30:13.157] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:30:13.159] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.924ms
[2025-12-23 00:30:13.161] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:30:13.162] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-12-22T21:00:00.000Z&endDate=2026-12-31T20:59:59.999Z - 500 null text/plain; charset=utf-8 26.4588ms
[2025-12-23 00:30:52.733] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:30:52.737] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:52.739] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 5.1943ms
[2025-12-23 00:30:52.742] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:30:52.749] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:52.751] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:30:52.761] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:30:52.778] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:52.807] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:30:52.925] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:30:52.927] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:30:52.931] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 167.9133ms
[2025-12-23 00:30:52.932] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:30:52.933] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 191.0355ms
[2025-12-23 00:30:52.935] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:30:52.937] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:52.938] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 2.8661ms
[2025-12-23 00:30:52.941] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:30:52.945] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:52.946] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:30:52.951] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:30:52.961] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:52.979] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:30:53.035] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:30:53.037] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:30:53.041] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 89.0609ms
[2025-12-23 00:30:53.042] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:30:53.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 102.1566ms
[2025-12-23 00:30:53.047] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:30:53.049] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:53.050] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 2.9927ms
[2025-12-23 00:30:53.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:30:53.054] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:53.055] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:30:53.060] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:30:53.070] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:53.088] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:30:53.114] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 24, Страница: 1
[2025-12-23 00:30:53.115] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:30:53.124] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 62.0531ms
[2025-12-23 00:30:53.125] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:30:53.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 74.1104ms
[2025-12-23 00:30:57.886] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=2&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:30:57.888] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:57.888] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=2&pageSize=20&sortBy=createdAt&order=desc - 204 null null 2.6334ms
[2025-12-23 00:30:57.891] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=2&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:30:57.895] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:30:57.896] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:30:57.897] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:30:57.901] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:30:57.915] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_0 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:30:57.918] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 4, Всего: 24, Страница: 2
[2025-12-23 00:30:57.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:30:57.920] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 22.2813ms
[2025-12-23 00:30:57.921] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:30:57.922] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=2&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 31.2689ms
[2025-12-23 00:32:02.577] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:32:02.581] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:32:02.582] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 5.4645ms
[2025-12-23 00:32:02.584] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:32:02.587] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:32:02.589] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:32:02.590] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:32:02.595] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:32:02.601] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:32:02.604] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 24, Страница: 1
[2025-12-23 00:32:02.605] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:32:02.608] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 16.7671ms
[2025-12-23 00:32:02.609] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:32:02.610] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 25.6617ms
[2025-12-23 00:36:57.605] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:36:57.874] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:36:57.897] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:36:58.012] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:36:58.013] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:36:58.107] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:36:58.109] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:36:58.111] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:36:58.500] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:36:58.632] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 133.1873ms
[2025-12-23 00:36:58.659] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:36:58.659] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:36:58.667] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 7.4708ms
[2025-12-23 00:36:58.692] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 32.5428ms
[2025-12-23 00:36:59.188] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:36:59.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 56.4807ms
[2025-12-23 00:37:00.622] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:37:00.622] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:37:00.622] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:37:00.631] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.631] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.635] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 15.0612ms
[2025-12-23 00:37:00.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 15.063ms
[2025-12-23 00:37:00.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 15.504ms
[2025-12-23 00:37:00.640] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:37:00.640] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:37:00.641] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:37:00.658] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.659] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.661] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.769] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:37:00.769] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:37:00.771] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:37:00.806] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:37:00.806] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:37:00.806] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:37:00.870] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:37:00.872] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:37:00.874] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.877] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 7.9692ms
[2025-12-23 00:37:00.878] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.880] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:37:00.884] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 12.5001ms
[2025-12-23 00:37:00.887] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.888] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:37:00.895] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:00.897] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:00.898] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:00.907] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:00.908] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:02.596] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.596] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.596] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.596] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.596] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (18ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:02.708] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.712] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:02.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.721] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.729] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.729] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.757] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:37:02.758] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:37:02.767] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:37:02.767] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:37:02.772] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:37:02.772] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:37:02.782] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:37:02.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:37:02.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:37:02.804] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1887.0168ms
[2025-12-23 00:37:02.804] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1890.8623ms
[2025-12-23 00:37:02.806] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:02.807] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:02.816] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:02.816] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:02.817] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 1937.4404ms
[2025-12-23 00:37:02.817] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 1929.3008ms
[2025-12-23 00:37:02.821] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:02.823] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:02.851] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 34.3062ms
[2025-12-23 00:37:02.852] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 35.2383ms
[2025-12-23 00:37:02.854] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:02.854] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:02.861] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:02.864] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:02.867] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:02.868] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:02.869] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:02.871] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:37:02.871] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:37:02.875] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:37:02.875] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:37:02.875] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:02.884] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 2071.5071ms
[2025-12-23 00:37:02.884] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:37:02.884] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 2068.6396ms
[2025-12-23 00:37:02.885] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:37:02.887] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:37:02.889] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:37:02.890] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 2250.0746ms
[2025-12-23 00:37:02.895] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 2254.7812ms
[2025-12-23 00:37:02.900] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 2090.7601ms
[2025-12-23 00:37:02.907] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:37:02.908] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 2267.275ms
[2025-12-23 00:37:02.934] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:37:02.940] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:02.948] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:02.954] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.962] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:02.973] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:37:02.978] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:37:02.978] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:37:02.980] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:37:03.017] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:37:03.018] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 146.0722ms
[2025-12-23 00:37:03.019] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 139.5298ms
[2025-12-23 00:37:03.020] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.021] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.022] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 168.1941ms
[2025-12-23 00:37:03.023] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 168.6659ms
[2025-12-23 00:37:03.026] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:37:03.026] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:37:03.033] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.036] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.038] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 11.9368ms
[2025-12-23 00:37:03.040] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.040] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:37:03.046] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.050] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.053] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.055] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.056] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:03.060] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:37:03.062] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:03.066] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:37:03.067] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:03.076] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:37:03.080] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:03.081] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 21.8237ms
[2025-12-23 00:37:03.084] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.084] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:37:03.086] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 45.2811ms
[2025-12-23 00:37:03.088] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:37:03.092] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:37:03.094] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 42.9159ms
[2025-12-23 00:37:03.097] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.099] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 72.7612ms
[2025-12-23 00:37:03.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:37:03.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:37:03.105] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.109] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.110] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 7.2554ms
[2025-12-23 00:37:03.110] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 7.7335ms
[2025-12-23 00:37:03.113] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:37:03.113] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:37:03.121] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.126] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.128] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.129] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.130] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.131] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.140] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:03.140] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:03.147] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:03.148] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:37:03.156] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:03.156] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:03.163] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:03.163] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:37:03.171] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:37:03.172] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:37:03.175] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:37:03.178] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:37:03.179] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:37:03.181] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:37:03.183] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 48.3894ms
[2025-12-23 00:37:03.185] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 51.5802ms
[2025-12-23 00:37:03.186] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.187] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:37:03.188] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 75.3017ms
[2025-12-23 00:37:03.189] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 76.7553ms
[2025-12-23 00:37:03.193] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:37:03.201] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.202] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 9.4564ms
[2025-12-23 00:37:03.205] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:37:03.210] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.213] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:37:03.222] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.289] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:37:03.292] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:37:03.294] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:37:03.299] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 75.565ms
[2025-12-23 00:37:03.301] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:37:03.302] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 96.9455ms
[2025-12-23 00:37:03.305] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:37:03.309] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.310] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 5.0306ms
[2025-12-23 00:37:03.313] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:37:03.316] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.318] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:37:03.324] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.356] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:37:03.359] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:37:03.363] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 35.9499ms
[2025-12-23 00:37:03.366] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:37:03.367] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 54.1904ms
[2025-12-23 00:37:03.371] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:03.374] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.376] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 4.7664ms
[2025-12-23 00:37:03.378] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:03.383] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.385] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.387] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.391] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:37:03.397] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:37:03.407] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:37:03.410] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.353ms
[2025-12-23 00:37:03.414] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 38.0156ms
[2025-12-23 00:37:03.421] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:03.425] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.426] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.7479ms
[2025-12-23 00:37:03.428] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:37:03.435] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:37:03.437] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.440] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:37:03.444] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:37:03.454] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:37:03.464] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:37:03.466] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 24.5431ms
[2025-12-23 00:37:03.468] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:37:03.469] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 40.9747ms
[2025-12-23 00:39:35.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:39:35.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:35.050] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.052] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.6466ms
[2025-12-23 00:39:35.053] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 10.3125ms
[2025-12-23 00:39:35.056] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:39:35.056] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:35.061] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.063] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.066] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.066] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.067] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.068] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.077] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.077] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.085] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.090] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.091] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.093] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.097] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.099] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.106] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:39:35.108] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:39:35.108] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:35.109] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:35.111] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:39:35.119] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 49.5423ms
[2025-12-23 00:39:35.119] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:35.121] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.122] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 52.0951ms
[2025-12-23 00:39:35.122] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 66.1771ms
[2025-12-23 00:39:35.123] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 69.7257ms
[2025-12-23 00:39:35.140] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.140] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.142] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.147] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.148] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 7.6381ms
[2025-12-23 00:39:35.148] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 7.929ms
[2025-12-23 00:39:35.153] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.153] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.160] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.164] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.165] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.166] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.166] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.169] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.172] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:35.175] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.177] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:35.180] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.189] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:35.191] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.4349ms
[2025-12-23 00:39:35.191] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.192] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.194] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 41.0712ms
[2025-12-23 00:39:35.197] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.204] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:35.208] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:39:35.209] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:35.210] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 38.6099ms
[2025-12-23 00:39:35.215] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.217] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 63.604ms
[2025-12-23 00:39:35.223] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:35.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:35.225] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.227] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.228] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.0932ms
[2025-12-23 00:39:35.233] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.234] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:35.236] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.238] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.240] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.241] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.241] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.244] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:39:35.250] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.258] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.260] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:35.267] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.274] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:35.317] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:35.318] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 75.551ms
[2025-12-23 00:39:35.322] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:39:35.324] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.325] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:35.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 91.5257ms
[2025-12-23 00:39:35.327] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 88.6039ms
[2025-12-23 00:39:35.337] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.338] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 114.2353ms
[2025-12-23 00:39:35.343] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:39:35.343] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:39:35.351] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.353] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.353] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 10.5302ms
[2025-12-23 00:39:35.354] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 11.6523ms
[2025-12-23 00:39:35.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:39:35.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:39:35.368] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.370] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.371] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.371] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.372] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.372] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.376] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.378] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.384] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.386] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:35.387] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.390] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.391] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.393] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:35.397] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:35.401] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:39:35.401] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:35.402] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:35.403] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:39:35.404] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 30.1891ms
[2025-12-23 00:39:35.404] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:35.406] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.407] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 31.8481ms
[2025-12-23 00:39:35.408] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 51.0642ms
[2025-12-23 00:39:35.417] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:35.422] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 64.5108ms
[2025-12-23 00:39:35.431] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:39:35.433] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.434] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 6.6544ms
[2025-12-23 00:39:35.436] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:39:35.440] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.441] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:39:35.442] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.460] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:39:35.463] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:39:35.465] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:39:35.467] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 22.8004ms
[2025-12-23 00:39:35.469] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:39:35.470] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 33.6322ms
[2025-12-23 00:39:35.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:39:35.476] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.477] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.707ms
[2025-12-23 00:39:35.481] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:39:35.486] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.487] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:39:35.488] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.502] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:39:35.504] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:39:35.506] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 16.2455ms
[2025-12-23 00:39:35.507] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:39:35.508] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 27.5253ms
[2025-12-23 00:39:35.514] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.517] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.518] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 4.2983ms
[2025-12-23 00:39:35.520] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.522] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.524] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.525] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.528] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:35.535] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:35.541] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:35.542] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.7548ms
[2025-12-23 00:39:35.543] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.544] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 24.3152ms
[2025-12-23 00:39:35.556] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.558] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.559] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.9309ms
[2025-12-23 00:39:35.562] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:35.568] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:35.569] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.570] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:35.572] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:35.577] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:35.585] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:35.586] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.5002ms
[2025-12-23 00:39:35.587] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:35.588] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 26.0966ms
[2025-12-23 00:39:45.437] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:39:45.437] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:45.440] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.442] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.442] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 5.1435ms
[2025-12-23 00:39:45.443] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.1777ms
[2025-12-23 00:39:45.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:39:45.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:45.453] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.455] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.456] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.457] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.458] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.458] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.467] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.467] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.471] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.472] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.475] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.476] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.480] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.484] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.486] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:45.487] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:39:45.488] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:39:45.490] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:39:45.491] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:45.492] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:45.493] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.0786ms
[2025-12-23 00:39:45.494] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 34.2771ms
[2025-12-23 00:39:45.497] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.498] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.500] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 51.9823ms
[2025-12-23 00:39:45.500] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 52.6222ms
[2025-12-23 00:39:45.505] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.505] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.508] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.510] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.510] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.8657ms
[2025-12-23 00:39:45.513] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 7.1141ms
[2025-12-23 00:39:45.514] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.517] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.522] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.524] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.525] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.525] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.526] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.527] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.533] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:45.536] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.538] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:45.539] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.544] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:45.550] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 18.6933ms
[2025-12-23 00:39:45.551] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.552] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 40.4747ms
[2025-12-23 00:39:45.554] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.560] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:45.564] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:39:45.566] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:45.567] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 33.4191ms
[2025-12-23 00:39:45.568] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.569] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 52.5406ms
[2025-12-23 00:39:45.573] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:45.573] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:45.575] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.577] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.579] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.6755ms
[2025-12-23 00:39:45.581] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.583] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:45.584] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.586] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.589] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.590] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.590] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.592] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:39:45.594] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.599] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:45.600] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.605] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:45.607] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.607] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.904ms
[2025-12-23 00:39:45.610] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.610] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:45.611] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 28.1485ms
[2025-12-23 00:39:45.616] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:39:45.620] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:45.621] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 32.965ms
[2025-12-23 00:39:45.622] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.623] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 49.5594ms
[2025-12-23 00:39:45.626] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:39:45.626] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:39:45.630] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.633] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.633] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 7.18ms
[2025-12-23 00:39:45.634] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 7.9619ms
[2025-12-23 00:39:45.636] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:39:45.636] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:39:45.642] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.644] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.645] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.647] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.648] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.649] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.653] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.657] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.658] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.660] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.666] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:45.668] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.670] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.671] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:45.672] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:45.673] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:39:45.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:45.676] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:45.679] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.1965ms
[2025-12-23 00:39:45.683] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:39:45.684] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.686] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:45.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 50.9442ms
[2025-12-23 00:39:45.688] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 35.6383ms
[2025-12-23 00:39:45.691] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:45.692] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 56.1846ms
[2025-12-23 00:39:45.702] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:39:45.704] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.704] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 2.7834ms
[2025-12-23 00:39:45.706] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:39:45.709] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.710] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:39:45.711] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:39:45.721] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:39:45.722] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:39:45.723] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 8.6484ms
[2025-12-23 00:39:45.724] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:39:45.725] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 18.6755ms
[2025-12-23 00:39:45.731] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:39:45.734] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.735] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.8695ms
[2025-12-23 00:39:45.737] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:39:45.740] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.741] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:39:45.742] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.752] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:39:45.754] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:39:45.756] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 7.6624ms
[2025-12-23 00:39:45.757] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:39:45.758] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 20.9399ms
[2025-12-23 00:39:45.765] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.767] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.768] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.9309ms
[2025-12-23 00:39:45.770] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.773] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.774] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.775] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.777] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:45.784] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:45.789] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:45.790] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.6069ms
[2025-12-23 00:39:45.791] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.792] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 21.8899ms
[2025-12-23 00:39:45.801] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.803] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.803] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.3655ms
[2025-12-23 00:39:45.805] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:45.808] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:45.810] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.810] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:45.817] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:45.820] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:45.825] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:45.826] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.5802ms
[2025-12-23 00:39:45.830] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:45.832] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 26.4458ms
[2025-12-23 00:39:51.318] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:51.318] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:39:51.320] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.323] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.324] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.6136ms
[2025-12-23 00:39:51.325] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.3675ms
[2025-12-23 00:39:51.327] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:51.327] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:39:51.336] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.338] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.339] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.340] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.341] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.341] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.346] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.349] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.351] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.352] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.354] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.355] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.357] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.363] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:51.366] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:39:51.367] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:39:51.369] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:39:51.370] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:51.371] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:51.372] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.4176ms
[2025-12-23 00:39:51.374] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.2789ms
[2025-12-23 00:39:51.375] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.376] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.376] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 49.9243ms
[2025-12-23 00:39:51.378] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 51.3432ms
[2025-12-23 00:39:51.387] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.387] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.388] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.390] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.391] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.3446ms
[2025-12-23 00:39:51.392] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.709ms
[2025-12-23 00:39:51.393] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.394] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.401] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.403] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.404] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.405] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.406] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.406] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.409] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:51.411] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.416] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:51.417] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.422] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:51.424] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.424] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.2787ms
[2025-12-23 00:39:51.426] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.427] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.432] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 38.7553ms
[2025-12-23 00:39:51.433] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:51.438] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:39:51.439] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:51.440] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 30.5679ms
[2025-12-23 00:39:51.441] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.442] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 48.382ms
[2025-12-23 00:39:51.446] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:51.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:51.450] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.453] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.453] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 7.2839ms
[2025-12-23 00:39:51.454] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.455] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:39:51.457] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.459] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.461] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.462] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.463] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.466] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.467] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:39:51.469] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.471] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:51.472] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.477] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:51.484] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.1633ms
[2025-12-23 00:39:51.484] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:51.485] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.487] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:39:51.488] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 33.0662ms
[2025-12-23 00:39:51.489] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:51.493] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 32.3255ms
[2025-12-23 00:39:51.494] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.495] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 44.8081ms
[2025-12-23 00:39:51.503] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:39:51.503] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:39:51.505] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.508] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.509] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 5.2134ms
[2025-12-23 00:39:51.509] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.7703ms
[2025-12-23 00:39:51.512] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:39:51.512] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:39:51.519] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.521] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.522] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.522] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.523] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.524] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.527] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.530] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.533] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.534] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:39:51.536] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.538] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.540] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.541] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:39:51.544] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:51.547] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:39:51.549] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:39:51.550] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:39:51.551] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:51.552] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:39:51.553] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.1146ms
[2025-12-23 00:39:51.554] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.8461ms
[2025-12-23 00:39:51.555] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.556] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:39:51.557] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 45.5703ms
[2025-12-23 00:39:51.558] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 46.276ms
[2025-12-23 00:39:51.565] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:39:51.569] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.570] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 4.0958ms
[2025-12-23 00:39:51.571] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:39:51.582] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.586] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:39:51.587] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.594] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:39:51.596] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:39:51.599] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:39:51.600] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 12.199ms
[2025-12-23 00:39:51.601] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:39:51.602] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 31.2825ms
[2025-12-23 00:39:51.606] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:39:51.608] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.609] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.8234ms
[2025-12-23 00:39:51.611] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:39:51.615] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.617] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:39:51.618] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.624] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:39:51.626] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:39:51.635] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 14.0014ms
[2025-12-23 00:39:51.636] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:39:51.638] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 26.6757ms
[2025-12-23 00:39:51.656] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.658] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.658] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.6699ms
[2025-12-23 00:39:51.660] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.669] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.669] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.670] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.671] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:51.674] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:51.680] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:51.682] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.2473ms
[2025-12-23 00:39:51.690] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.691] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 30.3511ms
[2025-12-23 00:39:51.705] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.707] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.708] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.7979ms
[2025-12-23 00:39:51.709] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:39:51.716] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:39:51.717] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.719] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:39:51.721] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:39:51.724] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:39:51.732] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:39:51.734] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.2979ms
[2025-12-23 00:39:51.735] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:39:51.736] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 26.5908ms
[2025-12-23 00:40:11.859] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:40:11.859] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:40:11.864] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.867] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.868] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.0686ms
[2025-12-23 00:40:11.868] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 9.4185ms
[2025-12-23 00:40:11.871] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:40:11.871] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:40:11.875] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.879] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.880] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.880] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.882] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:11.883] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:11.890] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:11.890] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.895] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:11.897] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.900] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.900] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.904] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.904] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.909] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:40:11.911] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:40:11.912] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:40:11.914] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:40:11.916] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:40:11.917] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:40:11.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 31.8289ms
[2025-12-23 00:40:11.920] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 34.7729ms
[2025-12-23 00:40:11.921] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.922] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.923] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 52.1442ms
[2025-12-23 00:40:11.924] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 52.9688ms
[2025-12-23 00:40:11.932] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:11.932] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:11.934] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.936] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.937] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.5163ms
[2025-12-23 00:40:11.938] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.9824ms
[2025-12-23 00:40:11.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:11.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:11.945] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.948] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.949] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:11.950] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.951] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:11.952] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:11.954] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:40:11.956] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:11.957] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:40:11.958] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:11.965] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:40:11.967] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.968] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.6465ms
[2025-12-23 00:40:11.970] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:11.971] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:11.973] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 33.3173ms
[2025-12-23 00:40:11.973] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:40:11.978] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:40:11.980] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:40:11.982] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.8798ms
[2025-12-23 00:40:11.984] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.985] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 44.7022ms
[2025-12-23 00:40:11.988] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:40:11.988] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:40:11.990] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.992] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:11.992] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 4.1681ms
[2025-12-23 00:40:11.993] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:11.995] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:40:11.999] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.001] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.003] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:12.004] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:12.004] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.007] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:12.009] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:40:12.011] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:12.016] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:40:12.016] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:12.022] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:40:12.024] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:40:12.024] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.7408ms
[2025-12-23 00:40:12.025] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:40:12.026] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:12.027] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:40:12.028] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 33.1997ms
[2025-12-23 00:40:12.030] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.2292ms
[2025-12-23 00:40:12.034] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:12.035] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 46.964ms
[2025-12-23 00:40:12.039] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:40:12.039] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:40:12.041] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.043] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.044] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 4.5229ms
[2025-12-23 00:40:12.045] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.5099ms
[2025-12-23 00:40:12.047] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:40:12.048] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:40:12.053] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.056] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.056] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:12.057] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:12.058] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.059] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.062] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:12.063] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:12.066] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:12.067] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:40:12.069] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:12.070] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:12.072] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:12.073] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:40:12.075] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:40:12.078] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:40:12.081] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:40:12.084] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:40:12.086] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:40:12.087] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:40:12.089] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.45ms
[2025-12-23 00:40:12.090] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.7347ms
[2025-12-23 00:40:12.091] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:12.092] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:40:12.093] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 46.6422ms
[2025-12-23 00:40:12.098] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 50.0115ms
[2025-12-23 00:40:12.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:40:12.118] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.124] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 21.2757ms
[2025-12-23 00:40:12.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:40:12.141] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.142] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:40:12.143] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.206] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (57ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:40:12.222] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:40:12.222] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:40:12.224] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 76.5697ms
[2025-12-23 00:40:12.225] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:40:12.226] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 94.7664ms
[2025-12-23 00:40:12.234] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:40:12.236] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.237] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.1856ms
[2025-12-23 00:40:12.239] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:40:12.242] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.243] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:40:12.244] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.258] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:40:12.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:40:12.271] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 24.9439ms
[2025-12-23 00:40:12.274] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:40:12.275] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 35.9782ms
[2025-12-23 00:40:12.286] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:12.301] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.302] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 16.4149ms
[2025-12-23 00:40:12.304] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:12.308] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.309] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:12.313] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.317] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:40:12.321] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:40:12.326] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:40:12.331] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.9492ms
[2025-12-23 00:40:12.332] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:12.333] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 28.9211ms
[2025-12-23 00:40:12.338] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:12.341] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.342] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.1547ms
[2025-12-23 00:40:12.344] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:40:12.350] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:40:12.351] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:12.352] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:40:12.354] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:40:12.357] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:40:12.365] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:40:12.367] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.0697ms
[2025-12-23 00:40:12.368] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:40:12.369] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 25.1967ms
[2025-12-23 00:41:11.602] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:41:11.809] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:41:11.828] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:41:11.911] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:41:11.912] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:41:11.979] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:41:11.982] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:41:11.983] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:41:11.984] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:41:12.097] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 114.7202ms
[2025-12-23 00:41:12.112] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:41:12.112] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:41:12.120] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 7.1884ms
[2025-12-23 00:41:12.138] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.5878ms
[2025-12-23 00:41:12.273] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:41:12.304] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.5353ms
[2025-12-23 00:41:16.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:41:16.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:41:16.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:41:16.787] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:16.787] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:16.790] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:16.793] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 18.7396ms
[2025-12-23 00:41:16.793] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 18.7498ms
[2025-12-23 00:41:16.793] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 18.772ms
[2025-12-23 00:41:16.797] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:41:16.797] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:41:16.797] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:41:16.810] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:16.812] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:16.815] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:16.894] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:41:16.894] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:41:16.895] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:41:16.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:41:16.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:41:16.921] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:41:18.393] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:18.393] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:18.393] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:18.480] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:41:18.480] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:41:18.482] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:41:18.547] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:41:18.547] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:41:18.555] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:18.555] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:18.560] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:41:18.562] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:18.568] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 1638.8684ms
[2025-12-23 00:41:18.568] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 1640.7915ms
[2025-12-23 00:41:18.570] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:41:18.570] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:41:18.571] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 1647.3235ms
[2025-12-23 00:41:18.573] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:41:18.577] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 1780.5617ms
[2025-12-23 00:41:18.577] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 1780.9112ms
[2025-12-23 00:41:18.577] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 1780.9398ms
[2025-12-23 00:41:20.038] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:41:20.042] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:41:20.043] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.047] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.047] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.4656ms
[2025-12-23 00:41:20.048] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 6.5785ms
[2025-12-23 00:41:20.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:41:20.052] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:41:20.063] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.067] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.075] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.075] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.083] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.083] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.164] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.167] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.175] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.175] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.185] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.185] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.193] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.193] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.223] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:41:20.224] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:41:20.227] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:41:20.228] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:41:20.231] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:41:20.231] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:41:20.238] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 151.6302ms
[2025-12-23 00:41:20.238] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 149.2861ms
[2025-12-23 00:41:20.240] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.242] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.243] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 190.4928ms
[2025-12-23 00:41:20.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 191.3394ms
[2025-12-23 00:41:20.247] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.247] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.253] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.257] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.257] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 10.3098ms
[2025-12-23 00:41:20.258] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 10.8787ms
[2025-12-23 00:41:20.260] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.260] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.266] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.268] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.271] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.271] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.273] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.276] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.278] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.283] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.286] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:41:20.287] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.291] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.295] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:41:20.298] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:41:20.301] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:41:20.303] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.1159ms
[2025-12-23 00:41:20.304] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.305] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 45.5116ms
[2025-12-23 00:41:20.311] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:41:20.343] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:41:20.345] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 66.3321ms
[2025-12-23 00:41:20.346] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.347] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 87.8164ms
[2025-12-23 00:41:20.352] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:41:20.352] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:41:20.354] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.357] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.358] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 6.0864ms
[2025-12-23 00:41:20.359] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.360] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:41:20.363] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.366] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.368] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.370] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.370] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.373] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:41:20.375] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.379] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.379] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:41:20.383] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.388] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:41:20.390] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 18.7735ms
[2025-12-23 00:41:20.390] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:41:20.392] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.394] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:41:20.395] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 34.8749ms
[2025-12-23 00:41:20.396] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:41:20.401] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 33.6415ms
[2025-12-23 00:41:20.403] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.404] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 51.9597ms
[2025-12-23 00:41:20.407] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:41:20.407] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:41:20.410] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.412] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.413] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 6.08ms
[2025-12-23 00:41:20.414] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 6.911ms
[2025-12-23 00:41:20.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:41:20.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:41:20.425] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.427] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.428] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.429] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.430] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.431] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.437] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.437] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.440] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.442] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:20.444] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.446] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.448] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.451] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:41:20.453] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:41:20.455] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:41:20.456] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:41:20.458] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:41:20.459] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:41:20.460] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:41:20.461] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.0562ms
[2025-12-23 00:41:20.462] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.4065ms
[2025-12-23 00:41:20.463] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.464] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:41:20.466] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 49.458ms
[2025-12-23 00:41:20.467] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 51.2264ms
[2025-12-23 00:41:20.471] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:41:20.475] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.477] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 6.0527ms
[2025-12-23 00:41:20.479] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:41:20.484] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.486] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:41:20.493] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.562] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:41:20.569] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:41:20.573] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:20.581] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 85.5773ms
[2025-12-23 00:41:20.583] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:41:20.585] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 106.1899ms
[2025-12-23 00:41:20.588] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:41:20.592] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.593] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 4.7326ms
[2025-12-23 00:41:20.595] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:41:20.602] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.604] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:41:20.612] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.635] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:41:20.639] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:20.645] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 30.7561ms
[2025-12-23 00:41:20.647] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:41:20.649] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 53.3287ms
[2025-12-23 00:41:20.652] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.655] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.656] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 3.7592ms
[2025-12-23 00:41:20.657] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.661] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.662] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.664] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.668] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:41:20.674] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:41:20.681] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:41:20.683] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.5254ms
[2025-12-23 00:41:20.684] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 28.371ms
[2025-12-23 00:41:20.689] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.691] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.692] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.7361ms
[2025-12-23 00:41:20.694] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:20.700] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:20.701] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.702] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:20.705] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:41:20.711] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:41:20.719] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:41:20.720] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.9236ms
[2025-12-23 00:41:20.722] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:20.723] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 29.2225ms
[2025-12-23 00:41:23.188] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:23.191] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:23.191] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.5494ms
[2025-12-23 00:41:23.193] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:23.196] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:23.197] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:23.198] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:23.202] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:41:23.212] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:23.221] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:23.223] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.6554ms
[2025-12-23 00:41:23.225] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:23.225] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 32.3529ms
[2025-12-23 00:41:51.140] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:51.142] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:51.143] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.7701ms
[2025-12-23 00:41:51.145] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:51.147] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:51.149] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:51.150] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:51.153] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:41:51.156] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        Date = g.Key.ToString("yyyy-MM-dd"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:41:51.161] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:41:51.162] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.823ms
[2025-12-23 00:41:51.163] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:51.163] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 18.8092ms
[2025-12-23 00:41:59.444] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:59.448] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:59.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 5.6254ms
[2025-12-23 00:41:59.460] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:41:59.463] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:41:59.465] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:59.466] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:41:59.468] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:41:59.473] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:41:59.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:41:59.476] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.7847ms
[2025-12-23 00:41:59.477] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:41:59.478] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 18.7151ms
[2025-12-23 00:42:00.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:42:00.240] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:42:00.241] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.7866ms
[2025-12-23 00:42:00.243] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:42:00.245] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:42:00.246] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:42:00.248] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:42:00.251] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:42:00.258] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        Date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
[2025-12-23 00:42:00.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:42:00.263] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.2683ms
[2025-12-23 00:42:00.265] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:42:00.266] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 22.9975ms
[2025-12-23 00:42:01.090] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:42:01.101] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:42:01.102] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 12.1432ms
[2025-12-23 00:42:01.105] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:42:01.113] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:42:01.116] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:42:01.116] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:42:01.119] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:42:01.123] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        Date = g.Key.ToString("D4"), 
        Revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        OrdersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.Date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
[2025-12-23 00:42:01.128] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:42:01.129] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.7844ms
[2025-12-23 00:42:01.130] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:42:01.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 26.7748ms
[2025-12-23 00:42:02.487] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:42:02.490] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:42:02.491] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:42:02.491] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:42:02.494] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:42:02.500] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:42:02.503] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:42:02.504] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.3293ms
[2025-12-23 00:42:02.505] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:42:02.506] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 19.2293ms
[2025-12-23 00:45:06.888] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:45:07.122] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:45:07.143] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:45:07.248] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:45:07.249] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:45:07.319] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:45:07.320] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:45:07.323] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:45:07.381] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:45:07.507] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 127.0959ms
[2025-12-23 00:45:07.518] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:45:07.518] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:45:07.528] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 9.7662ms
[2025-12-23 00:45:07.545] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 27.1195ms
[2025-12-23 00:45:07.969] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:45:08.000] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 31.8612ms
[2025-12-23 00:45:13.589] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - null null
[2025-12-23 00:45:13.596] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:13.600] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - 204 null null 11.0629ms
[2025-12-23 00:45:13.602] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Auth/login - application/json 44
[2025-12-23 00:45:13.609] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:13.653] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 00:45:13.698] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.AuthResponseDto]] Login(RestaurantAPI.DTOs.UserLoginDto) on controller RestaurantAPI.Controllers.AuthController (RestaurantApi).
[2025-12-23 00:45:15.706] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (48ms) [Parameters=[@__dto_Username_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Users] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[Username] = @__dto_Username_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:16.563] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [JwtTokens] ([CreatedAt], [ExpiresAt], [Revoked], [RevokedAt], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
[2025-12-23 00:45:16.585] [INF] [RestaurantAPI.Controllers.AuthController] Пользователь admin успешно вошел в систему
[2025-12-23 00:45:16.595] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'RestaurantAPI.DTOs.AuthResponseDto'.
[2025-12-23 00:45:16.606] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.AuthController.Login (RestaurantApi) in 2900.8173ms
[2025-12-23 00:45:16.608] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 00:45:16.614] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Auth/login - 200 null application/json; charset=utf-8 3011.6292ms
[2025-12-23 00:45:16.615] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:45:16.619] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:16.619] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 4.4938ms
[2025-12-23 00:45:16.621] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:45:16.624] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:16.656] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:45:16.662] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:45:16.849] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:45:16.870] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:45:16.884] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 220.4072ms
[2025-12-23 00:45:16.886] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:45:16.887] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 265.5019ms
[2025-12-23 00:45:18.115] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:45:18.117] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:45:18.118] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.121] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 5.8216ms
[2025-12-23 00:45:18.121] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.124] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:45:18.125] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 8.6302ms
[2025-12-23 00:45:18.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:45:18.130] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.136] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.140] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.140] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.147] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.147] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.253] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.260] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.274] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.274] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.284] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.284] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.296] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.296] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.325] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:45:18.325] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:45:18.330] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:45:18.331] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:45:18.333] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:45:18.333] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:45:18.340] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 190.4732ms
[2025-12-23 00:45:18.340] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 191.6071ms
[2025-12-23 00:45:18.342] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.343] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.345] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 221.2075ms
[2025-12-23 00:45:18.346] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 216.5022ms
[2025-12-23 00:45:18.349] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.349] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.352] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.354] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.355] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.8883ms
[2025-12-23 00:45:18.356] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 6.5437ms
[2025-12-23 00:45:18.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.364] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.367] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.369] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.369] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.371] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.373] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.380] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.384] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:18.385] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.391] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.397] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.403] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:45:18.405] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:45:18.406] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:45:18.408] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 35.1368ms
[2025-12-23 00:45:18.409] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.412] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 54.5067ms
[2025-12-23 00:45:18.414] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:45:18.449] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:18.450] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 75.7619ms
[2025-12-23 00:45:18.452] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.453] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 95.2501ms
[2025-12-23 00:45:18.456] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:45:18.456] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:45:18.458] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.461] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.462] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.6183ms
[2025-12-23 00:45:18.463] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.464] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:45:18.466] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.469] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.471] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.476] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:45:18.477] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.491] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:45:18.494] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.499] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:18.502] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 28.4751ms
[2025-12-23 00:45:18.504] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.504] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.505] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 41.6393ms
[2025-12-23 00:45:18.511] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.519] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:45:18.521] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:45:18.523] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:45:18.525] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 54.9299ms
[2025-12-23 00:45:18.528] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.529] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 72.7149ms
[2025-12-23 00:45:18.533] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:45:18.533] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:45:18.535] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.538] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.539] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 6.3403ms
[2025-12-23 00:45:18.540] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 6.8904ms
[2025-12-23 00:45:18.541] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:45:18.542] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:45:18.550] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.553] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.554] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.555] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.556] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.557] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.567] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.567] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.573] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.573] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:18.580] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.580] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.585] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.586] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:45:18.592] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:45:18.592] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:45:18.595] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:45:18.597] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:45:18.598] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:45:18.599] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:45:18.601] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 41.8858ms
[2025-12-23 00:45:18.603] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 40.264ms
[2025-12-23 00:45:18.604] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.604] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:45:18.605] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 63.7876ms
[2025-12-23 00:45:18.606] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 64.6621ms
[2025-12-23 00:45:18.609] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:45:18.615] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.616] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 6.707ms
[2025-12-23 00:45:18.618] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:45:18.622] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.624] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:45:18.632] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.671] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:45:18.674] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:45:18.675] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:45:18.680] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 46.0531ms
[2025-12-23 00:45:18.682] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:45:18.683] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 64.6612ms
[2025-12-23 00:45:18.687] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:45:18.689] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.690] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.4079ms
[2025-12-23 00:45:18.692] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:45:18.696] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.698] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:45:18.705] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.739] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:45:18.742] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:45:18.748] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 40.7211ms
[2025-12-23 00:45:18.750] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:45:18.751] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 59.1017ms
[2025-12-23 00:45:18.754] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.757] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.758] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 4.365ms
[2025-12-23 00:45:18.761] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.768] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.769] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.770] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.774] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:18.783] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:45:18.792] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:18.795] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.0784ms
[2025-12-23 00:45:18.799] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.800] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 38.8542ms
[2025-12-23 00:45:18.809] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.812] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.813] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.1592ms
[2025-12-23 00:45:18.816] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:18.821] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:18.823] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.824] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:18.830] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:18.835] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:45:18.842] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:18.845] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.0889ms
[2025-12-23 00:45:18.846] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:18.847] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 31.6282ms
[2025-12-23 00:45:21.844] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:21.847] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:21.848] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.4388ms
[2025-12-23 00:45:21.851] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:21.854] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:21.855] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:21.856] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:21.858] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:21.872] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:21.880] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:45:21.883] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 25.7591ms
[2025-12-23 00:45:21.884] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:21.885] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 34.4721ms
[2025-12-23 00:45:22.909] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:22.912] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:22.913] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.9811ms
[2025-12-23 00:45:22.915] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:22.919] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:22.919] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:22.920] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:22.923] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:22.929] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
[2025-12-23 00:45:22.933] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:22.934] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.6506ms
[2025-12-23 00:45:22.935] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:22.936] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 21.2203ms
[2025-12-23 00:45:24.154] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:24.156] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:24.157] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.3495ms
[2025-12-23 00:45:24.161] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:24.164] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:24.165] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:24.166] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:24.169] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:24.174] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        date = g.Key.ToString("D4"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
[2025-12-23 00:45:24.179] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:24.180] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.6845ms
[2025-12-23 00:45:24.181] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:24.182] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 21.0005ms
[2025-12-23 00:45:25.203] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:25.205] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:25.206] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:25.207] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:25.210] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:25.216] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:45:25.219] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:45:25.221] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.4294ms
[2025-12-23 00:45:25.222] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:25.223] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 20.216ms
[2025-12-23 00:45:25.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:25.951] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:25.952] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.0301ms
[2025-12-23 00:45:25.954] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:45:25.959] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:45:25.961] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:25.962] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:45:25.965] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:45:25.969] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:45:25.974] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:45:25.975] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.7822ms
[2025-12-23 00:45:25.977] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:45:25.979] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 24.9875ms
[2025-12-23 00:48:42.894] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:48:43.115] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:48:43.135] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:48:43.228] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:48:43.229] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:48:43.297] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:48:43.298] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:48:43.299] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:48:43.426] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:48:43.540] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 113.6916ms
[2025-12-23 00:48:43.561] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:48:43.561] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:48:43.569] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 8.7797ms
[2025-12-23 00:48:43.585] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 24.2705ms
[2025-12-23 00:48:43.728] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:48:43.766] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 37.9446ms
[2025-12-23 00:48:45.921] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:48:45.921] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:48:45.921] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:48:45.932] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:45.932] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:45.932] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:45.936] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 14.8672ms
[2025-12-23 00:48:45.936] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 14.9482ms
[2025-12-23 00:48:45.936] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 14.8658ms
[2025-12-23 00:48:45.939] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:48:45.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:48:45.941] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:48:45.956] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:45.956] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:45.959] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:46.048] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:48:46.048] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:48:46.050] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:48:46.079] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:48:46.079] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:48:46.079] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:48:47.835] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:47.835] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (107ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:47.835] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:47.977] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (40ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:48:47.977] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:48:47.977] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (40ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:48:48.070] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:48:48.070] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:48:48.078] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:48:48.078] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:48:48.080] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:48:48.084] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:48:48.093] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 2006.7174ms
[2025-12-23 00:48:48.093] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 2009.0014ms
[2025-12-23 00:48:48.093] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 2007.6879ms
[2025-12-23 00:48:48.095] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:48:48.095] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:48:48.096] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:48:48.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 2164.3208ms
[2025-12-23 00:48:48.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 2163.1925ms
[2025-12-23 00:48:48.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 2162.7499ms
[2025-12-23 00:48:48.528] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:48:48.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:48:48.532] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.536] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 7.8176ms
[2025-12-23 00:48:48.536] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.539] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:48:48.544] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 13.5546ms
[2025-12-23 00:48:48.546] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:48:48.547] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.554] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.562] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.562] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.567] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:48.568] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:48.679] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.686] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:48.694] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.698] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:48.709] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.717] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.718] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.725] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.764] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:48:48.765] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:48:48.768] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104190.00, Заказов: 24
[2025-12-23 00:48:48.770] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:48:48.772] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:48:48.772] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:48:48.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 212.8678ms
[2025-12-23 00:48:48.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 211.2979ms
[2025-12-23 00:48:48.784] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.785] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.786] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 240.0056ms
[2025-12-23 00:48:48.787] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 247.9125ms
[2025-12-23 00:48:48.792] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:48.792] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:48.798] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.801] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.802] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 10.3849ms
[2025-12-23 00:48:48.803] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 10.5818ms
[2025-12-23 00:48:48.805] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:48.805] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:48.814] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.817] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.819] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:48.819] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.824] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:48.828] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:48.833] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:48.840] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:48.841] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:48:48.846] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.852] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:48.860] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:48:48.863] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 65630.00, Заказов: 21
[2025-12-23 00:48:48.865] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:48:48.866] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 39.7108ms
[2025-12-23 00:48:48.868] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.869] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 63.9776ms
[2025-12-23 00:48:48.913] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:48:48.957] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:48:48.959] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 129.0162ms
[2025-12-23 00:48:48.961] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:48.963] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 158.4145ms
[2025-12-23 00:48:48.968] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:48:48.968] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:48:48.970] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.974] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.975] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 7.2632ms
[2025-12-23 00:48:48.976] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:48.977] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:48:48.981] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:48.985] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:48.990] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:48.991] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:48.994] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:48:48.995] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:48.999] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:48:49.003] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:49.008] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:48:49.014] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 21.0111ms
[2025-12-23 00:48:49.016] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:49.016] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:49.020] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 42.6685ms
[2025-12-23 00:48:49.023] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:49.032] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:48:49.036] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:48:49.037] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:48:49.040] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 52.1862ms
[2025-12-23 00:48:49.042] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:49.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 75.1249ms
[2025-12-23 00:48:49.047] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:48:49.047] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:48:49.052] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.055] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 9.2025ms
[2025-12-23 00:48:49.058] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 10.6982ms
[2025-12-23 00:48:49.061] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:48:49.061] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:48:49.068] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.072] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.074] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:49.074] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:49.076] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:49.077] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:49.086] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:49.086] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:49.094] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:49.094] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:48:49.100] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:49.100] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:49.107] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:49.108] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:48:49.115] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:48:49.118] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:48:49.119] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 19510.00, Заказов: 8
[2025-12-23 00:48:49.121] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:48:49.123] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:48:49.124] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:48:49.126] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 43.6364ms
[2025-12-23 00:48:49.127] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 47.5833ms
[2025-12-23 00:48:49.129] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:49.130] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:48:49.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 69.7664ms
[2025-12-23 00:48:49.133] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 71.4972ms
[2025-12-23 00:48:49.136] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:48:49.144] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.145] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 8.2842ms
[2025-12-23 00:48:49.147] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:48:49.153] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.154] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:48:49.162] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:49.222] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (19ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:48:49.226] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:48:49.228] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:48:49.234] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 69.6844ms
[2025-12-23 00:48:49.236] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:48:49.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 91.1003ms
[2025-12-23 00:48:49.243] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:48:49.247] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.248] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 5.2125ms
[2025-12-23 00:48:49.251] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:48:49.257] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.259] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:48:49.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:49.309] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:48:49.313] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:48:49.319] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 49.4113ms
[2025-12-23 00:48:49.321] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:48:49.324] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 71.8978ms
[2025-12-23 00:48:49.328] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:49.332] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.333] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 5.3552ms
[2025-12-23 00:48:49.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:49.352] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.355] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:49.357] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:49.362] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:48:49.367] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:48:49.376] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:48:49.378] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.8587ms
[2025-12-23 00:48:49.380] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:49.381] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 46.154ms
[2025-12-23 00:48:49.386] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:49.390] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.391] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 5.2047ms
[2025-12-23 00:48:49.394] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:48:49.400] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:48:49.402] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:49.403] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:48:49.406] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:48:49.412] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:48:49.420] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:48:49.423] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 18.485ms
[2025-12-23 00:48:49.424] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:48:49.426] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 31.9439ms
[2025-12-23 00:49:05.911] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:49:05.914] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:05.916] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 5.4803ms
[2025-12-23 00:49:05.918] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:49:05.924] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:05.926] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:49:05.933] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:49:05.950] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:05.978] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:49:06.033] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:49:06.035] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.039] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 103.0457ms
[2025-12-23 00:49:06.040] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:49:06.041] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 123.0564ms
[2025-12-23 00:49:06.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:49:06.045] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.046] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 2.9358ms
[2025-12-23 00:49:06.048] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:49:06.051] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.052] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:49:06.053] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:49:06.059] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:06.064] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:49:06.067] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:49:06.069] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.070] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 15.561ms
[2025-12-23 00:49:06.072] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:49:06.073] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 25.2083ms
[2025-12-23 00:49:06.076] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:49:06.078] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.079] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 2.7796ms
[2025-12-23 00:49:06.081] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:49:06.083] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.084] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:49:06.090] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:49:06.101] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:06.119] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:49:06.154] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 24, Страница: 1
[2025-12-23 00:49:06.158] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.166] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 74.3605ms
[2025-12-23 00:49:06.167] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:49:06.168] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 86.8141ms
[2025-12-23 00:49:06.700] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 00:49:06.709] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 00:49:06.716] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:49:06.724] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.728] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.730] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.731] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - 204 null null 30.9431ms
[2025-12-23 00:49:06.731] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - 204 null null 22.75ms
[2025-12-23 00:49:06.733] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:49:06.734] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 00:49:06.734] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 00:49:06.742] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:49:06.745] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.748] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.750] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 00:49:06.751] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:49:06.752] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:49:06.754] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:06.757] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 00:49:06.760] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:06.764] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:49:06.766] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:49:06.767] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:49:06.769] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:49:06.770] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.770] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:06.772] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.773] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 23.7533ms
[2025-12-23 00:49:06.776] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 21.5824ms
[2025-12-23 00:49:06.777] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:49:06.777] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:49:06.779] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 62.4537ms
[2025-12-23 00:49:06.779] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - 200 null application/json; charset=utf-8 45.3344ms
[2025-12-23 00:49:06.785] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:49:06.804] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 00:49:06.807] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.811] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 50.7875ms
[2025-12-23 00:49:06.812] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 00:49:06.813] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - 200 null application/json; charset=utf-8 78.9262ms
[2025-12-23 00:49:06.816] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 00:49:06.819] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.819] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 204 null null 2.9243ms
[2025-12-23 00:49:06.822] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 00:49:06.826] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:06.827] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 00:49:06.831] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 00:49:06.849] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 00:49:06.867] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 00:49:06.869] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 00:49:06.871] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:06.875] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 41.705ms
[2025-12-23 00:49:06.876] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 00:49:06.877] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 54.8661ms
[2025-12-23 00:49:07.441] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - null null
[2025-12-23 00:49:07.443] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:07.444] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - 204 null null 3.5064ms
[2025-12-23 00:49:07.446] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Cart/items - application/json 75
[2025-12-23 00:49:07.449] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:07.451] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 00:49:07.455] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "AddItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] AddItem(RestaurantAPI.DTOs.CartItemAddDto) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:49:07.530] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 00:49:07.559] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__8__locals1_dto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__8__locals1_dto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:07.741] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p7='?' (DbType = Guid), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CartItems] ([CartId], [CreatedAt], [DishId], [Notes], [Quantity], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Carts] SET [UpdatedAt] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-23 00:49:07.771] [INF] [RestaurantAPI.Controllers.CartController] Товар "506c83ad-20ac-42f9-a32e-16f2701bad37" добавлен в корзину пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 00:49:07.802] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:49:07.814] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:49:07.819] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi) in 361.7903ms
[2025-12-23 00:49:07.821] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 00:49:07.822] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Cart/items - 200 null application/json; charset=utf-8 375.1291ms
[2025-12-23 00:49:10.133] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders - null null
[2025-12-23 00:49:10.135] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:10.136] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders - 204 null null 2.9103ms
[2025-12-23 00:49:10.138] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Orders - application/json 148
[2025-12-23 00:49:10.141] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:10.142] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi)'
[2025-12-23 00:49:10.146] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.OrderReadDto]] CreateOrder(RestaurantAPI.DTOs.OrderCreateDto) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:49:10.197] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__item_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__item_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:10.208] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__createDto_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__createDto_UserId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:10.211] [INF] [RestaurantAPI.Controllers.OrdersController] Создание заказа. UserId: "601d547d-42ee-4d95-abc0-42bf30f4d94b", Notes: null, ItemsCount: 1
[2025-12-23 00:49:10.212] [INF] [RestaurantAPI.Controllers.OrdersController] Создание заказа. Входящая дата: null, Kind: null, Результирующая дата: "2025-12-22T21:49:10.2125362Z", Year: 2025
[2025-12-23 00:49:10.244] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 100), @p2='?' (DbType = DateTime), @p3='?' (Size = 100), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (Size = 50), @p7='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = DateTime), @p9='?' (Size = 100), @p10='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [IsDeleted], [Notes], [Status], [Total], [UpdatedAt], [UpdatedBy], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
[2025-12-23 00:49:10.254] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__itemDto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__itemDto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:10.256] [INF] [RestaurantAPI.Controllers.OrdersController] Добавление элемента заказа. DishId: "506c83ad-20ac-42f9-a32e-16f2701bad37", Quantity: 1, Notes: null
[2025-12-23 00:49:10.291] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 100), @p2='?' (DbType = DateTime), @p3='?' (Size = 100), @p4='?' (DbType = Guid), @p5='?' (DbType = Boolean), @p6='?' (Size = 4000), @p7='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (Size = 100), @p13='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [DishId], [IsDeleted], [Notes], [OrderId], [Price], [Quantity], [UpdatedAt], [UpdatedBy])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
UPDATE [Orders] SET [Total] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-23 00:49:10.295] [INF] [RestaurantAPI.Controllers.OrdersController] Заказ "8f75ec3c-74b1-439e-a0fc-0dbd364e2cc7" создан пользователем "601d547d-42ee-4d95-abc0-42bf30f4d94b". Сумма: 750.00, Блюд: 1
[2025-12-23 00:49:10.299] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing CreatedAtActionResult, writing value of type 'RestaurantAPI.DTOs.OrderReadDto'.
[2025-12-23 00:49:10.311] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi) in 163.3854ms
[2025-12-23 00:49:10.313] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi)'
[2025-12-23 00:49:10.313] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Orders - 201 null application/json; charset=utf-8 175.6717ms
[2025-12-23 00:49:10.316] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:49:10.318] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:10.319] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 2.3389ms
[2025-12-23 00:49:10.320] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 DELETE https://localhost:7188/api/Cart - null null
[2025-12-23 00:49:10.323] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:10.324] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi)'
[2025-12-23 00:49:10.328] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] ClearCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:49:10.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 00:49:10.345] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Guid), @p2='?' (DbType = Guid), @p1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
UPDATE [Carts] SET [UpdatedAt] = @p1
OUTPUT 1
WHERE [Id] = @p2;
[2025-12-23 00:49:10.350] [INF] [RestaurantAPI.Controllers.CartController] Корзина пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b" очищена
[2025-12-23 00:49:10.352] [INF] [Microsoft.AspNetCore.Mvc.StatusCodeResult] Executing StatusCodeResult, setting HTTP status code 204
[2025-12-23 00:49:10.353] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi) in 22.9882ms
[2025-12-23 00:49:10.354] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi)'
[2025-12-23 00:49:10.356] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 DELETE https://localhost:7188/api/Cart - 204 null null 35.4004ms
[2025-12-23 00:49:13.199] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - null null
[2025-12-23 00:49:13.203] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:13.204] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - 204 null null 4.7221ms
[2025-12-23 00:49:13.207] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - null null
[2025-12-23 00:49:13.214] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:13.215] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi)'
[2025-12-23 00:49:13.218] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMyOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.OrderReadDto]]] GetMyOrders(Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:49:13.228] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_Value_0 AND [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:13.241] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[UserId] = @__userId_Value_0 AND [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:49:13.243] [INF] [RestaurantAPI.Controllers.OrdersController] Получены заказы пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b". Количество: 3, Всего: 3, Страница: 1
[2025-12-23 00:49:13.245] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:13.246] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi) in 25.4819ms
[2025-12-23 00:49:13.247] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi)'
[2025-12-23 00:49:13.248] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - 200 null application/json; charset=utf-8 40.3287ms
[2025-12-23 00:49:17.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:49:17.059] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:49:17.060] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.062] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.063] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 5.9344ms
[2025-12-23 00:49:17.064] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 4.9311ms
[2025-12-23 00:49:17.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:49:17.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:49:17.073] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.076] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.077] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.077] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.078] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.079] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.084] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.084] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.088] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.090] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.093] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.093] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.096] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.097] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.101] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:49:17.102] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:49:17.104] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:49:17.106] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:49:17.107] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:49:17.108] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:49:17.109] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.7641ms
[2025-12-23 00:49:17.110] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.9204ms
[2025-12-23 00:49:17.123] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.123] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.124] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 56.1718ms
[2025-12-23 00:49:17.125] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 57.1754ms
[2025-12-23 00:49:17.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.133] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.135] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.136] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 6.9875ms
[2025-12-23 00:49:17.137] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 7.6235ms
[2025-12-23 00:49:17.138] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.139] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.145] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.147] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.148] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.148] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.149] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.150] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.152] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:49:17.154] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.158] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:49:17.158] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.163] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:49:17.165] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.166] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.8996ms
[2025-12-23 00:49:17.168] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.168] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.171] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 32.236ms
[2025-12-23 00:49:17.171] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:49:17.176] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:49:17.177] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:49:17.178] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.8267ms
[2025-12-23 00:49:17.179] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.180] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 40.8832ms
[2025-12-23 00:49:17.183] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:49:17.183] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:49:17.185] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.187] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.187] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 4.8203ms
[2025-12-23 00:49:17.190] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:49:17.190] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.194] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.195] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.196] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.198] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.198] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.200] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:49:17.201] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.203] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:49:17.204] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.209] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:49:17.211] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.212] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.6932ms
[2025-12-23 00:49:17.214] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:49:17.214] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.216] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:49:17.217] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 27.1488ms
[2025-12-23 00:49:17.218] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:49:17.222] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.8256ms
[2025-12-23 00:49:17.223] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 41.1146ms
[2025-12-23 00:49:17.227] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:49:17.227] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:49:17.229] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.230] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.231] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 4.4034ms
[2025-12-23 00:49:17.232] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.0017ms
[2025-12-23 00:49:17.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:49:17.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:49:17.239] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.241] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.242] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.242] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.244] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.248] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.248] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.250] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.252] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:49:17.253] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.256] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.258] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.259] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:17.261] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:49:17.262] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:49:17.264] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:49:17.265] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:49:17.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:49:17.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:49:17.269] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.7121ms
[2025-12-23 00:49:17.270] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.6519ms
[2025-12-23 00:49:17.271] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.272] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:49:17.273] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 39.8283ms
[2025-12-23 00:49:17.274] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 40.4222ms
[2025-12-23 00:49:17.276] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:49:17.281] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.282] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.3494ms
[2025-12-23 00:49:17.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:49:17.286] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.287] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:49:17.288] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.302] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:49:17.304] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:49:17.305] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:17.306] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 16.1641ms
[2025-12-23 00:49:17.308] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:49:17.308] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 24.9022ms
[2025-12-23 00:49:17.311] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:49:17.313] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.314] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.5642ms
[2025-12-23 00:49:17.315] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:49:17.318] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.319] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:49:17.320] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.328] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:49:17.330] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:17.332] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 10.566ms
[2025-12-23 00:49:17.333] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:49:17.334] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 18.2425ms
[2025-12-23 00:49:17.336] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.338] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.339] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.8746ms
[2025-12-23 00:49:17.341] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.344] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.345] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.346] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.348] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:49:17.351] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:49:17.357] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:49:17.358] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.2453ms
[2025-12-23 00:49:17.359] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.360] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 18.3533ms
[2025-12-23 00:49:17.363] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.364] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.365] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.4994ms
[2025-12-23 00:49:17.366] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:49:17.369] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:17.370] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.371] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:49:17.373] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:49:17.376] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:49:17.380] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:49:17.381] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.2247ms
[2025-12-23 00:49:17.382] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:49:17.383] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 16.9211ms
[2025-12-23 00:49:20.858] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:49:20.861] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:20.861] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 3.4399ms
[2025-12-23 00:49:20.864] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:49:20.867] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:20.868] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:49:20.869] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:49:20.875] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:20.881] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:49:20.883] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:49:20.884] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:20.885] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 13.3467ms
[2025-12-23 00:49:20.887] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:49:20.887] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 22.8521ms
[2025-12-23 00:49:20.892] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:49:20.894] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:20.895] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 2.5502ms
[2025-12-23 00:49:20.896] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:49:20.899] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:20.900] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:49:20.901] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:49:20.904] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:20.910] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:49:20.912] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:49:20.914] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:20.915] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 12.2466ms
[2025-12-23 00:49:20.916] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:49:20.917] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 20.8928ms
[2025-12-23 00:49:20.920] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:49:20.922] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:20.923] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 3.2815ms
[2025-12-23 00:49:20.925] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:49:20.928] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:20.929] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:49:20.930] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:49:20.932] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:20.937] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:49:20.941] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 25, Страница: 1
[2025-12-23 00:49:20.942] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:20.944] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 12.9633ms
[2025-12-23 00:49:20.945] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:49:20.946] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 20.9983ms
[2025-12-23 00:49:22.398] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/OrderItems/ByOrder/9984f855-ba5b-44bd-9ffc-22bc99f3be9b - null null
[2025-12-23 00:49:22.400] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:22.401] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/OrderItems/ByOrder/9984f855-ba5b-44bd-9ffc-22bc99f3be9b - 204 null null 2.4571ms
[2025-12-23 00:49:22.402] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/OrderItems/ByOrder/9984f855-ba5b-44bd-9ffc-22bc99f3be9b - null null
[2025-12-23 00:49:22.406] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:49:22.407] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrderItemsController.GetOrderItemsByOrder (RestaurantApi)'
[2025-12-23 00:49:22.410] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrderItemsByOrder", controller = "OrderItems"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrderItemsByOrder(System.Guid) on controller RestaurantAPI.Controllers.OrderItemsController (RestaurantApi).
[2025-12-23 00:49:22.448] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (29ms) [Parameters=[@__orderId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
FROM [Orders] AS [o]
WHERE [o].[Id] = @__orderId_0 AND [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:49:22.459] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__orderId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Id], [o].[DishId], [d].[Name] AS [DishName], [o].[Quantity], [o].[Price], [o].[Notes]
FROM [OrderItems] AS [o]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[OrderId] = @__orderId_0
[2025-12-23 00:49:22.461] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[RestaurantAPI.DTOs.OrderItemReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:49:22.463] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrderItemsController.GetOrderItemsByOrder (RestaurantApi) in 51.7421ms
[2025-12-23 00:49:22.465] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrderItemsController.GetOrderItemsByOrder (RestaurantApi)'
[2025-12-23 00:49:22.466] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/OrderItems/ByOrder/9984f855-ba5b-44bd-9ffc-22bc99f3be9b - 200 null application/json; charset=utf-8 63.4492ms
[2025-12-23 00:50:39.995] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:50:39.996] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:39.998] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.003] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.8553ms
[2025-12-23 00:50:40.005] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 9.6333ms
[2025-12-23 00:50:40.009] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:50:40.011] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:40.016] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.019] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.020] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.021] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.021] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.023] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.029] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.029] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.032] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.034] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.036] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.037] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.042] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.042] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.046] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:50:40.048] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:50:40.048] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:40.049] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:40.050] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:50:40.051] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.8725ms
[2025-12-23 00:50:40.052] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:40.054] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.057] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.4482ms
[2025-12-23 00:50:40.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 48.2179ms
[2025-12-23 00:50:40.058] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.062] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 50.8993ms
[2025-12-23 00:50:40.066] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.066] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.068] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.072] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.073] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 7.5089ms
[2025-12-23 00:50:40.074] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 8.3583ms
[2025-12-23 00:50:40.076] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.076] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.083] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.086] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.087] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.088] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.089] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.090] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.093] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:50:40.095] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.097] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:40.097] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.102] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:40.105] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.3872ms
[2025-12-23 00:50:40.105] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.108] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.110] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.110] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 34.1621ms
[2025-12-23 00:50:40.113] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:40.116] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:50:40.117] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:40.118] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.4821ms
[2025-12-23 00:50:40.122] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.123] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 47.0964ms
[2025-12-23 00:50:40.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:40.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:40.129] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.130] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 4.002ms
[2025-12-23 00:50:40.132] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.133] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:40.135] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.138] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.141] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.142] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.142] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.144] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.145] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:50:40.147] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.149] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:40.149] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.154] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:40.157] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.598ms
[2025-12-23 00:50:40.157] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:40.158] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.160] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:50:40.161] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 28.2581ms
[2025-12-23 00:50:40.162] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:40.165] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.3747ms
[2025-12-23 00:50:40.166] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.167] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 40.0269ms
[2025-12-23 00:50:40.174] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:50:40.174] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:50:40.176] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.179] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.180] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 5.7357ms
[2025-12-23 00:50:40.181] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 6.3694ms
[2025-12-23 00:50:40.182] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:50:40.183] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:50:40.188] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.191] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.192] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.193] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.193] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.194] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.197] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.198] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.199] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.201] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:40.202] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.205] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.207] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.209] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:40.210] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:40.212] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:40.213] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:50:40.214] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:50:40.215] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:40.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:40.217] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.68ms
[2025-12-23 00:50:40.218] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.3409ms
[2025-12-23 00:50:40.220] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.221] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:40.222] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 40.2661ms
[2025-12-23 00:50:40.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 41.1733ms
[2025-12-23 00:50:40.227] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:50:40.231] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.231] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 3.8075ms
[2025-12-23 00:50:40.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:50:40.236] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.237] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:50:40.238] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.251] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:50:40.253] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:50:40.254] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:50:40.257] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 17.3086ms
[2025-12-23 00:50:40.259] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:50:40.259] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 26.6379ms
[2025-12-23 00:50:40.262] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:50:40.264] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.264] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.4478ms
[2025-12-23 00:50:40.266] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:50:40.268] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.269] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:50:40.270] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.282] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:50:40.284] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:50:40.285] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 11.6286ms
[2025-12-23 00:50:40.289] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:50:40.290] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 24.4335ms
[2025-12-23 00:50:40.294] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.296] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.297] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 3.075ms
[2025-12-23 00:50:40.298] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.302] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.303] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.304] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.307] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:50:40.311] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:40.317] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:40.318] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.3627ms
[2025-12-23 00:50:40.320] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.320] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 22.0969ms
[2025-12-23 00:50:40.325] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.327] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.328] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.7791ms
[2025-12-23 00:50:40.330] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:40.333] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:40.334] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.335] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:40.338] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:50:40.341] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:40.346] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:40.348] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.7285ms
[2025-12-23 00:50:40.349] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:40.350] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 19.3301ms
[2025-12-23 00:50:50.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:50:50.045] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.046] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 2.362ms
[2025-12-23 00:50:50.050] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:50:50.058] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.059] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:50:50.067] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:50:50.078] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:50:50.080] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:50:50.081] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 12.8666ms
[2025-12-23 00:50:50.082] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:50:50.083] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 32.8144ms
[2025-12-23 00:50:50.107] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:50:50.108] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:50.109] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.111] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.112] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 5.0961ms
[2025-12-23 00:50:50.113] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.0016ms
[2025-12-23 00:50:50.116] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:50:50.117] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:50.123] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.126] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.127] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.128] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.128] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.129] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.134] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.135] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.141] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.143] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.144] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.145] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.148] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.148] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.151] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:50:50.156] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:50:50.156] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:50.157] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:50.159] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:50:50.160] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.2802ms
[2025-12-23 00:50:50.161] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:50.162] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.163] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 30.6741ms
[2025-12-23 00:50:50.164] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 48.0868ms
[2025-12-23 00:50:50.165] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.168] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 51.1876ms
[2025-12-23 00:50:50.177] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.177] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.179] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.181] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.182] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.7803ms
[2025-12-23 00:50:50.182] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.3584ms
[2025-12-23 00:50:50.184] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.184] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.193] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.195] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.196] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.196] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.197] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.198] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.200] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:50:50.209] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.210] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:50.214] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:50.220] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.4936ms
[2025-12-23 00:50:50.222] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.223] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 40.0521ms
[2025-12-23 00:50:50.229] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.235] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:50.240] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:50:50.241] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:50.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 41.5687ms
[2025-12-23 00:50:50.244] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 60.6488ms
[2025-12-23 00:50:50.248] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:50.249] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:50.253] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.250] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.255] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.255] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 6.8033ms
[2025-12-23 00:50:50.257] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.259] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:50:50.263] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.264] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.266] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.266] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.268] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:50:50.274] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.275] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:50.279] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:50.284] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.3989ms
[2025-12-23 00:50:50.285] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.285] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.291] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 31.9618ms
[2025-12-23 00:50:50.294] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:50.296] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:50:50.297] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:50.299] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 37.8543ms
[2025-12-23 00:50:50.300] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.301] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 52.3416ms
[2025-12-23 00:50:50.309] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:50:50.309] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:50:50.312] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.314] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.314] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 5.2902ms
[2025-12-23 00:50:50.315] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 6.0351ms
[2025-12-23 00:50:50.317] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:50:50.317] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:50:50.326] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.328] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.329] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.329] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.330] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.331] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.339] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.339] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.345] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.345] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:50:50.349] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.350] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.355] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.355] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:50:50.361] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:50.363] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:50:50.363] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:50:50.364] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:50:50.366] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:50.367] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:50:50.368] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 35.8655ms
[2025-12-23 00:50:50.371] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 37.7962ms
[2025-12-23 00:50:50.372] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.375] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:50:50.376] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 58.3785ms
[2025-12-23 00:50:50.376] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 59.1072ms
[2025-12-23 00:50:50.381] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:50:50.384] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.384] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 3.0405ms
[2025-12-23 00:50:50.391] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:50:50.393] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.394] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:50:50.395] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.415] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:50:50.431] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:50:50.432] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:50:50.434] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 36.9455ms
[2025-12-23 00:50:50.439] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:50:50.443] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 51.7601ms
[2025-12-23 00:50:50.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:50:50.451] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.451] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.4223ms
[2025-12-23 00:50:50.455] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:50:50.460] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.461] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:50:50.462] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.476] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:50:50.479] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:50:50.480] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 16.915ms
[2025-12-23 00:50:50.481] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:50:50.482] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 26.9472ms
[2025-12-23 00:50:50.487] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.491] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.492] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 4.4804ms
[2025-12-23 00:50:50.494] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.497] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.498] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.499] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.501] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:50:50.505] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:50.511] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:50.513] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 12.5738ms
[2025-12-23 00:50:50.514] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.516] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 21.3342ms
[2025-12-23 00:50:50.524] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.527] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.528] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.5053ms
[2025-12-23 00:50:50.529] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:50:50.532] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:50:50.533] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.534] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:50:50.540] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:50:50.543] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:50:50.549] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:50:50.550] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.986ms
[2025-12-23 00:50:50.551] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:50:50.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 24.7149ms
[2025-12-23 00:51:23.146] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:51:23.146] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:51:23.146] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:51:23.149] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:23.151] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:23.159] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:23.160] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 13.8878ms
[2025-12-23 00:51:23.160] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 14.3981ms
[2025-12-23 00:51:23.161] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 15.2288ms
[2025-12-23 00:51:23.163] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:51:23.164] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:51:23.165] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:51:23.178] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:23.181] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:23.203] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:23.209] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:51:23.209] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:51:23.210] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:51:23.211] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:51:23.211] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:51:23.212] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:51:23.217] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:23.217] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:23.222] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:23.225] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:23.226] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:51:23.227] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:51:23.227] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:23.229] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:51:23.230] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:23.231] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:51:23.232] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:23.234] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 18.7469ms
[2025-12-23 00:51:23.234] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:23.238] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 24.5873ms
[2025-12-23 00:51:23.239] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:51:23.241] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 24.0034ms
[2025-12-23 00:51:23.241] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:51:23.242] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 77.9126ms
[2025-12-23 00:51:23.243] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:51:23.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 81.1427ms
[2025-12-23 00:51:23.247] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 82.783ms
[2025-12-23 00:51:25.166] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:51:25.178] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:25.179] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 12.5203ms
[2025-12-23 00:51:25.183] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:51:25.189] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:25.190] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:51:25.191] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:51:25.201] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:51:25.208] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:51:25.210] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 17.3116ms
[2025-12-23 00:51:25.211] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:51:25.212] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:51:25.213] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:51:25.214] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:51:25.216] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:25.221] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:25.224] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:25.225] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 41.9056ms
[2025-12-23 00:51:25.226] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:51:25.226] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:51:25.227] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:51:25.230] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:51:25.231] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:51:25.231] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:51:25.244] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:25.250] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:25.250] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:25.251] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:51:25.259] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:25.260] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:51:25.261] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:25.261] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:51:25.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:25.264] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:51:25.265] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:25.266] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 33.1246ms
[2025-12-23 00:51:25.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:25.268] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 33.7157ms
[2025-12-23 00:51:25.270] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:51:25.272] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 29.4783ms
[2025-12-23 00:51:25.273] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:51:25.274] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 63.7224ms
[2025-12-23 00:51:25.275] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:51:25.276] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 64.1533ms
[2025-12-23 00:51:25.280] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 66.6767ms
[2025-12-23 00:51:27.931] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 00:51:27.938] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:27.939] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=1000 - 204 null null 7.2573ms
[2025-12-23 00:51:27.942] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 00:51:27.947] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:27.948] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 00:51:27.950] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 00:51:27.960] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:27.966] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:27.971] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 00:51:27.974] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:27.975] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 20.9796ms
[2025-12-23 00:51:27.976] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 00:51:27.977] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - 200 null application/json; charset=utf-8 35.9953ms
[2025-12-23 00:51:29.138] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:51:29.143] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:29.144] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 5.5332ms
[2025-12-23 00:51:29.146] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:51:29.155] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:29.157] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:51:29.158] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:51:29.163] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:29.169] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:29.174] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:51:29.176] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:29.177] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 17.2168ms
[2025-12-23 00:51:29.179] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:51:29.180] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 34.7159ms
[2025-12-23 00:51:29.584] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=1000 - null null
[2025-12-23 00:51:29.592] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:29.593] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=1000 - 204 null null 9.5314ms
[2025-12-23 00:51:29.595] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=1000 - null null
[2025-12-23 00:51:29.604] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:29.606] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:51:29.608] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:51:29.613] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:29.619] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:29.624] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:51:29.625] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:29.626] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 15.6205ms
[2025-12-23 00:51:29.627] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:51:29.628] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=1000 - 200 null application/json; charset=utf-8 32.6879ms
[2025-12-23 00:51:31.946] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:51:31.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Roles - null null
[2025-12-23 00:51:31.951] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:31.961] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:31.962] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Roles - 204 null null 13.82ms
[2025-12-23 00:51:31.961] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 15.4057ms
[2025-12-23 00:51:31.965] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:51:31.965] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Roles - null null
[2025-12-23 00:51:31.979] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:31.981] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:31.981] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:51:31.982] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 00:51:31.983] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:51:31.994] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRoles", controller = "Roles"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.RoleReadDto]]] GetRoles(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.RolesController (RestaurantApi).
[2025-12-23 00:51:31.997] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:32.008] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:51:32.011] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:51:32.012] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:32.014] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 23.6195ms
[2025-12-23 00:51:32.015] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:51:32.016] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 50.622ms
[2025-12-23 00:51:32.022] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:32.045] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
ORDER BY [r].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:51:32.050] [INF] [RestaurantAPI.Controllers.RolesController] Получен список ролей. Количество: 3, Всего: 3, Страница: 1
[2025-12-23 00:51:32.058] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.RoleReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:32.062] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi) in 65.6934ms
[2025-12-23 00:51:32.063] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 00:51:32.064] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Roles - 200 null application/json; charset=utf-8 98.9878ms
[2025-12-23 00:51:32.609] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:51:32.612] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:32.614] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:51:32.616] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:51:32.624] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:32.631] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:51:32.634] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:51:32.640] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:32.641] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 24.0742ms
[2025-12-23 00:51:32.643] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:51:32.644] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 34.6045ms
[2025-12-23 00:51:32.647] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:51:32.649] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:32.650] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 2.9542ms
[2025-12-23 00:51:32.657] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:51:32.659] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:32.660] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:51:32.661] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:51:32.665] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:32.676] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:51:32.678] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:51:32.680] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:32.681] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 18.8842ms
[2025-12-23 00:51:32.683] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:51:32.684] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 27.4799ms
[2025-12-23 00:51:32.694] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:51:32.699] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:32.700] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 5.7336ms
[2025-12-23 00:51:32.708] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:51:32.711] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:32.712] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:51:32.713] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:51:32.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:32.728] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:51:32.731] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 25, Страница: 1
[2025-12-23 00:51:32.732] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:32.733] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 18.2094ms
[2025-12-23 00:51:32.738] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:51:32.739] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 31.6026ms
[2025-12-23 00:51:33.707] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - null null
[2025-12-23 00:51:33.709] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:33.710] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - 204 null null 3.5655ms
[2025-12-23 00:51:33.713] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - null null
[2025-12-23 00:51:33.715] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:33.716] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi)'
[2025-12-23 00:51:33.718] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMyOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.OrderReadDto]]] GetMyOrders(Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:51:33.729] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_Value_0 AND [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:33.739] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[UserId] = @__userId_Value_0 AND [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:51:33.741] [INF] [RestaurantAPI.Controllers.OrdersController] Получены заказы пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b". Количество: 3, Всего: 3, Страница: 1
[2025-12-23 00:51:33.742] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:33.743] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi) in 19.5129ms
[2025-12-23 00:51:33.745] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi)'
[2025-12-23 00:51:33.746] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - 200 null application/json; charset=utf-8 33.252ms
[2025-12-23 00:51:35.441] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:51:35.442] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:35.444] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.447] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.7594ms
[2025-12-23 00:51:35.449] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 6.7166ms
[2025-12-23 00:51:35.451] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:51:35.451] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:35.478] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.481] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.484] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.485] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.489] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.490] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.495] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.495] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.498] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.500] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.503] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.504] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.508] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.508] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.512] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:51:35.514] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:35.514] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:51:35.516] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:51:35.517] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:35.518] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:35.521] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.5072ms
[2025-12-23 00:51:35.522] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.1864ms
[2025-12-23 00:51:35.523] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.525] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 74.8152ms
[2025-12-23 00:51:35.527] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 75.5742ms
[2025-12-23 00:51:35.531] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.532] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.533] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.538] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.542] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 10.9077ms
[2025-12-23 00:51:35.543] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 11.5208ms
[2025-12-23 00:51:35.546] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.546] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.554] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.556] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.558] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.558] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.559] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.560] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.562] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.563] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:51:35.565] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.568] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:35.572] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.577] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:35.579] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.579] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.8917ms
[2025-12-23 00:51:35.581] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:35.582] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.583] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:51:35.584] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 37.593ms
[2025-12-23 00:51:35.589] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:35.593] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 32.8095ms
[2025-12-23 00:51:35.595] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.595] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 49.3042ms
[2025-12-23 00:51:35.599] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:35.599] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:35.601] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.606] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.607] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 7.9595ms
[2025-12-23 00:51:35.608] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.609] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:35.611] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.612] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.614] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.615] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.615] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.617] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.623] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:51:35.624] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.626] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:35.627] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.630] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:35.633] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:35.633] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.49ms
[2025-12-23 00:51:35.639] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:51:35.640] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.641] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:35.642] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 33.2059ms
[2025-12-23 00:51:35.643] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.6145ms
[2025-12-23 00:51:35.647] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.648] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 48.7326ms
[2025-12-23 00:51:35.656] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:51:35.656] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:51:35.658] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.659] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.660] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 4.4446ms
[2025-12-23 00:51:35.661] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.1324ms
[2025-12-23 00:51:35.663] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:51:35.663] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:51:35.672] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.674] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.675] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.675] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.677] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.679] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.681] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.682] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.684] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:35.689] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.691] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.692] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.694] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:35.696] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:35.698] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:35.698] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:51:35.700] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:51:35.701] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:35.702] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:35.720] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 41.5345ms
[2025-12-23 00:51:35.725] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 45.0167ms
[2025-12-23 00:51:35.726] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.727] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:35.728] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 65.225ms
[2025-12-23 00:51:35.729] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 65.8017ms
[2025-12-23 00:51:35.733] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:51:35.737] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.739] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 5.3818ms
[2025-12-23 00:51:35.741] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:51:35.743] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.744] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:51:35.745] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.761] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:51:35.763] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:51:35.764] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:35.765] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 18.1751ms
[2025-12-23 00:51:35.766] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:51:35.767] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 25.7985ms
[2025-12-23 00:51:35.773] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:51:35.776] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.777] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.3153ms
[2025-12-23 00:51:35.779] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:51:35.781] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.782] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:51:35.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.794] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:51:35.796] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:35.797] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 13.0681ms
[2025-12-23 00:51:35.798] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:51:35.799] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 19.7033ms
[2025-12-23 00:51:35.804] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.807] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.808] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 4.125ms
[2025-12-23 00:51:35.810] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.813] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.814] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.815] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.817] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:51:35.821] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:35.827] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:35.828] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.3147ms
[2025-12-23 00:51:35.829] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.830] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 19.788ms
[2025-12-23 00:51:35.836] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.841] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.842] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 5.6275ms
[2025-12-23 00:51:35.844] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:35.847] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:35.848] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.849] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:35.851] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:51:35.859] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:35.865] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:35.866] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.4109ms
[2025-12-23 00:51:35.867] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:35.871] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 26.8246ms
[2025-12-23 00:51:38.214] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:51:38.218] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.222] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 7.6113ms
[2025-12-23 00:51:38.227] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:51:38.229] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.230] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:51:38.230] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:51:38.245] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:51:38.247] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:51:38.248] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 16.2482ms
[2025-12-23 00:51:38.249] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:51:38.250] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 23.2932ms
[2025-12-23 00:51:38.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:51:38.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:38.276] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.278] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.279] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.280] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.282] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.291] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.293] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.296] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.298] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.299] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.300] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.308] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.309] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.313] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:51:38.314] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:38.315] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:51:38.317] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:51:38.318] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:38.320] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:38.321] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 37.2068ms
[2025-12-23 00:51:38.323] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 32.9765ms
[2025-12-23 00:51:38.324] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.325] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 53.6405ms
[2025-12-23 00:51:38.327] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 54.4767ms
[2025-12-23 00:51:38.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:38.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:38.334] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.340] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.341] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.341] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.342] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.343] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.346] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:51:38.349] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:38.350] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.359] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:38.361] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.1232ms
[2025-12-23 00:51:38.362] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.363] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.363] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 31.3381ms
[2025-12-23 00:51:38.372] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.378] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.383] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:38.390] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:51:38.391] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:38.393] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 46.2702ms
[2025-12-23 00:51:38.394] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.395] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 63.2604ms
[2025-12-23 00:51:38.399] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:38.399] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:51:38.401] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.408] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.408] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.409] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.410] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.411] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.414] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:51:38.417] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.417] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:38.426] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.428] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:38.431] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.2044ms
[2025-12-23 00:51:38.432] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.433] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 34.0614ms
[2025-12-23 00:51:38.433] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.445] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.450] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:38.455] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:51:38.457] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:38.458] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 45.3565ms
[2025-12-23 00:51:38.459] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.459] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 60.5014ms
[2025-12-23 00:51:38.463] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:51:38.464] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:51:38.465] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.467] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.470] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.471] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.473] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.478] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.478] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.482] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.482] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:51:38.490] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.490] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.494] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.494] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:51:38.511] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:38.513] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:51:38.514] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:51:38.516] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:51:38.517] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:38.518] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:51:38.521] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.4073ms
[2025-12-23 00:51:38.523] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 47.7572ms
[2025-12-23 00:51:38.524] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.525] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:51:38.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 62.0283ms
[2025-12-23 00:51:38.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 62.9955ms
[2025-12-23 00:51:38.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:51:38.533] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.534] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:51:38.536] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.549] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:51:38.553] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:51:38.555] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType8`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:38.557] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 18.6131ms
[2025-12-23 00:51:38.558] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:51:38.559] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 28.6141ms
[2025-12-23 00:51:38.563] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:51:38.565] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.566] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:51:38.567] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.582] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:51:38.584] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:51:38.588] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 17.8059ms
[2025-12-23 00:51:38.590] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:51:38.591] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 27.7991ms
[2025-12-23 00:51:38.595] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:38.597] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.598] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.599] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.601] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:51:38.609] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:38.615] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:38.616] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.9072ms
[2025-12-23 00:51:38.620] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.622] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 26.8698ms
[2025-12-23 00:51:38.628] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:51:38.631] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:51:38.631] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.632] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:51:38.638] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:51:38.642] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Date)
    .Select(g => new { 
        date = g.Key.ToString("yyyy-MM-dd"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'System.DateTime.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:51:38.647] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:51:38.648] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.2138ms
[2025-12-23 00:51:38.649] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:51:38.650] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 21.9922ms
[2025-12-23 00:52:44.464] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:52:44.679] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:52:44.701] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:52:44.794] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:52:44.795] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:52:44.858] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:52:44.860] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:52:44.861] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:52:44.974] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:52:45.104] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 130.3862ms
[2025-12-23 00:52:45.119] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:52:45.119] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:52:45.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 8.8621ms
[2025-12-23 00:52:45.144] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 25.7197ms
[2025-12-23 00:52:45.237] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:52:45.267] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 30.4191ms
[2025-12-23 00:52:46.743] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:52:46.754] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:46.758] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 14.4455ms
[2025-12-23 00:52:46.777] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:52:46.789] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:46.841] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:52:46.860] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:52:48.023] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:48.147] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (34ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:52:48.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:52:48.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:52:48.249] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:48.254] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:48.256] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 32.0889ms
[2025-12-23 00:52:48.259] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:52:48.268] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:48.274] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:52:48.275] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:52:48.277] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:52:48.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:52:48.301] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:52:48.302] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:48.307] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:52:48.309] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:52:48.309] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:52:48.311] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:52:48.323] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 1460.2997ms
[2025-12-23 00:52:48.323] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 41.396ms
[2025-12-23 00:52:48.325] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:52:48.326] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:52:48.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 499 null application/json; charset=utf-8 1554.6126ms
[2025-12-23 00:52:48.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 87.0707ms
[2025-12-23 00:52:48.427] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:52:48.465] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:52:48.476] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 193.1622ms
[2025-12-23 00:52:48.477] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:52:48.479] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 219.0947ms
[2025-12-23 00:52:51.899] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:52:51.899] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:52:51.905] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:51.908] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.5961ms
[2025-12-23 00:52:51.909] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:51.912] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:52:51.914] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 15.072ms
[2025-12-23 00:52:51.917] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:52:51.920] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:51.926] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:51.928] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:51.928] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:51.937] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:51.937] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.007] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.018] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.018] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.028] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.028] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.033] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.038] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.038] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.068] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:52:52.068] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:52:52.073] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:52:52.074] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:52:52.077] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:52:52.077] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:52:52.085] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 146.2418ms
[2025-12-23 00:52:52.085] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 145.1448ms
[2025-12-23 00:52:52.087] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.088] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.089] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 177.139ms
[2025-12-23 00:52:52.090] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 172.8195ms
[2025-12-23 00:52:52.095] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.095] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.098] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.101] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.102] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 6.7378ms
[2025-12-23 00:52:52.102] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 7.1436ms
[2025-12-23 00:52:52.106] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.112] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.123] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.126] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.127] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.127] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.129] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.132] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.134] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.137] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.141] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.143] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.144] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:52:52.147] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:52:52.149] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:52:52.152] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:52:52.153] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.8651ms
[2025-12-23 00:52:52.155] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.156] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 43.6903ms
[2025-12-23 00:52:52.177] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.221] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.236] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:52:52.237] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 103.1267ms
[2025-12-23 00:52:52.239] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.240] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 134.2563ms
[2025-12-23 00:52:52.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:52:52.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:52:52.247] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.249] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.250] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.8293ms
[2025-12-23 00:52:52.252] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.252] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:52:52.256] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.258] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.260] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.261] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.262] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.265] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:52:52.266] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.270] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.271] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.273] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.279] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.281] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:52:52.287] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:52:52.289] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:52:52.290] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 27.5028ms
[2025-12-23 00:52:52.292] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:52:52.293] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.296] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 36.9827ms
[2025-12-23 00:52:52.297] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 44.4245ms
[2025-12-23 00:52:52.298] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.303] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 57.9673ms
[2025-12-23 00:52:52.308] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:52:52.308] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:52:52.310] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.313] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.319] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:52:52.319] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 11.1853ms
[2025-12-23 00:52:52.314] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.8165ms
[2025-12-23 00:52:52.322] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:52:52.323] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.332] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.334] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.335] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.335] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.337] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.341] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.342] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.345] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.348] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:52:52.349] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.351] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.354] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.355] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:52:52.357] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:52:52.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:52:52.359] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:52:52.361] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:52:52.362] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:52:52.363] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:52:52.366] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 27.6432ms
[2025-12-23 00:52:52.368] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 28.7873ms
[2025-12-23 00:52:52.369] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.370] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:52:52.371] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 51.9564ms
[2025-12-23 00:52:52.372] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 50.3983ms
[2025-12-23 00:52:52.378] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:52:52.386] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.387] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 8.5291ms
[2025-12-23 00:52:52.389] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:52:52.392] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.394] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:52:52.399] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.465] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:52:52.471] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:52:52.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:52:52.476] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 74.1315ms
[2025-12-23 00:52:52.478] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:52:52.479] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 89.7926ms
[2025-12-23 00:52:52.485] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:52:52.488] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.490] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 4.4137ms
[2025-12-23 00:52:52.492] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:52:52.495] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.497] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:52:52.502] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.526] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:52:52.529] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType11`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:52:52.534] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 29.5091ms
[2025-12-23 00:52:52.537] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:52:52.538] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 45.8542ms
[2025-12-23 00:52:52.542] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.546] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.547] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 4.6542ms
[2025-12-23 00:52:52.550] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.555] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.556] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.557] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.562] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:52:52.571] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.579] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.589] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:52:52.590] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 30.5351ms
[2025-12-23 00:52:52.592] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.593] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 43.1288ms
[2025-12-23 00:52:52.620] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.627] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.628] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 8.4602ms
[2025-12-23 00:52:52.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:52:52.634] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:52:52.636] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.637] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:52:52.641] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:52:52.647] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.664] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:52:52.674] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:52:52.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 36.5247ms
[2025-12-23 00:52:52.677] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:52:52.678] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 47.9386ms
[2025-12-23 00:53:51.122] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:53:51.128] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 7.3879ms
[2025-12-23 00:53:51.148] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:53:51.153] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.155] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:53:51.158] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:53:51.172] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:53:51.175] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:53:51.177] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 17.5348ms
[2025-12-23 00:53:51.178] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:53:51.180] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 31.1527ms
[2025-12-23 00:53:51.182] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:53:51.184] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:53:51.191] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.192] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.194] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 11.9402ms
[2025-12-23 00:53:51.195] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 10.8422ms
[2025-12-23 00:53:51.198] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:53:51.204] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.205] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.206] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.210] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:53:51.212] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.212] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.214] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.219] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.219] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.223] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.225] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.227] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.229] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.231] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:53:51.233] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.234] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:53:51.236] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:53:51.236] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.237] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.9942ms
[2025-12-23 00:53:51.240] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.241] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 42.5618ms
[2025-12-23 00:53:51.243] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:53:51.245] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:53:51.246] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:53:51.247] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.6744ms
[2025-12-23 00:53:51.250] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.251] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 41.5031ms
[2025-12-23 00:53:51.257] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.257] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.259] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.261] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.261] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.4574ms
[2025-12-23 00:53:51.262] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.1221ms
[2025-12-23 00:53:51.264] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.264] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.270] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.271] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.272] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.273] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.273] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.274] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.277] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:53:51.279] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.285] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.285] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.292] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.296] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.302] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:53:51.304] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 28.8261ms
[2025-12-23 00:53:51.305] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.306] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.308] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 44.3113ms
[2025-12-23 00:53:51.310] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:53:51.314] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:53:51.317] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:53:51.318] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 41.7452ms
[2025-12-23 00:53:51.320] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.321] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 57.2235ms
[2025-12-23 00:53:51.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:53:51.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:53:51.328] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.330] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.331] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.9591ms
[2025-12-23 00:53:51.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:53:51.335] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.340] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.342] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.343] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.343] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.346] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:53:51.348] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.352] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.352] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.359] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.362] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.369] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:53:51.371] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 26.6259ms
[2025-12-23 00:53:51.372] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:53:51.373] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.375] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:53:51.376] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 500 null text/plain; charset=utf-8 40.8707ms
[2025-12-23 00:53:51.377] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:53:51.380] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 38.9468ms
[2025-12-23 00:53:51.381] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.385] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 59.5245ms
[2025-12-23 00:53:51.392] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:53:51.392] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:53:51.395] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.397] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.397] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 5.8881ms
[2025-12-23 00:53:51.399] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 7.3276ms
[2025-12-23 00:53:51.403] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:53:51.404] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:53:51.412] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.417] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.429] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.428] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.431] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.434] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.441] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.441] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.446] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.446] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:53:51.454] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.460] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.460] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.463] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:53:51.464] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:53:51.469] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:53:51.469] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:53:51.471] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:53:51.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:53:51.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:53:51.474] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 35.3144ms
[2025-12-23 00:53:51.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 38.4657ms
[2025-12-23 00:53:51.476] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.477] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:53:51.478] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 74.9911ms
[2025-12-23 00:53:51.480] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 75.4584ms
[2025-12-23 00:53:51.487] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:53:51.493] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.494] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 6.2127ms
[2025-12-23 00:53:51.496] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:53:51.500] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.501] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:53:51.502] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.516] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:53:51.518] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:53:51.519] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType9`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:53:51.520] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 16.0864ms
[2025-12-23 00:53:51.521] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:53:51.522] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 26.3619ms
[2025-12-23 00:53:51.527] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:53:51.529] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.9611ms
[2025-12-23 00:53:51.533] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:53:51.536] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.537] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:53:51.538] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.548] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:53:51.551] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType11`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:53:51.552] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 12.8257ms
[2025-12-23 00:53:51.553] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:53:51.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 21.3553ms
[2025-12-23 00:53:51.559] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.561] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.562] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.6845ms
[2025-12-23 00:53:51.564] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.568] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.569] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.570] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.572] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:53:51.577] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.584] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.590] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:53:51.592] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.3346ms
[2025-12-23 00:53:51.593] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.594] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 29.4818ms
[2025-12-23 00:53:51.601] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.603] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.604] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.2149ms
[2025-12-23 00:53:51.606] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:53:51.610] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:53:51.611] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.612] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:53:51.617] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:53:51.621] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: day, StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.628] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month, 
        Day = o.CreatedAt.Day
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2") + "-" + g.Key.Day.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information.
Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 175
[2025-12-23 00:53:51.636] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:53:51.638] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.2657ms
[2025-12-23 00:53:51.639] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:53:51.640] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 33.7658ms
[2025-12-23 00:55:27.928] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:55:28.153] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:55:28.174] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:55:28.273] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:55:28.274] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:55:28.339] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:55:28.341] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:55:28.343] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:55:28.848] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:55:28.963] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 115.7081ms
[2025-12-23 00:55:28.980] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:55:28.980] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:55:28.987] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 7.3065ms
[2025-12-23 00:55:29.006] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 26.3854ms
[2025-12-23 00:55:29.087] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:55:29.122] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 34.3192ms
[2025-12-23 00:55:29.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 00:55:29.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:55:29.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:55:29.651] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:29.676] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:29.678] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:29.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 42.0991ms
[2025-12-23 00:55:29.681] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 42.085ms
[2025-12-23 00:55:29.683] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 43.9216ms
[2025-12-23 00:55:29.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:55:29.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:55:29.687] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:55:29.700] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:29.703] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:29.706] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:29.760] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:55:29.760] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:55:29.761] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:55:29.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:55:29.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:55:29.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:55:30.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:30.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:30.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:30.817] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:55:30.818] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:55:30.820] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:55:30.903] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:55:30.903] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:55:30.914] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:30.914] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:30.915] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:55:30.918] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:30.927] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 1138.8708ms
[2025-12-23 00:55:30.927] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 1139.8764ms
[2025-12-23 00:55:30.928] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 1144.703ms
[2025-12-23 00:55:30.929] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:55:30.930] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:55:30.931] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:55:30.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 1253.7941ms
[2025-12-23 00:55:30.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 1252.9059ms
[2025-12-23 00:55:30.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 1253.8497ms
[2025-12-23 00:55:32.702] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:55:32.707] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:32.708] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 6.471ms
[2025-12-23 00:55:32.720] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:55:32.723] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:55:32.723] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 00:55:32.724] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 00:55:32.724] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:32.728] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:32.732] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:32.735] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:32.740] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:55:32.740] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:55:32.759] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:55:32.771] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:55:32.772] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:55:32.772] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 00:55:32.777] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 00:55:32.782] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:55:32.912] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:32.912] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:32.912] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:32.923] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:55:32.928] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 00:55:32.930] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:55:32.934] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 00:55:32.935] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:55:32.940] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:32.941] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:55:32.943] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:32.946] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 161.9267ms
[2025-12-23 00:55:32.949] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:32.951] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 171.9421ms
[2025-12-23 00:55:32.952] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 00:55:32.953] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 177.7824ms
[2025-12-23 00:55:32.955] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 00:55:32.956] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 232.324ms
[2025-12-23 00:55:32.957] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:55:32.958] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 234.4512ms
[2025-12-23 00:55:32.963] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 240.0454ms
[2025-12-23 00:55:33.010] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:55:33.054] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:55:33.061] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 274.7334ms
[2025-12-23 00:55:33.063] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:55:33.065] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 345.4787ms
[2025-12-23 00:55:33.840] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:55:33.841] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:33.845] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:33.849] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.6336ms
[2025-12-23 00:55:33.850] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:33.852] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:55:33.855] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 14.128ms
[2025-12-23 00:55:33.867] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:33.871] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.121] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.123] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.124] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.152] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.134] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.207] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.208] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.221] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.221] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.236] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.236] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.260] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.260] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.309] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:55:34.333] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (32ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:34.344] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:55:34.349] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:55:34.351] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:34.351] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:34.362] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 190.1652ms
[2025-12-23 00:55:34.362] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 202.5075ms
[2025-12-23 00:55:34.368] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.369] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.370] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 517.6887ms
[2025-12-23 00:55:34.371] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 503.8893ms
[2025-12-23 00:55:34.379] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.380] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.388] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.391] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.392] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 13.5332ms
[2025-12-23 00:55:34.394] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 13.8283ms
[2025-12-23 00:55:34.397] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.397] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.406] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.410] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.412] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.413] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.416] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.424] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.424] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.433] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.437] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.442] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:34.443] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.454] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:34.459] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:55:34.461] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:34.463] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 43.1814ms
[2025-12-23 00:55:34.465] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.466] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.470] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 72.7876ms
[2025-12-23 00:55:34.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:34.480] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 53.1569ms
[2025-12-23 00:55:34.482] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.484] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 87.518ms
[2025-12-23 00:55:34.489] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:34.490] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:34.492] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.496] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.498] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 8.0326ms
[2025-12-23 00:55:34.499] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.500] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:34.504] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.507] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.511] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.512] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.512] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.517] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.521] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:55:34.523] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.526] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.529] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.532] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:34.537] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:34.537] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.5082ms
[2025-12-23 00:55:34.540] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:55:34.542] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.545] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:34.547] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 47.4672ms
[2025-12-23 00:55:34.549] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 40.1529ms
[2025-12-23 00:55:34.557] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.559] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 69.0061ms
[2025-12-23 00:55:34.565] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:55:34.566] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:55:34.569] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.574] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.575] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 9.5393ms
[2025-12-23 00:55:34.576] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 10.3377ms
[2025-12-23 00:55:34.578] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:55:34.579] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:55:34.586] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.590] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.592] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.594] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.595] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.596] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.602] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.605] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.607] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.610] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.614] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.617] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.619] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.624] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:34.629] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:34.633] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:34.635] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:55:34.638] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:55:34.640] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:34.642] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:34.645] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 46.7617ms
[2025-12-23 00:55:34.647] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 45.7365ms
[2025-12-23 00:55:34.649] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.650] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:34.651] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 73.2729ms
[2025-12-23 00:55:34.653] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 74.2204ms
[2025-12-23 00:55:34.658] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:55:34.665] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.666] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 8.3261ms
[2025-12-23 00:55:34.669] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:55:34.673] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.675] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:55:34.682] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.745] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:55:34.750] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:55:34.751] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:34.757] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 72.1822ms
[2025-12-23 00:55:34.760] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:55:34.761] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 92.5843ms
[2025-12-23 00:55:34.767] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:55:34.769] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.770] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.1015ms
[2025-12-23 00:55:34.773] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:55:34.777] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.778] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:55:34.785] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.823] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:55:34.829] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:34.834] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 45.8176ms
[2025-12-23 00:55:34.836] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:55:34.837] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 64.2899ms
[2025-12-23 00:55:34.842] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.844] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.845] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 3.145ms
[2025-12-23 00:55:34.848] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.854] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.855] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.857] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.861] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:34.866] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.868] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:34.871] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.5776ms
[2025-12-23 00:55:34.873] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.874] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 26.2418ms
[2025-12-23 00:55:34.888] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.891] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.892] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.6981ms
[2025-12-23 00:55:34.894] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:34.899] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:34.900] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.901] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:34.903] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:34.907] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:34.911] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:34.912] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.852ms
[2025-12-23 00:55:34.916] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:34.918] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 23.3337ms
[2025-12-23 00:55:42.585] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:42.587] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:42.588] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.1513ms
[2025-12-23 00:55:42.590] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:42.593] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:42.594] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:42.595] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:42.599] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:42.618] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: year, StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        date = g.Key.ToString("D4"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
[2025-12-23 00:55:42.662] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        date = g.Key.ToString("D4"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
[2025-12-23 00:55:42.668] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:55:42.669] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 71.4387ms
[2025-12-23 00:55:42.670] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:42.671] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 80.8445ms
[2025-12-23 00:55:44.512] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:44.515] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:44.517] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.7414ms
[2025-12-23 00:55:44.519] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:44.521] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:44.522] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:44.523] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:44.525] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:44.531] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: month, StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
[2025-12-23 00:55:44.550] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
[2025-12-23 00:55:44.558] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:55:44.560] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 35.257ms
[2025-12-23 00:55:44.562] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:44.563] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 44.1396ms
[2025-12-23 00:55:45.943] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:45.945] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:45.946] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.308ms
[2025-12-23 00:55:45.949] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:45.951] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:45.953] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:45.954] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:45.956] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:45.966] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:45.976] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:45.985] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 29.3381ms
[2025-12-23 00:55:45.987] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:45.988] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 39.2896ms
[2025-12-23 00:55:46.889] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:46.891] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:46.891] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.6014ms
[2025-12-23 00:55:46.893] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:46.896] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:46.897] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:46.898] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:46.901] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:46.905] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:46.908] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:46.909] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.5852ms
[2025-12-23 00:55:46.910] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:46.911] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 17.841ms
[2025-12-23 00:55:49.252] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2026-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:49.254] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:49.255] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2026-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.9147ms
[2025-12-23 00:55:49.258] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2026-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:49.260] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:49.261] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:49.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:49.265] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2026-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:49.268] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:49.270] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:49.271] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 7.209ms
[2025-12-23 00:55:49.272] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:49.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2026-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 14.676ms
[2025-12-23 00:55:51.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:51.557] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:51.558] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 3.1117ms
[2025-12-23 00:55:51.560] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:51.564] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:51.566] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:51.568] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:51.570] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-01-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:51.572] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:51.574] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:51.576] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 6.999ms
[2025-12-23 00:55:51.577] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:51.578] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 17.8536ms
[2025-12-23 00:55:55.469] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:55.471] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:55.472] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 3.2877ms
[2025-12-23 00:55:55.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:55.478] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:55.480] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:55.482] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:55.485] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2025-01-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:55.487] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:55.490] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:55.491] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 7.1992ms
[2025-12-23 00:55:55.492] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:55.494] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2025-01-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 18.9467ms
[2025-12-23 00:55:57.081] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:55:57.083] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.084] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 3.9103ms
[2025-12-23 00:55:57.087] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:55:57.089] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.090] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:55:57.091] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:55:57.103] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:55:57.106] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:55:57.107] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 14.4841ms
[2025-12-23 00:55:57.110] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:55:57.112] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 25.0592ms
[2025-12-23 00:55:57.151] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:55:57.152] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:57.153] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.156] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.157] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 6.4702ms
[2025-12-23 00:55:57.158] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.5288ms
[2025-12-23 00:55:57.163] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:55:57.163] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:57.168] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.169] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.170] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.171] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.171] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.172] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.177] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.178] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.182] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.185] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.187] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.188] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.191] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.191] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.213] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (18ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:57.213] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:55:57.217] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:55:57.219] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:55:57.220] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:57.219] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:57.222] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 47.9467ms
[2025-12-23 00:55:57.225] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 49.9099ms
[2025-12-23 00:55:57.226] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.227] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.228] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 65.0429ms
[2025-12-23 00:55:57.229] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 65.2489ms
[2025-12-23 00:55:57.236] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.236] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.239] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.240] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.241] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.8855ms
[2025-12-23 00:55:57.242] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.4945ms
[2025-12-23 00:55:57.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.249] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.251] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.252] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.253] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.254] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.254] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.257] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:57.259] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.259] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.262] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.265] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:57.267] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.1537ms
[2025-12-23 00:55:57.270] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.270] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 28.54ms
[2025-12-23 00:55:57.272] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:57.276] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:55:57.277] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:57.279] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 21.2884ms
[2025-12-23 00:55:57.281] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.282] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 38.2899ms
[2025-12-23 00:55:57.286] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:57.286] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:57.288] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.290] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.290] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 4.8417ms
[2025-12-23 00:55:57.291] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.292] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:55:57.294] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.298] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.300] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.301] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.301] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.303] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.305] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:55:57.307] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.308] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.310] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.311] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:57.314] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.0394ms
[2025-12-23 00:55:57.314] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:57.316] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.318] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:55:57.318] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 26.2303ms
[2025-12-23 00:55:57.320] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:57.323] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 24.4587ms
[2025-12-23 00:55:57.324] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 39.5373ms
[2025-12-23 00:55:57.331] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:55:57.331] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:55:57.333] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.335] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.336] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 4.8282ms
[2025-12-23 00:55:57.336] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.4375ms
[2025-12-23 00:55:57.338] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:55:57.338] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:55:57.344] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.347] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.348] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.348] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.349] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.350] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.353] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.354] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.356] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.358] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.361] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.363] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.365] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:55:57.367] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:57.369] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:55:57.370] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:55:57.371] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:55:57.372] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:57.373] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:55:57.374] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 23.3242ms
[2025-12-23 00:55:57.375] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 23.0827ms
[2025-12-23 00:55:57.376] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.377] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:55:57.378] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 39.8691ms
[2025-12-23 00:55:57.380] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 41.1219ms
[2025-12-23 00:55:57.386] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:55:57.388] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.389] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 2.8105ms
[2025-12-23 00:55:57.391] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:55:57.393] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.394] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:55:57.395] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.408] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:55:57.410] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:55:57.411] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:57.413] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 15.4485ms
[2025-12-23 00:55:57.414] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:55:57.415] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 24.4368ms
[2025-12-23 00:55:57.420] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:55:57.422] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.422] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.5997ms
[2025-12-23 00:55:57.424] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:55:57.427] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.428] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:55:57.429] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.443] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:55:57.448] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:57.450] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 19.5252ms
[2025-12-23 00:55:57.451] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:55:57.452] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 28.3847ms
[2025-12-23 00:55:57.458] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.460] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.460] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.639ms
[2025-12-23 00:55:57.462] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.466] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.467] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.469] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.471] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:57.473] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:57.476] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 6.1092ms
[2025-12-23 00:55:57.477] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.478] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 15.9017ms
[2025-12-23 00:55:57.484] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.486] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.487] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.8509ms
[2025-12-23 00:55:57.489] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:55:57.492] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:55:57.493] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.493] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:55:57.495] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:55:57.498] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:55:57.500] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:55:57.501] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 6.826ms
[2025-12-23 00:55:57.502] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:55:57.503] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 14.2704ms
[2025-12-23 00:56:01.801] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:56:01.804] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:56:01.805] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.858ms
[2025-12-23 00:56:01.807] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:56:01.810] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:56:01.811] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:56:01.813] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:56:01.816] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:56:01.819] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: month, StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
[2025-12-23 00:56:01.826] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => new { 
        Year = o.CreatedAt.Year, 
        Month = o.CreatedAt.Month
     })
    .Select(g => new { 
        date = (object)g.Key.Year + "-" + g.Key.Month.ToString("D2"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 143
[2025-12-23 00:56:01.833] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:56:01.835] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.7362ms
[2025-12-23 00:56:01.836] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:56:01.837] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 30.471ms
[2025-12-23 00:56:05.130] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:56:05.133] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:56:05.134] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.2508ms
[2025-12-23 00:56:05.136] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:56:05.138] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:56:05.139] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:56:05.140] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:56:05.142] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:56:05.145] [ERR] [RestaurantAPI.Controllers.StatisticsController] Ошибка при получении статистики выручки по датам. Period: year, StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        date = g.Key.ToString("D4"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
[2025-12-23 00:56:05.151] [ERR] [RestaurantAPI.Controllers.StatisticsController] Полный стек ошибки:    at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
System.InvalidOperationException: The LINQ expression 'DbSet<Order>()
    .Where(o => !(o.IsDeleted))
    .Where(o => o.CreatedAt >= __utcStartDate_0)
    .Where(o => o.CreatedAt <= __utcEndDate_1)
    .GroupBy(o => o.CreatedAt.Year)
    .Select(g => new { 
        date = g.Key.ToString("D4"), 
        revenue = g
            .AsQueryable()
            .Sum(e => e.Total), 
        ordersCount = g
            .AsQueryable()
            .Count()
     })
    .OrderBy(e0 => e0.date)' could not be translated. Additional information: Translation of method 'int.ToString' failed. If this method can be mapped to your custom function, see https://go.microsoft.com/fwlink/?linkid=2132413 for more information. Either rewrite the query in a form that can be translated, or switch to client evaluation explicitly by inserting a call to 'AsEnumerable', 'AsAsyncEnumerable', 'ToList', or 'ToListAsync'. See https://go.microsoft.com/fwlink/?linkid=2101038 for more information.
   at Microsoft.EntityFrameworkCore.Query.QueryableMethodTranslatingExpressionVisitor.Translate(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate(Nullable`1 startDate, Nullable`1 endDate, String period) in D:\restaurant-project\RestaurantAPI\RestaurantApi\Controllers\StatisticsController.cs:line 165
[2025-12-23 00:56:05.155] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'System.String'.
[2025-12-23 00:56:05.156] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.6413ms
[2025-12-23 00:56:05.157] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:56:05.158] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 500 null text/plain; charset=utf-8 22.0899ms
[2025-12-23 00:57:17.385] [INF] [] Запуск приложения Restaurant API
[2025-12-23 00:57:17.595] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 00:57:17.615] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 00:57:17.699] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 00:57:17.700] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 00:57:17.762] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 00:57:17.765] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 00:57:17.766] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 00:57:17.914] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 00:57:18.025] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 112.2461ms
[2025-12-23 00:57:18.056] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 00:57:18.056] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 00:57:18.065] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 8.3466ms
[2025-12-23 00:57:18.087] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 30.973ms
[2025-12-23 00:57:18.148] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 00:57:18.177] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 29.2921ms
[2025-12-23 00:57:20.796] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 00:57:20.804] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:20.806] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 9.9517ms
[2025-12-23 00:57:20.810] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 00:57:20.817] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:20.848] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:57:20.850] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:57:20.852] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:20.855] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 7.1182ms
[2025-12-23 00:57:20.855] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:20.857] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 00:57:20.859] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 8.9781ms
[2025-12-23 00:57:20.863] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:20.864] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:57:20.868] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:20.909] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:57:20.909] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:20.909] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:20.931] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:20.931] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 00:57:20.931] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.302] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (22ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.302] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.304] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (28ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 00:57:22.348] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.348] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.367] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.367] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.384] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 00:57:22.397] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:57:22.400] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:57:22.405] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:57:22.407] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 1469.9332ms
[2025-12-23 00:57:22.408] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 00:57:22.410] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 00:57:22.413] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 00:57:22.414] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1478.1624ms
[2025-12-23 00:57:22.414] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:57:22.415] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 1605.1883ms
[2025-12-23 00:57:22.415] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.416] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 1483.9866ms
[2025-12-23 00:57:22.420] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 1556.0875ms
[2025-12-23 00:57:22.421] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.424] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 1566.716ms
[2025-12-23 00:57:22.430] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.430] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.431] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.434] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.434] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.7191ms
[2025-12-23 00:57:22.435] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.2ms
[2025-12-23 00:57:22.437] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.437] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.443] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.445] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.447] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.447] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.448] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.453] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.493] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 00:57:22.496] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.499] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.502] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.505] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.505] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.510] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:57:22.510] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:22.513] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 00:57:22.515] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:57:22.516] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 61.255ms
[2025-12-23 00:57:22.516] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 65.5781ms
[2025-12-23 00:57:22.517] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.518] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.519] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 81.8713ms
[2025-12-23 00:57:22.520] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 82.6556ms
[2025-12-23 00:57:22.523] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:57:22.523] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:57:22.527] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.529] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 6.5033ms
[2025-12-23 00:57:22.531] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.532] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 00:57:22.534] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.536] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.538] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.539] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.539] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.542] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 00:57:22.545] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.547] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.549] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.550] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:22.552] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.552] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.6335ms
[2025-12-23 00:57:22.556] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.556] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:57:22.557] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 25.1577ms
[2025-12-23 00:57:22.559] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 00:57:22.562] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:57:22.576] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 39.4166ms
[2025-12-23 00:57:22.579] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.580] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 57.1068ms
[2025-12-23 00:57:22.586] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:57:22.586] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:57:22.588] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.591] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.591] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.3186ms
[2025-12-23 00:57:22.592] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 5.8831ms
[2025-12-23 00:57:22.594] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 00:57:22.595] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 00:57:22.601] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.603] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.604] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.605] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.606] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.606] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.610] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.612] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.614] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.615] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.617] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.618] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.620] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.622] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:22.624] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:57:22.625] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 00:57:22.626] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 00:57:22.628] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 00:57:22.629] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:57:22.630] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 00:57:22.631] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 23.3337ms
[2025-12-23 00:57:22.633] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 23.5427ms
[2025-12-23 00:57:22.634] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.635] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 00:57:22.636] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 41.9669ms
[2025-12-23 00:57:22.637] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 41.5242ms
[2025-12-23 00:57:22.641] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:57:22.644] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.645] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 3.8512ms
[2025-12-23 00:57:22.647] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 00:57:22.650] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.651] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:57:22.671] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.709] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 00:57:22.715] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 00:57:22.716] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:22.719] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 46.7378ms
[2025-12-23 00:57:22.721] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 00:57:22.721] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 74.3222ms
[2025-12-23 00:57:22.726] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:57:22.728] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.729] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 3.5451ms
[2025-12-23 00:57:22.732] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 00:57:22.735] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.736] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:57:22.739] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.760] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 00:57:22.763] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:22.766] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 25.3124ms
[2025-12-23 00:57:22.767] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 00:57:22.768] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 36.2331ms
[2025-12-23 00:57:22.772] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.774] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.566ms
[2025-12-23 00:57:22.778] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.781] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.782] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.786] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 00:57:22.790] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.792] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:22.793] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 8.367ms
[2025-12-23 00:57:22.795] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.796] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 19.5346ms
[2025-12-23 00:57:22.801] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.803] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.804] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 2.9587ms
[2025-12-23 00:57:22.806] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:22.809] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:22.810] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.812] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:22.814] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:57:22.817] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:22.819] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:22.820] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 6.6214ms
[2025-12-23 00:57:22.821] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:22.822] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 15.3299ms
[2025-12-23 00:57:25.411] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:25.423] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:25.424] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 13.4001ms
[2025-12-23 00:57:25.427] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:25.433] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:25.435] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:25.437] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:25.442] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: week (нормализован: week), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:57:25.458] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [OrderDate], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:25.471] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:25.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 36.2282ms
[2025-12-23 00:57:25.476] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:25.479] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=week&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 52.2401ms
[2025-12-23 00:57:26.768] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:26.771] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:26.772] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.6303ms
[2025-12-23 00:57:26.775] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:26.780] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:26.782] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:26.783] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:26.787] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: month (нормализован: month), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:57:26.791] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:26.797] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:26.800] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.2696ms
[2025-12-23 00:57:26.801] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:26.802] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=month&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 26.6558ms
[2025-12-23 00:57:28.394] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:28.397] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:28.398] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 4.0992ms
[2025-12-23 00:57:28.400] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 00:57:28.403] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:28.404] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:28.405] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 00:57:28.407] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: year (нормализован: year), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 00:57:28.409] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 00:57:28.426] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:28.428] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 22.1055ms
[2025-12-23 00:57:28.429] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 00:57:28.430] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=year&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 30.5081ms
[2025-12-23 00:57:31.659] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:57:31.665] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:31.667] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 8.5625ms
[2025-12-23 00:57:31.670] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 00:57:31.674] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:31.676] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:57:31.718] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 00:57:31.731] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:31.753] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 00:57:31.823] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 00:57:31.824] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:31.829] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 108.3344ms
[2025-12-23 00:57:31.830] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 00:57:31.831] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 161.2559ms
[2025-12-23 00:57:31.837] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:57:31.839] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:31.840] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 2.5593ms
[2025-12-23 00:57:31.842] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 00:57:31.846] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:31.847] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:57:31.852] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 00:57:31.881] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:31.900] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 00:57:31.952] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 00:57:31.954] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:31.958] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 104.5151ms
[2025-12-23 00:57:31.959] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 00:57:31.960] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 118.5695ms
[2025-12-23 00:57:31.965] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:57:31.967] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:31.968] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 3.2391ms
[2025-12-23 00:57:31.970] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 00:57:31.973] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 00:57:31.974] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:57:31.980] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 00:57:31.989] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 00:57:32.006] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 00:57:32.034] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 25, Страница: 1
[2025-12-23 00:57:32.035] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 00:57:32.043] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 61.5803ms
[2025-12-23 00:57:32.045] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 00:57:32.046] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 76.3618ms
[2025-12-23 01:00:13.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 01:00:13.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 01:00:13.129] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.133] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.134] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 7.8326ms
[2025-12-23 01:00:13.135] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.6596ms
[2025-12-23 01:00:13.138] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 01:00:13.138] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 01:00:13.145] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.148] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.149] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.150] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.150] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.151] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.159] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.159] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.196] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.196] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.201] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.202] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.205] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.205] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.212] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 01:00:13.212] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 01:00:13.214] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 01:00:13.215] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 104940.00, Заказов: 25
[2025-12-23 01:00:13.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 01:00:13.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 01:00:13.217] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 64.9019ms
[2025-12-23 01:00:13.218] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 64.6239ms
[2025-12-23 01:00:13.219] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.220] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.221] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 83.221ms
[2025-12-23 01:00:13.222] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 83.8569ms
[2025-12-23 01:00:13.228] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.228] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.230] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.232] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 4.8529ms
[2025-12-23 01:00:13.233] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 5.2278ms
[2025-12-23 01:00:13.235] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.236] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.240] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.242] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.242] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.243] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.244] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.248] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 01:00:13.250] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.251] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.253] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.254] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:13.256] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.256] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.0546ms
[2025-12-23 01:00:13.259] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.259] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.261] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 25.2038ms
[2025-12-23 01:00:13.263] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 01:00:13.266] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 66380.00, Заказов: 22
[2025-12-23 01:00:13.267] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 01:00:13.268] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 20.3181ms
[2025-12-23 01:00:13.269] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.270] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 34.0231ms
[2025-12-23 01:00:13.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 01:00:13.273] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 01:00:13.275] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.277] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.278] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.1324ms
[2025-12-23 01:00:13.278] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.279] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 01:00:13.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.283] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.285] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.286] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.286] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.288] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 01:00:13.292] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.293] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.294] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.295] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:13.297] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.298] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 10.2461ms
[2025-12-23 01:00:13.300] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 01:00:13.300] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.302] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 01:00:13.302] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 22.8929ms
[2025-12-23 01:00:13.303] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 01:00:13.307] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 22.2582ms
[2025-12-23 01:00:13.308] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.309] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 36.5025ms
[2025-12-23 01:00:13.321] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 01:00:13.321] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 01:00:13.323] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.325] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 4.6205ms
[2025-12-23 01:00:13.326] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 204 null null 5.0533ms
[2025-12-23 01:00:13.328] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 01:00:13.328] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - null null
[2025-12-23 01:00:13.332] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.334] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.335] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.336] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.336] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.337] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.347] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.348] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.350] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.351] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.353] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.355] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.356] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:13.361] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 01:00:13.362] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 01:00:13.363] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 01:00:13.365] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 27150.00, Заказов: 6
[2025-12-23 01:00:13.366] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 01:00:13.367] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 01:00:13.368] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 29.6ms
[2025-12-23 01:00:13.371] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.369] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 25.316ms
[2025-12-23 01:00:13.372] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 43.7907ms
[2025-12-23 01:00:13.373] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 01:00:13.377] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-21T00:00:00.000Z&endDate=2025-12-21T23:59:59.999Z - 200 null application/json; charset=utf-8 48.9294ms
[2025-12-23 01:00:13.381] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 01:00:13.384] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.385] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 3.0583ms
[2025-12-23 01:00:13.387] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 01:00:13.389] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.391] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 01:00:13.392] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.404] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 01:00:13.406] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 01:00:13.408] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:13.409] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 14.5506ms
[2025-12-23 01:00:13.410] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 01:00:13.411] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 24.7415ms
[2025-12-23 01:00:13.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 01:00:13.418] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.418] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 2.7018ms
[2025-12-23 01:00:13.420] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 01:00:13.424] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.426] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 01:00:13.427] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.437] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 01:00:13.440] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:13.442] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 13.2671ms
[2025-12-23 01:00:13.443] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 01:00:13.444] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 23.7677ms
[2025-12-23 01:00:13.447] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.449] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 2.7907ms
[2025-12-23 01:00:13.452] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.455] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.456] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.458] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.460] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 01:00:13.464] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.466] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:13.467] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 7.733ms
[2025-12-23 01:00:13.469] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.470] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 17.9495ms
[2025-12-23 01:00:13.476] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.479] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.480] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 3.1437ms
[2025-12-23 01:00:13.481] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 01:00:13.489] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:13.490] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.494] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 01:00:13.497] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 01:00:13.504] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 01:00:13.506] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:13.508] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 11.8478ms
[2025-12-23 01:00:13.509] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 01:00:13.511] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 29.0732ms
[2025-12-23 01:00:22.222] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 01:00:22.222] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 01:00:22.225] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 01:00:22.228] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:22.229] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:22.231] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:22.232] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 10.3908ms
[2025-12-23 01:00:22.234] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 11.4349ms
[2025-12-23 01:00:22.234] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 8.8019ms
[2025-12-23 01:00:22.237] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 01:00:22.237] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 01:00:22.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 01:00:22.246] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:22.248] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:22.250] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 01:00:22.251] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 01:00:22.252] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 01:00:22.253] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 01:00:22.253] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 01:00:22.260] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 01:00:22.260] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 01:00:22.262] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:22.271] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 01:00:22.272] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:22.276] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 01:00:22.277] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 01:00:22.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:22.303] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 47.5749ms
[2025-12-23 01:00:22.305] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 01:00:22.310] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 73.2499ms
[2025-12-23 01:00:22.315] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 01:00:22.321] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 01:00:22.323] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 01:00:22.325] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:22.329] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 66.6601ms
[2025-12-23 01:00:22.331] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 01:00:22.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 94.2757ms
[2025-12-23 01:00:22.349] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 01:00:22.350] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 01:00:22.353] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 89.0175ms
[2025-12-23 01:00:22.354] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 01:00:22.355] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 117.2283ms
[2025-12-23 10:13:02.812] [INF] [] Запуск приложения Restaurant API
[2025-12-23 10:13:03.861] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 10:13:03.897] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 10:13:04.099] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 10:13:04.100] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 10:13:04.176] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 10:13:04.177] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 10:13:04.178] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 10:13:05.799] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger - null null
[2025-12-23 10:13:05.980] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger - 301 0 null 183.131ms
[2025-12-23 10:13:05.986] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 10:13:06.068] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 81.5703ms
[2025-12-23 10:13:06.099] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 10:13:06.110] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 10.9607ms
[2025-12-23 10:13:06.414] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 10:13:06.475] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 61.3379ms
[2025-12-23 10:13:06.643] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 10:13:06.719] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 75.9531ms
[2025-12-23 10:48:54.022] [INF] [] Запуск приложения Restaurant API
[2025-12-23 10:48:57.272] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 10:48:57.345] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 10:48:57.784] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 10:48:57.887] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 10:48:58.222] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 10:48:58.233] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 10:48:58.244] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 10:48:58.845] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 10:48:59.471] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 628.7422ms
[2025-12-23 10:48:59.521] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 10:48:59.529] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 10:48:59.537] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 15.4761ms
[2025-12-23 10:48:59.673] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 143.5591ms
[2025-12-23 10:48:59.727] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 10:48:59.898] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 171.0062ms
[2025-12-23 10:49:04.902] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 10:49:04.918] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution failed.
[2025-12-23 10:49:04.920] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] Request origin http://localhost:5175 does not have permission to access the resource.
[2025-12-23 10:49:04.923] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 20.9635ms
[2025-12-23 10:49:24.556] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 10:49:24.578] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution failed.
[2025-12-23 10:49:24.579] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] Request origin http://localhost:5175 does not have permission to access the resource.
[2025-12-23 10:49:24.580] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 24.4144ms
[2025-12-23 10:50:21.458] [INF] [] Запуск приложения Restaurant API
[2025-12-23 10:50:21.728] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 10:50:21.752] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 10:50:21.872] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 10:50:21.873] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 10:50:21.971] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 10:50:21.973] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 10:50:21.975] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 10:50:22.244] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 10:50:22.460] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 218.1901ms
[2025-12-23 10:50:22.507] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 10:50:22.522] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 10:50:22.571] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 64.676ms
[2025-12-23 10:50:22.598] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.6582ms
[2025-12-23 10:50:22.755] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 10:50:22.811] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 55.3114ms
[2025-12-23 10:50:28.888] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 10:50:28.946] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:28.955] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 66.6248ms
[2025-12-23 10:50:28.958] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 10:50:28.972] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:32.533] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 10:50:32.588] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:50:33.703] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - null null
[2025-12-23 10:50:33.712] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:33.715] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - 204 null null 11.9476ms
[2025-12-23 10:50:33.718] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Auth/login - application/json 44
[2025-12-23 10:50:33.732] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:33.739] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 10:50:33.770] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.AuthResponseDto]] Login(RestaurantAPI.DTOs.UserLoginDto) on controller RestaurantAPI.Controllers.AuthController (RestaurantApi).
[2025-12-23 10:50:40.186] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (302ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 10:50:40.186] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (302ms) [Parameters=[@__dto_Username_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Users] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[Username] = @__dto_Username_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:50:40.481] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 10:50:40.545] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 7940.3911ms
[2025-12-23 10:50:40.550] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 10:50:40.573] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 499 null application/json; charset=utf-8 11614.6928ms
[2025-12-23 10:50:42.440] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [JwtTokens] ([CreatedAt], [ExpiresAt], [Revoked], [RevokedAt], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
[2025-12-23 10:50:42.514] [INF] [RestaurantAPI.Controllers.AuthController] Пользователь admin успешно вошел в систему
[2025-12-23 10:50:42.519] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'RestaurantAPI.DTOs.AuthResponseDto'.
[2025-12-23 10:50:42.538] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.AuthController.Login (RestaurantApi) in 8763.9742ms
[2025-12-23 10:50:42.542] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 10:50:42.546] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Auth/login - 200 null application/json; charset=utf-8 8828.3009ms
[2025-12-23 10:50:42.556] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 10:50:42.563] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:42.567] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 10.5767ms
[2025-12-23 10:50:42.571] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 10:50:42.580] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:42.593] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 10:50:42.596] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:50:42.829] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 10:50:42.837] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 10:50:42.842] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 239.8961ms
[2025-12-23 10:50:42.844] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 10:50:42.848] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 276.7648ms
[2025-12-23 10:50:45.310] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 10:50:45.311] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 10:50:45.311] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:50:45.324] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.329] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.332] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.333] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - 204 null null 23.6646ms
[2025-12-23 10:50:45.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - 204 null null 23.8392ms
[2025-12-23 10:50:45.336] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 25.2302ms
[2025-12-23 10:50:45.337] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 10:50:45.338] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 10:50:45.339] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:50:45.375] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.381] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.388] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.390] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:50:45.392] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:50:45.394] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:50:45.408] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 10:50:45.410] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 10:50:45.412] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 10:50:45.500] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:50:45.500] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:50:45.506] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:50:45.554] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:50:45.555] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:50:45.574] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 10:50:45.648] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:50:45.648] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 10:50:45.656] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:50:45.659] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:50:45.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 262.7879ms
[2025-12-23 10:50:45.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 257.9922ms
[2025-12-23 10:50:45.680] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:50:45.707] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:50:45.711] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - 200 null application/json; charset=utf-8 374.4142ms
[2025-12-23 10:50:45.714] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 10:50:45.714] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - 200 null application/json; charset=utf-8 376.228ms
[2025-12-23 10:50:45.717] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 10:50:45.726] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:50:45.745] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.754] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 204 null null 36.6869ms
[2025-12-23 10:50:45.757] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 10:50:45.759] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 336.3275ms
[2025-12-23 10:50:45.768] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:45.772] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:50:45.775] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 10:50:45.777] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 438.6322ms
[2025-12-23 10:50:45.788] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 10:50:45.850] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (26ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 10:50:45.902] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 10:50:45.911] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 10:50:45.918] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:50:45.930] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 137.4406ms
[2025-12-23 10:50:45.933] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 10:50:45.937] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 180.7439ms
[2025-12-23 10:50:47.013] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - null null
[2025-12-23 10:50:47.018] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:47.019] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - 204 null null 6.0186ms
[2025-12-23 10:50:47.022] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Cart/items - application/json 75
[2025-12-23 10:50:47.030] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:47.034] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 10:50:47.044] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "AddItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] AddItem(RestaurantAPI.DTOs.CartItemAddDto) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:50:47.109] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 10:50:47.137] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__8__locals1_dto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__8__locals1_dto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:50:47.312] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p7='?' (DbType = Guid), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CartItems] ([CartId], [CreatedAt], [DishId], [Notes], [Quantity], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Carts] SET [UpdatedAt] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-23 10:50:47.351] [INF] [RestaurantAPI.Controllers.CartController] Товар "c14b7bc6-a42f-4aa6-821e-694beb05a2eb" добавлен в корзину пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 10:50:47.375] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 10:50:47.395] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 10:50:47.404] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi) in 355.9627ms
[2025-12-23 10:50:47.406] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 10:50:47.410] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Cart/items - 200 null application/json; charset=utf-8 387.5653ms
[2025-12-23 10:50:50.148] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Cart/items - application/json 75
[2025-12-23 10:50:50.157] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:50.162] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 10:50:50.168] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "AddItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] AddItem(RestaurantAPI.DTOs.CartItemAddDto) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:50:50.187] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 10:50:50.203] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__8__locals1_dto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__8__locals1_dto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:50:50.221] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p7='?' (DbType = Guid), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CartItems] ([CartId], [CreatedAt], [DishId], [Notes], [Quantity], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Carts] SET [UpdatedAt] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-23 10:50:50.233] [INF] [RestaurantAPI.Controllers.CartController] Товар "506c83ad-20ac-42f9-a32e-16f2701bad37" добавлен в корзину пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 10:50:50.240] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 10:50:50.255] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 10:50:50.263] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi) in 88.6281ms
[2025-12-23 10:50:50.265] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 10:50:50.271] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Cart/items - 200 null application/json; charset=utf-8 123.3112ms
[2025-12-23 10:50:52.009] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/DishIngredients?dishId=0ca719ed-5bb4-4e18-a5f2-85f0957cb01c&pageSize=1000 - null null
[2025-12-23 10:50:52.014] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:52.016] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/DishIngredients?dishId=0ca719ed-5bb4-4e18-a5f2-85f0957cb01c&pageSize=1000 - 204 null null 6.5031ms
[2025-12-23 10:50:52.019] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/DishIngredients?dishId=0ca719ed-5bb4-4e18-a5f2-85f0957cb01c&pageSize=1000 - null null
[2025-12-23 10:50:52.038] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:50:52.043] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishIngredientsController.GetDishIngredients (RestaurantApi)'
[2025-12-23 10:50:52.054] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishIngredients", controller = "DishIngredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetDishIngredients(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishIngredientsController (RestaurantApi).
[2025-12-23 10:50:52.109] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (22ms) [Parameters=[@__dishId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [DishIngredients] AS [d]
INNER JOIN [Dishes] AS [d0] ON [d].[DishId] = [d0].[Id]
WHERE [d].[IsDeleted] = CAST(0 AS bit) AND [d].[DishId] = @__dishId_Value_0
[2025-12-23 10:50:52.147] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__dishId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[DishId], [s].[Name] AS [DishName], [s].[IngredientId], [i].[Name] AS [IngredientName], [s].[Quantity]
FROM (
    SELECT [d].[Id], [d].[DishId], [d].[IngredientId], [d].[Quantity], [d0].[Name]
    FROM [DishIngredients] AS [d]
    INNER JOIN [Dishes] AS [d0] ON [d].[DishId] = [d0].[Id]
    WHERE [d].[IsDeleted] = CAST(0 AS bit) AND [d].[DishId] = @__dishId_Value_0
    ORDER BY [d0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Ingredients] AS [i] ON [s].[IngredientId] = [i].[Id]
ORDER BY [s].[Name]
[2025-12-23 10:50:52.155] [INF] [RestaurantAPI.Controllers.DishIngredientsController] Получен список ингредиентов блюд. Количество: 4, Всего: 4, Страница: 1
[2025-12-23 10:50:52.162] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishIngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:50:52.174] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishIngredientsController.GetDishIngredients (RestaurantApi) in 112.9565ms
[2025-12-23 10:50:52.177] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishIngredientsController.GetDishIngredients (RestaurantApi)'
[2025-12-23 10:50:52.180] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/DishIngredients?dishId=0ca719ed-5bb4-4e18-a5f2-85f0957cb01c&pageSize=1000 - 200 null application/json; charset=utf-8 160.7542ms
[2025-12-23 10:51:01.120] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - null null
[2025-12-23 10:51:01.125] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:01.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - 204 null null 8.4196ms
[2025-12-23 10:51:01.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Cart/items - application/json 105
[2025-12-23 10:51:01.145] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:01.150] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 10:51:01.156] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "AddItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] AddItem(RestaurantAPI.DTOs.CartItemAddDto) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:51:01.165] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 10:51:01.177] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__8__locals1_dto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__8__locals1_dto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:01.193] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p7='?' (DbType = Guid), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CartItems] ([CartId], [CreatedAt], [DishId], [Notes], [Quantity], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Carts] SET [UpdatedAt] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-23 10:51:01.218] [INF] [RestaurantAPI.Controllers.CartController] Товар "0ca719ed-5bb4-4e18-a5f2-85f0957cb01c" добавлен в корзину пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 10:51:01.226] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 10:51:01.239] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 10:51:01.248] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi) in 86.7369ms
[2025-12-23 10:51:01.250] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 10:51:01.255] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Cart/items - 200 null application/json; charset=utf-8 123.9337ms
[2025-12-23 10:51:04.017] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders - null null
[2025-12-23 10:51:04.020] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:04.022] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders - 204 null null 5.5506ms
[2025-12-23 10:51:04.024] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Orders - application/json 330
[2025-12-23 10:51:04.029] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:04.031] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi)'
[2025-12-23 10:51:04.041] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.OrderReadDto]] CreateOrder(RestaurantAPI.DTOs.OrderCreateDto) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 10:51:04.138] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__item_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__item_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.144] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__item_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__item_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.151] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__item_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__item_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.177] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__createDto_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__createDto_UserId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.186] [INF] [RestaurantAPI.Controllers.OrdersController] Создание заказа. UserId: "601d547d-42ee-4d95-abc0-42bf30f4d94b", Notes: null, ItemsCount: 3
[2025-12-23 10:51:04.190] [INF] [RestaurantAPI.Controllers.OrdersController] Создание заказа. Входящая дата: null, Kind: null, Результирующая дата: "2025-12-23T07:51:04.1902472Z", Year: 2025
[2025-12-23 10:51:04.326] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 100), @p2='?' (DbType = DateTime), @p3='?' (Size = 100), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (Size = 50), @p7='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = DateTime), @p9='?' (Size = 100), @p10='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [IsDeleted], [Notes], [Status], [Total], [UpdatedAt], [UpdatedBy], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
[2025-12-23 10:51:04.359] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__itemDto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__itemDto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.364] [INF] [RestaurantAPI.Controllers.OrdersController] Добавление элемента заказа. DishId: "c14b7bc6-a42f-4aa6-821e-694beb05a2eb", Quantity: 1, Notes: null
[2025-12-23 10:51:04.432] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__itemDto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__itemDto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.437] [INF] [RestaurantAPI.Controllers.OrdersController] Добавление элемента заказа. DishId: "506c83ad-20ac-42f9-a32e-16f2701bad37", Quantity: 1, Notes: null
[2025-12-23 10:51:04.442] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__itemDto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__itemDto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:04.447] [INF] [RestaurantAPI.Controllers.OrdersController] Добавление элемента заказа. DishId: "0ca719ed-5bb4-4e18-a5f2-85f0957cb01c", Quantity: 1, Notes: Удалено: Кукуруза
[2025-12-23 10:51:04.532] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (55ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 100), @p2='?' (DbType = DateTime), @p3='?' (Size = 100), @p4='?' (DbType = Guid), @p5='?' (DbType = Boolean), @p6='?' (Size = 4000), @p7='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (Size = 100), @p12='?' (DbType = DateTime), @p13='?' (Size = 100), @p14='?' (DbType = DateTime), @p15='?' (Size = 100), @p16='?' (DbType = Guid), @p17='?' (DbType = Boolean), @p18='?' (Size = 4000), @p19='?' (DbType = Guid), @p20='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p21='?' (DbType = Int32), @p22='?' (DbType = DateTime), @p23='?' (Size = 100), @p24='?' (DbType = DateTime), @p25='?' (Size = 100), @p26='?' (DbType = DateTime), @p27='?' (Size = 100), @p28='?' (DbType = Guid), @p29='?' (DbType = Boolean), @p30='?' (Size = 4000), @p31='?' (DbType = Guid), @p32='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p33='?' (DbType = Int32), @p34='?' (DbType = DateTime), @p35='?' (Size = 100), @p37='?' (DbType = Guid), @p36='?' (Precision = 10) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
MERGE [OrderItems] USING (
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, 0),
(@p12, @p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, 1),
(@p24, @p25, @p26, @p27, @p28, @p29, @p30, @p31, @p32, @p33, @p34, @p35, 2)) AS i ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [DishId], [IsDeleted], [Notes], [OrderId], [Price], [Quantity], [UpdatedAt], [UpdatedBy], _Position) ON 1=0
WHEN NOT MATCHED THEN
INSERT ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [DishId], [IsDeleted], [Notes], [OrderId], [Price], [Quantity], [UpdatedAt], [UpdatedBy])
VALUES (i.[CreatedAt], i.[CreatedBy], i.[DeletedAt], i.[DeletedBy], i.[DishId], i.[IsDeleted], i.[Notes], i.[OrderId], i.[Price], i.[Quantity], i.[UpdatedAt], i.[UpdatedBy])
OUTPUT INSERTED.[Id], i._Position;
UPDATE [Orders] SET [Total] = @p36
OUTPUT 1
WHERE [Id] = @p37;
[2025-12-23 10:51:04.547] [INF] [RestaurantAPI.Controllers.OrdersController] Заказ "54d55593-34b9-4261-8e98-64145658dd4d" создан пользователем "601d547d-42ee-4d95-abc0-42bf30f4d94b". Сумма: 2020.00, Блюд: 3
[2025-12-23 10:51:04.559] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing CreatedAtActionResult, writing value of type 'RestaurantAPI.DTOs.OrderReadDto'.
[2025-12-23 10:51:04.605] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi) in 559.9685ms
[2025-12-23 10:51:04.608] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi)'
[2025-12-23 10:51:04.611] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Orders - 201 null application/json; charset=utf-8 586.3065ms
[2025-12-23 10:51:04.617] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 10:51:04.620] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:04.621] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 4.3635ms
[2025-12-23 10:51:04.624] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 DELETE https://localhost:7188/api/Cart - null null
[2025-12-23 10:51:04.632] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:04.634] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi)'
[2025-12-23 10:51:04.642] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] ClearCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:51:04.653] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 10:51:04.680] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = Guid), @p2='?' (DbType = Guid), @p4='?' (DbType = Guid), @p3='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p1;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p2;
UPDATE [Carts] SET [UpdatedAt] = @p3
OUTPUT 1
WHERE [Id] = @p4;
[2025-12-23 10:51:04.694] [INF] [RestaurantAPI.Controllers.CartController] Корзина пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b" очищена
[2025-12-23 10:51:04.703] [INF] [Microsoft.AspNetCore.Mvc.StatusCodeResult] Executing StatusCodeResult, setting HTTP status code 204
[2025-12-23 10:51:04.706] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi) in 60.0133ms
[2025-12-23 10:51:04.708] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi)'
[2025-12-23 10:51:04.709] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 DELETE https://localhost:7188/api/Cart - 204 null null 85.7801ms
[2025-12-23 10:51:09.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 10:51:09.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:09.640] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.644] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.644] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 13.4659ms
[2025-12-23 10:51:09.645] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 14.7308ms
[2025-12-23 10:51:09.648] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 10:51:09.648] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:09.661] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.663] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.665] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:09.666] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:09.673] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:09.676] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:09.713] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.714] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:09.731] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.737] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:09.749] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.749] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.766] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.766] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.818] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 10:51:09.819] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:09.825] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 106960.00, Заказов: 26
[2025-12-23 10:51:09.830] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 10:51:09.834] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:09.836] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:09.848] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 168.6218ms
[2025-12-23 10:51:09.848] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 172.1801ms
[2025-12-23 10:51:09.851] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:09.853] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:09.856] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 208.1752ms
[2025-12-23 10:51:09.858] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 210.0029ms
[2025-12-23 10:51:09.866] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:09.866] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:09.873] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.877] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.879] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 13.6772ms
[2025-12-23 10:51:09.881] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 15.3362ms
[2025-12-23 10:51:09.882] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:09.884] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:09.896] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.900] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:09.902] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:09.904] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:09.906] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:09.913] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:09.914] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:09.924] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:09.929] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 10:51:09.930] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.941] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:09.950] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:09.950] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:09.954] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 68400.00, Заказов: 23
[2025-12-23 10:51:09.960] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:09.963] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:09.965] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 54.9444ms
[2025-12-23 10:51:09.975] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:09.978] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 93.8214ms
[2025-12-23 10:51:09.978] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 61.1186ms
[2025-12-23 10:51:09.986] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:09.988] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 106.1483ms
[2025-12-23 10:51:09.992] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:09.993] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:09.996] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.017] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 24.7821ms
[2025-12-23 10:51:10.000] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.021] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:10.028] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:10.034] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.036] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.038] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:10.044] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.045] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.052] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 10:51:10.058] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.064] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.069] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:10.073] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:10.079] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:10.081] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 30.2333ms
[2025-12-23 10:51:10.087] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:10.087] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:10.093] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 10:51:10.094] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 73.5242ms
[2025-12-23 10:51:10.096] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:10.107] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 66.5297ms
[2025-12-23 10:51:10.109] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:10.112] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 118.331ms
[2025-12-23 10:51:10.119] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 10:51:10.119] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 10:51:10.122] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.127] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 204 null null 10.5691ms
[2025-12-23 10:51:10.131] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 11.7567ms
[2025-12-23 10:51:10.134] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 10:51:10.134] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 10:51:10.148] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.153] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.154] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:10.156] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:10.159] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.161] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.188] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.189] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.194] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.199] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.203] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:10.206] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:10.210] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:10.214] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:10.220] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:10.223] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:10.227] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 7780.00, Заказов: 3
[2025-12-23 10:51:10.231] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 10:51:10.236] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:10.238] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:10.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 73.0828ms
[2025-12-23 10:51:10.245] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 79.0285ms
[2025-12-23 10:51:10.247] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:10.249] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:10.251] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 200 null application/json; charset=utf-8 117.4593ms
[2025-12-23 10:51:10.254] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 119.9815ms
[2025-12-23 10:51:10.261] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 10:51:10.268] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.269] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 8.7707ms
[2025-12-23 10:51:10.273] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 10:51:10.282] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.285] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 10:51:10.295] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.377] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (33ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 10:51:10.385] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 10:51:10.388] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:10.397] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 98.2733ms
[2025-12-23 10:51:10.399] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 10:51:10.401] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 128.587ms
[2025-12-23 10:51:10.408] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 10:51:10.414] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 8.4215ms
[2025-12-23 10:51:10.419] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 10:51:10.427] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.430] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 10:51:10.441] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.501] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 10:51:10.509] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:10.518] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 72.944ms
[2025-12-23 10:51:10.521] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 10:51:10.523] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 104.2991ms
[2025-12-23 10:51:10.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:10.557] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.559] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 5.0662ms
[2025-12-23 10:51:10.561] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:10.568] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.570] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:10.574] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.581] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 10:51:10.587] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.593] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:10.598] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.2571ms
[2025-12-23 10:51:10.600] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:10.603] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 41.6499ms
[2025-12-23 10:51:10.611] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:10.615] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.617] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 6.5986ms
[2025-12-23 10:51:10.620] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:10.632] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:10.635] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:10.638] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:10.644] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 10:51:10.649] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:10.653] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:10.656] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.4264ms
[2025-12-23 10:51:10.659] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:10.662] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 41.7376ms
[2025-12-23 10:51:14.676] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:14.677] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 10:51:14.678] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 10:51:14.687] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:14.692] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:14.698] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:14.700] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 23.6579ms
[2025-12-23 10:51:14.701] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 24.6423ms
[2025-12-23 10:51:14.702] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:14.703] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 24.8413ms
[2025-12-23 10:51:14.706] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 10:51:14.709] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 10:51:14.720] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:14.736] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:14.747] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:14.744] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:14.747] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:14.748] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 10:51:14.750] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 10:51:14.751] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 10:51:14.757] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:14.763] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 10:51:14.763] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:14.770] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 10:51:14.776] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:14.779] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 10:51:14.781] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:14.781] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:14.784] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:14.790] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:14.791] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 37.9521ms
[2025-12-23 10:51:14.794] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 34.6087ms
[2025-12-23 10:51:14.796] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:14.798] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:14.799] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 96.7504ms
[2025-12-23 10:51:14.801] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 94.7736ms
[2025-12-23 10:51:14.806] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:14.850] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 10:51:14.852] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:14.859] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 91.4018ms
[2025-12-23 10:51:14.861] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 10:51:14.863] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 154.891ms
[2025-12-23 10:51:15.568] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 10:51:15.568] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:15.573] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.577] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.578] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 9.6609ms
[2025-12-23 10:51:15.579] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 10.5495ms
[2025-12-23 10:51:15.581] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 10:51:15.581] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:15.597] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.608] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.609] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.610] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.611] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.613] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.622] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.627] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.630] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.634] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.638] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.644] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.647] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.651] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.655] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 10:51:15.658] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:15.661] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 106960.00, Заказов: 26
[2025-12-23 10:51:15.666] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 10:51:15.669] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:15.672] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:15.675] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 56.1249ms
[2025-12-23 10:51:15.678] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 55.0131ms
[2025-12-23 10:51:15.680] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.683] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.685] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 104.2585ms
[2025-12-23 10:51:15.687] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 105.976ms
[2025-12-23 10:51:15.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:15.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:15.707] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.715] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.717] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 18.0229ms
[2025-12-23 10:51:15.719] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 19.7533ms
[2025-12-23 10:51:15.720] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:15.722] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:15.738] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.744] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.757] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.757] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:15.761] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.763] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.769] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.774] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 10:51:15.776] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.781] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.781] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.786] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:15.789] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.791] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 19.2627ms
[2025-12-23 10:51:15.795] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:15.796] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:15.798] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 77.7852ms
[2025-12-23 10:51:15.803] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 68400.00, Заказов: 23
[2025-12-23 10:51:15.809] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:15.812] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.2329ms
[2025-12-23 10:51:15.814] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.815] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 93.2878ms
[2025-12-23 10:51:15.820] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:15.821] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:15.829] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.837] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.839] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 18.9287ms
[2025-12-23 10:51:15.841] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.841] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 10:51:15.852] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.858] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.863] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:15.864] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.866] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.874] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.878] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 10:51:15.883] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.887] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.890] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.894] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:15.900] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:15.902] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 26.0715ms
[2025-12-23 10:51:15.905] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 10:51:15.907] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:15.911] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:15.914] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 72.2847ms
[2025-12-23 10:51:15.916] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 54.4868ms
[2025-12-23 10:51:15.922] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.925] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 104.1936ms
[2025-12-23 10:51:15.932] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 10:51:15.932] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 10:51:15.939] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.945] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.947] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 204 null null 15.1214ms
[2025-12-23 10:51:15.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 15.9744ms
[2025-12-23 10:51:15.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 10:51:15.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 10:51:15.961] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.966] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:15.968] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.970] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:15.972] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.974] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:15.981] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.984] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.987] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.990] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:15.994] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:15.997] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:16.003] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:16.008] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:16.012] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:16.017] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 10:51:16.021] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 7780.00, Заказов: 3
[2025-12-23 10:51:16.025] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 10:51:16.027] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:16.029] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 10:51:16.032] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 54.589ms
[2025-12-23 10:51:16.035] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 53.8448ms
[2025-12-23 10:51:16.037] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:16.039] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 10:51:16.041] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 200 null application/json; charset=utf-8 91.6359ms
[2025-12-23 10:51:16.043] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 92.7705ms
[2025-12-23 10:51:16.048] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 10:51:16.057] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.060] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 11.9307ms
[2025-12-23 10:51:16.063] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 10:51:16.075] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.078] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 10:51:16.080] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:16.094] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 10:51:16.099] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 10:51:16.102] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:16.106] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 21.5621ms
[2025-12-23 10:51:16.108] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 10:51:16.111] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 47.5868ms
[2025-12-23 10:51:16.116] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 10:51:16.121] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.124] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 7.4148ms
[2025-12-23 10:51:16.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 10:51:16.135] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.137] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 10:51:16.140] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:16.153] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 10:51:16.159] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:16.164] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 17.5271ms
[2025-12-23 10:51:16.166] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 10:51:16.169] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 42.5775ms
[2025-12-23 10:51:16.175] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:16.183] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.186] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 11.1499ms
[2025-12-23 10:51:16.189] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:16.200] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.203] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:16.205] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:16.211] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 10:51:16.215] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:16.220] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:16.223] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.1038ms
[2025-12-23 10:51:16.224] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:16.226] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 37.2645ms
[2025-12-23 10:51:16.232] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:16.238] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.241] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 8.3829ms
[2025-12-23 10:51:16.243] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 10:51:16.253] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:16.256] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:16.259] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 10:51:16.266] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 10:51:16.272] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 10:51:16.278] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:16.281] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.5972ms
[2025-12-23 10:51:16.289] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 10:51:16.292] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 48.7163ms
[2025-12-23 10:51:20.271] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:20.271] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 10:51:20.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 10:51:20.275] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:20.276] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:20.280] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:20.282] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 11.0575ms
[2025-12-23 10:51:20.283] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 11.5155ms
[2025-12-23 10:51:20.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 11.6753ms
[2025-12-23 10:51:20.285] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:20.287] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 10:51:20.287] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 10:51:20.301] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:20.304] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:20.308] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:20.309] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:20.310] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:20.311] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 10:51:20.313] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 10:51:20.314] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 10:51:20.315] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 10:51:20.324] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:20.325] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:20.327] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:20.331] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 10:51:20.335] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:20.339] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:20.343] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 10:51:20.347] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:20.352] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 10:51:20.356] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:20.359] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:20.362] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:20.365] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 46.1052ms
[2025-12-23 10:51:20.368] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 46.25ms
[2025-12-23 10:51:20.370] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 44.6966ms
[2025-12-23 10:51:20.372] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:20.375] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:20.378] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 10:51:20.381] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 96.2277ms
[2025-12-23 10:51:20.383] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 96.1243ms
[2025-12-23 10:51:20.384] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 97.1221ms
[2025-12-23 10:51:25.256] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 10:51:25.259] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:25.260] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=1000 - 204 null null 3.7808ms
[2025-12-23 10:51:25.276] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 10:51:25.280] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:25.282] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:51:25.283] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 10:51:25.293] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:25.307] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:25.311] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 10:51:25.313] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:25.316] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 29.2496ms
[2025-12-23 10:51:25.319] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:51:25.321] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - 200 null application/json; charset=utf-8 45.011ms
[2025-12-23 10:51:25.906] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 10:51:25.910] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:25.911] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 5.2688ms
[2025-12-23 10:51:25.913] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 10:51:25.920] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:25.922] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 10:51:25.924] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 10:51:25.931] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:25.937] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:25.941] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 10:51:25.944] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:25.946] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 17.7635ms
[2025-12-23 10:51:25.948] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 10:51:25.950] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 36.4395ms
[2025-12-23 10:51:26.426] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=1000 - null null
[2025-12-23 10:51:26.430] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:26.431] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=1000 - 204 null null 4.74ms
[2025-12-23 10:51:26.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=1000 - null null
[2025-12-23 10:51:26.453] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:26.455] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:26.458] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 10:51:26.466] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:26.474] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:26.480] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:26.483] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:26.486] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 22.0586ms
[2025-12-23 10:51:26.488] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:26.492] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=1000 - 200 null application/json; charset=utf-8 43.6634ms
[2025-12-23 10:51:26.855] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 10:51:26.859] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:26.861] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:51:26.863] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 10:51:26.868] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:26.875] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:26.880] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 10:51:26.883] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:26.885] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 19.5847ms
[2025-12-23 10:51:26.887] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:51:26.890] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - 200 null application/json; charset=utf-8 34.6414ms
[2025-12-23 10:51:27.864] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 10:51:27.866] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Roles - null null
[2025-12-23 10:51:27.870] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:27.873] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:27.874] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 9.7639ms
[2025-12-23 10:51:27.874] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Roles - 204 null null 8.3067ms
[2025-12-23 10:51:27.877] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Roles - null null
[2025-12-23 10:51:27.877] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 10:51:27.886] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:27.890] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:27.891] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 10:51:27.891] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 10:51:27.897] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRoles", controller = "Roles"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.RoleReadDto]]] GetRoles(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.RolesController (RestaurantApi).
[2025-12-23 10:51:27.901] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 10:51:27.914] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:27.932] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:27.944] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 10:51:27.956] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:27.960] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:27.960] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
ORDER BY [r].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:27.968] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 63.916ms
[2025-12-23 10:51:27.970] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 10:51:27.972] [INF] [RestaurantAPI.Controllers.RolesController] Получен список ролей. Количество: 3, Всего: 3, Страница: 1
[2025-12-23 10:51:27.972] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 95.3712ms
[2025-12-23 10:51:27.975] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.RoleReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:27.982] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi) in 82.2068ms
[2025-12-23 10:51:27.984] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 10:51:27.985] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Roles - 200 null application/json; charset=utf-8 108.475ms
[2025-12-23 10:51:28.711] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 10:51:28.727] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:28.729] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 10:51:28.731] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 10:51:28.740] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:28.745] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 10:51:28.749] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:28.752] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:28.756] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 20.9352ms
[2025-12-23 10:51:28.759] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 10:51:28.761] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 49.7369ms
[2025-12-23 10:51:28.764] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:28.775] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:28.779] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 14.933ms
[2025-12-23 10:51:28.781] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:28.792] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:28.794] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:28.796] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 10:51:28.802] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:28.807] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 10:51:28.812] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 10:51:28.815] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:28.818] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 17.7836ms
[2025-12-23 10:51:28.821] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:28.823] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 42.6653ms
[2025-12-23 10:51:28.828] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 10:51:28.833] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:28.836] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 8.4005ms
[2025-12-23 10:51:28.839] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 10:51:28.844] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:28.846] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 10:51:28.859] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 10:51:28.875] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:28.901] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 10:51:28.916] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 26, Страница: 1
[2025-12-23 10:51:28.919] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:28.926] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 64.3158ms
[2025-12-23 10:51:28.930] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 10:51:28.934] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 94.6828ms
[2025-12-23 10:51:31.207] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 10:51:31.209] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Roles - null null
[2025-12-23 10:51:31.211] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:31.214] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:31.215] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 10:51:31.215] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 10:51:31.218] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 10:51:31.219] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRoles", controller = "Roles"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.RoleReadDto]]] GetRoles(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.RolesController (RestaurantApi).
[2025-12-23 10:51:31.223] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:31.226] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:31.229] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 10:51:31.232] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
ORDER BY [r].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:31.234] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:31.236] [INF] [RestaurantAPI.Controllers.RolesController] Получен список ролей. Количество: 3, Всего: 3, Страница: 1
[2025-12-23 10:51:31.237] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:31.239] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.RoleReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:31.242] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 21.2523ms
[2025-12-23 10:51:31.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi) in 19.2797ms
[2025-12-23 10:51:31.245] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 10:51:31.247] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 10:51:31.250] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Roles - 200 null application/json; charset=utf-8 40.1413ms
[2025-12-23 10:51:31.248] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 40.3061ms
[2025-12-23 10:51:55.609] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - null null
[2025-12-23 10:51:55.612] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:55.616] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - 204 null null 6.248ms
[2025-12-23 10:51:55.618] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Auth/login - application/json 44
[2025-12-23 10:51:55.633] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:55.637] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 10:51:55.643] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.AuthResponseDto]] Login(RestaurantAPI.DTOs.UserLoginDto) on controller RestaurantAPI.Controllers.AuthController (RestaurantApi).
[2025-12-23 10:51:55.664] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__dto_Username_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Users] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[Username] = @__dto_Username_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:56.325] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [JwtTokens] ([CreatedAt], [ExpiresAt], [Revoked], [RevokedAt], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
[2025-12-23 10:51:56.334] [INF] [RestaurantAPI.Controllers.AuthController] Пользователь admin успешно вошел в систему
[2025-12-23 10:51:56.341] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'RestaurantAPI.DTOs.AuthResponseDto'.
[2025-12-23 10:51:56.349] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.AuthController.Login (RestaurantApi) in 701.0074ms
[2025-12-23 10:51:56.353] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 10:51:56.361] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Auth/login - 200 null application/json; charset=utf-8 742.9054ms
[2025-12-23 10:51:56.370] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 10:51:56.377] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:56.381] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 11.5617ms
[2025-12-23 10:51:56.384] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 10:51:56.398] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:56.401] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 10:51:56.405] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 10:51:56.433] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (18ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 10:51:56.440] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 10:51:56.444] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 31.266ms
[2025-12-23 10:51:56.446] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 10:51:56.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 65.8186ms
[2025-12-23 10:51:59.001] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 10:51:59.016] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 10:51:59.016] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:59.028] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.033] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.036] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.037] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - 204 null null 36.6277ms
[2025-12-23 10:51:59.038] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - 204 null null 22.2299ms
[2025-12-23 10:51:59.039] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 22.4558ms
[2025-12-23 10:51:59.042] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 10:51:59.042] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 10:51:59.042] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 10:51:59.070] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.081] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.087] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.089] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:51:59.091] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:59.092] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:59.099] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 10:51:59.097] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 10:51:59.095] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 10:51:59.106] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:59.109] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:59.112] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 10:51:59.118] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 10:51:59.121] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:59.122] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 10:51:59.123] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 10:51:59.127] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 10:51:59.132] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 10:51:59.134] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:59.136] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:59.138] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:59.141] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 39.0725ms
[2025-12-23 10:51:59.143] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 34.7792ms
[2025-12-23 10:51:59.144] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 39.1375ms
[2025-12-23 10:51:59.146] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 10:51:59.148] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 10:51:59.149] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 10:51:59.151] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 108.6087ms
[2025-12-23 10:51:59.153] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - 200 null application/json; charset=utf-8 111.0114ms
[2025-12-23 10:51:59.154] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - 200 null application/json; charset=utf-8 112.1377ms
[2025-12-23 10:51:59.157] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 10:51:59.171] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.172] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 204 null null 14.6636ms
[2025-12-23 10:51:59.180] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 10:51:59.185] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 10:51:59.188] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 10:51:59.193] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 10:51:59.210] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 10:51:59.225] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 10:51:59.228] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 10:51:59.230] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 10:51:59.233] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 32.7131ms
[2025-12-23 10:51:59.236] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 10:51:59.237] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 57.3156ms
[2025-12-23 11:01:04.369] [INF] [] Запуск приложения Restaurant API
[2025-12-23 11:01:04.751] [INF] [] Приложение Restaurant API успешно запущено
[2025-12-23 11:01:04.788] [INF] [Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager] User profile is available. Using 'C:\Users\motya\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-12-23 11:01:04.986] [INF] [Microsoft.Hosting.Lifetime] Now listening on: https://localhost:7188
[2025-12-23 11:01:05.045] [INF] [Microsoft.Hosting.Lifetime] Now listening on: http://localhost:5143
[2025-12-23 11:01:05.198] [INF] [Microsoft.Hosting.Lifetime] Application started. Press Ctrl+C to shut down.
[2025-12-23 11:01:05.200] [INF] [Microsoft.Hosting.Lifetime] Hosting environment: Development
[2025-12-23 11:01:05.202] [INF] [Microsoft.Hosting.Lifetime] Content root path: D:\restaurant-project\RestaurantAPI\RestaurantApi
[2025-12-23 11:01:06.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/index.html - null null
[2025-12-23 11:01:08.635] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/index.html - 200 null text/html;charset=utf-8 2297.4183ms
[2025-12-23 11:01:08.647] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - null null
[2025-12-23 11:01:08.657] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/_vs/browserLink - null null
[2025-12-23 11:01:09.626] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_framework/aspnetcore-browser-refresh.js - 200 16511 application/javascript; charset=utf-8 979.4501ms
[2025-12-23 11:01:10.108] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/_vs/browserLink - 200 null text/javascript; charset=UTF-8 1451.027ms
[2025-12-23 11:01:10.581] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - null null
[2025-12-23 11:01:10.734] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 152.2433ms
[2025-12-23 11:01:11.454] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:01:11.455] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 11:01:11.455] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 11:01:11.489] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:11.498] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:11.515] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:11.578] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:01:11.579] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:01:11.579] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:01:11.708] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 11:01:11.708] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:01:11.710] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:01:15.763] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:15.763] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:15.763] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:16.030] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:01:16.030] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:01:16.030] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (46ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:01:16.216] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:01:16.217] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 11:01:16.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:16.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:16.257] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:01:16.264] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:16.279] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 4559.7403ms
[2025-12-23 11:01:16.279] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 4512.4932ms
[2025-12-23 11:01:16.283] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:01:16.286] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:01:16.287] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 4567.3266ms
[2025-12-23 11:01:16.293] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:01:16.296] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 11:01:16.300] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 4846.0183ms
[2025-12-23 11:01:16.300] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - 200 null application/json; charset=utf-8 4845.3118ms
[2025-12-23 11:01:16.300] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - 200 null application/json; charset=utf-8 4845.6953ms
[2025-12-23 11:01:16.302] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:16.332] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:01:16.348] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 11:01:16.578] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 11:01:16.629] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 11:01:16.638] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 11:01:16.644] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:16.657] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 302.5299ms
[2025-12-23 11:01:16.660] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:01:16.663] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 367.6ms
[2025-12-23 11:01:19.898] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - null null
[2025-12-23 11:01:19.903] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:19.909] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - 204 null null 10.7771ms
[2025-12-23 11:01:19.913] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Auth/login - application/json 44
[2025-12-23 11:01:19.929] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:19.933] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 11:01:19.950] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.AuthResponseDto]] Login(RestaurantAPI.DTOs.UserLoginDto) on controller RestaurantAPI.Controllers.AuthController (RestaurantApi).
[2025-12-23 11:01:20.113] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (23ms) [Parameters=[@__dto_Username_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Users] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[Username] = @__dto_Username_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:22.206] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (51ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [JwtTokens] ([CreatedAt], [ExpiresAt], [Revoked], [RevokedAt], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
[2025-12-23 11:01:22.315] [INF] [RestaurantAPI.Controllers.AuthController] Пользователь admin успешно вошел в систему
[2025-12-23 11:01:22.319] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'RestaurantAPI.DTOs.AuthResponseDto'.
[2025-12-23 11:01:22.337] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.AuthController.Login (RestaurantApi) in 2382.5328ms
[2025-12-23 11:01:22.344] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 11:01:22.346] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Auth/login - 200 null application/json; charset=utf-8 2432.5169ms
[2025-12-23 11:01:22.358] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 11:01:22.363] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:22.368] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 9.734ms
[2025-12-23 11:01:22.372] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 11:01:22.381] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:22.454] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - null null
[2025-12-23 11:01:22.466] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 11:01:22.468] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:22.472] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - 204 null null 17.5524ms
[2025-12-23 11:01:22.474] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:01:22.476] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Cart/items - application/json 75
[2025-12-23 11:01:22.491] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:22.500] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 11:01:22.513] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "AddItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] AddItem(RestaurantAPI.DTOs.CartItemAddDto) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:01:22.636] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 11:01:22.646] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (31ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 11:01:22.693] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 11:01:22.700] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__8__locals1_dto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__8__locals1_dto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:22.706] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 221.1665ms
[2025-12-23 11:01:22.709] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 11:01:22.712] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 340.1949ms
[2025-12-23 11:01:22.912] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p7='?' (DbType = Guid), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CartItems] ([CartId], [CreatedAt], [DishId], [Notes], [Quantity], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Carts] SET [UpdatedAt] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-23 11:01:22.978] [INF] [RestaurantAPI.Controllers.CartController] Товар "506c83ad-20ac-42f9-a32e-16f2701bad37" добавлен в корзину пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 11:01:23.011] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (20ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 11:01:23.032] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 11:01:23.039] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi) in 521.0044ms
[2025-12-23 11:01:23.042] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 11:01:23.045] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Cart/items - 200 null application/json; charset=utf-8 569.9085ms
[2025-12-23 11:01:26.024] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart/items/127590ac-74fb-425b-b21b-c70b6bb138d8 - null null
[2025-12-23 11:01:26.028] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:26.031] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart/items/127590ac-74fb-425b-b21b-c70b6bb138d8 - 204 null null 7.1575ms
[2025-12-23 11:01:26.034] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 DELETE https://localhost:7188/api/Cart/items/127590ac-74fb-425b-b21b-c70b6bb138d8 - null null
[2025-12-23 11:01:26.043] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:26.048] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.RemoveItem (RestaurantApi)'
[2025-12-23 11:01:26.056] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "RemoveItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] RemoveItem(System.Guid) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:01:26.079] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 11:01:26.127] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Guid), @p2='?' (DbType = Guid), @p1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
UPDATE [Carts] SET [UpdatedAt] = @p1
OUTPUT 1
WHERE [Id] = @p2;
[2025-12-23 11:01:26.146] [INF] [RestaurantAPI.Controllers.CartController] Элемент корзины "127590ac-74fb-425b-b21b-c70b6bb138d8" удален пользователем "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 11:01:26.177] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (25ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 11:01:26.185] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 11:01:26.190] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.RemoveItem (RestaurantApi) in 129.8763ms
[2025-12-23 11:01:26.193] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.RemoveItem (RestaurantApi)'
[2025-12-23 11:01:26.197] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 DELETE https://localhost:7188/api/Cart/items/127590ac-74fb-425b-b21b-c70b6bb138d8 - 200 null application/json; charset=utf-8 162.7006ms
[2025-12-23 11:01:29.679] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 11:01:29.679] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 11:01:29.680] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:01:29.685] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:29.690] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:29.695] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:29.697] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:01:29.698] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:01:29.699] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:01:29.701] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 11:01:29.704] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:01:29.707] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:01:29.719] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:29.722] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:29.726] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:29.731] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:01:29.735] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:01:29.737] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 11:01:29.742] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:01:29.743] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:01:29.744] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:29.748] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:29.754] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 46.1376ms
[2025-12-23 11:01:29.755] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:01:29.756] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 42.2688ms
[2025-12-23 11:01:29.758] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:01:29.762] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:29.766] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:01:29.773] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 11:01:29.769] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - 200 null application/json; charset=utf-8 90.2544ms
[2025-12-23 11:01:29.771] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 53.7178ms
[2025-12-23 11:01:29.773] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - 200 null application/json; charset=utf-8 93.355ms
[2025-12-23 11:01:29.780] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:29.792] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:01:29.800] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:01:29.802] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 122.2519ms
[2025-12-23 11:01:29.804] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 11:01:29.827] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 11:01:29.844] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 11:01:29.847] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 11:01:29.850] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:29.853] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 37.4617ms
[2025-12-23 11:01:29.854] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:01:29.856] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 83.6524ms
[2025-12-23 11:01:31.058] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/DishIngredients?dishId=e95fdeb0-af57-44bd-91ab-29e79dbad536&pageSize=1000 - null null
[2025-12-23 11:01:31.061] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:31.063] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishIngredientsController.GetDishIngredients (RestaurantApi)'
[2025-12-23 11:01:31.074] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishIngredients", controller = "DishIngredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetDishIngredients(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishIngredientsController (RestaurantApi).
[2025-12-23 11:01:31.130] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (24ms) [Parameters=[@__dishId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [DishIngredients] AS [d]
INNER JOIN [Dishes] AS [d0] ON [d].[DishId] = [d0].[Id]
WHERE [d].[IsDeleted] = CAST(0 AS bit) AND [d].[DishId] = @__dishId_Value_0
[2025-12-23 11:01:31.171] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__dishId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[DishId], [s].[Name] AS [DishName], [s].[IngredientId], [i].[Name] AS [IngredientName], [s].[Quantity]
FROM (
    SELECT [d].[Id], [d].[DishId], [d].[IngredientId], [d].[Quantity], [d0].[Name]
    FROM [DishIngredients] AS [d]
    INNER JOIN [Dishes] AS [d0] ON [d].[DishId] = [d0].[Id]
    WHERE [d].[IsDeleted] = CAST(0 AS bit) AND [d].[DishId] = @__dishId_Value_0
    ORDER BY [d0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Ingredients] AS [i] ON [s].[IngredientId] = [i].[Id]
ORDER BY [s].[Name]
[2025-12-23 11:01:31.185] [INF] [RestaurantAPI.Controllers.DishIngredientsController] Получен список ингредиентов блюд. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:01:31.191] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishIngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:01:31.203] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishIngredientsController.GetDishIngredients (RestaurantApi) in 119.8136ms
[2025-12-23 11:01:31.206] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishIngredientsController.GetDishIngredients (RestaurantApi)'
[2025-12-23 11:01:31.213] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/DishIngredients?dishId=e95fdeb0-af57-44bd-91ab-29e79dbad536&pageSize=1000 - 200 null application/json; charset=utf-8 155.3268ms
[2025-12-23 11:01:34.042] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - null null
[2025-12-23 11:01:34.045] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:34.046] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Auth/login - 204 null null 4.79ms
[2025-12-23 11:01:34.049] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Auth/login - application/json 44
[2025-12-23 11:01:34.057] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:34.060] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 11:01:34.063] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.AuthResponseDto]] Login(RestaurantAPI.DTOs.UserLoginDto) on controller RestaurantAPI.Controllers.AuthController (RestaurantApi).
[2025-12-23 11:01:34.084] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__dto_Username_0='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Users] AS [u]
INNER JOIN [Roles] AS [r] ON [u].[RoleId] = [r].[Id]
WHERE [u].[Username] = @__dto_Username_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:34.696] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (DbType = DateTime), @p2='?' (DbType = Boolean), @p3='?' (DbType = DateTime), @p4='?' (Size = 4000), @p5='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [JwtTokens] ([CreatedAt], [ExpiresAt], [Revoked], [RevokedAt], [Token], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
[2025-12-23 11:01:34.708] [INF] [RestaurantAPI.Controllers.AuthController] Пользователь admin успешно вошел в систему
[2025-12-23 11:01:34.716] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing ObjectResult, writing value of type 'RestaurantAPI.DTOs.AuthResponseDto'.
[2025-12-23 11:01:34.724] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.AuthController.Login (RestaurantApi) in 655.4066ms
[2025-12-23 11:01:34.730] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.AuthController.Login (RestaurantApi)'
[2025-12-23 11:01:34.734] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Auth/login - 200 null application/json; charset=utf-8 685.567ms
[2025-12-23 11:01:34.741] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 11:01:34.745] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:34.750] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 8.7184ms
[2025-12-23 11:01:34.754] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 11:01:34.775] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:34.782] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 11:01:34.785] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:01:34.815] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 11:01:34.828] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 11:01:34.835] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 39.1008ms
[2025-12-23 11:01:34.838] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 11:01:34.839] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - null null
[2025-12-23 11:01:34.841] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 87.097ms
[2025-12-23 11:01:34.844] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:34.858] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart/items - 204 null null 18.729ms
[2025-12-23 11:01:34.860] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Cart/items - application/json 114
[2025-12-23 11:01:34.874] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:01:34.880] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 11:01:34.885] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "AddItem", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] AddItem(RestaurantAPI.DTOs.CartItemAddDto) on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:01:34.905] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 11:01:34.923] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__8__locals1_dto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__8__locals1_dto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:01:34.944] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (DbType = DateTime), @p2='?' (DbType = Guid), @p3='?' (Size = 500), @p4='?' (DbType = Int32), @p5='?' (DbType = DateTime), @p7='?' (DbType = Guid), @p6='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [CartItems] ([CartId], [CreatedAt], [DishId], [Notes], [Quantity], [UpdatedAt])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
UPDATE [Carts] SET [UpdatedAt] = @p6
OUTPUT 1
WHERE [Id] = @p7;
[2025-12-23 11:01:34.966] [INF] [RestaurantAPI.Controllers.CartController] Товар "e95fdeb0-af57-44bd-91ab-29e79dbad536" добавлен в корзину пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b"
[2025-12-23 11:01:34.990] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (18ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 11:01:34.998] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 11:01:35.000] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi) in 105.7887ms
[2025-12-23 11:01:35.002] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.AddItem (RestaurantApi)'
[2025-12-23 11:01:35.010] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Cart/items - 200 null application/json; charset=utf-8 150.1644ms
[2025-12-23 11:02:01.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders - null null
[2025-12-23 11:02:01.013] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:02:01.019] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders - 204 null null 14.4678ms
[2025-12-23 11:02:01.021] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 POST https://localhost:7188/api/Orders - application/json 187
[2025-12-23 11:02:01.032] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:02:01.037] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi)'
[2025-12-23 11:02:01.050] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "CreateOrder", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.OrderReadDto]] CreateOrder(RestaurantAPI.DTOs.OrderCreateDto) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:02:01.134] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__item_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__item_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:02:01.164] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__createDto_UserId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__createDto_UserId_0 AND [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:02:01.179] [INF] [RestaurantAPI.Controllers.OrdersController] Создание заказа. UserId: "601d547d-42ee-4d95-abc0-42bf30f4d94b", Notes: null, ItemsCount: 1
[2025-12-23 11:02:01.187] [INF] [RestaurantAPI.Controllers.OrdersController] Создание заказа. Входящая дата: null, Kind: null, Результирующая дата: "2025-12-23T08:02:01.1878223Z", Year: 2025
[2025-12-23 11:02:01.328] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 100), @p2='?' (DbType = DateTime), @p3='?' (Size = 100), @p4='?' (DbType = Boolean), @p5='?' (Size = 4000), @p6='?' (Size = 50), @p7='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p8='?' (DbType = DateTime), @p9='?' (Size = 100), @p10='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [IsDeleted], [Notes], [Status], [Total], [UpdatedAt], [UpdatedBy], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
[2025-12-23 11:02:01.363] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__itemDto_DishId_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
FROM [Dishes] AS [d]
WHERE [d].[Id] = @__itemDto_DishId_0 AND [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:02:01.376] [INF] [RestaurantAPI.Controllers.OrdersController] Добавление элемента заказа. DishId: "e95fdeb0-af57-44bd-91ab-29e79dbad536", Quantity: 1, Notes: Удалено: Куриное бедро
[2025-12-23 11:02:01.484] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?' (Size = 100), @p2='?' (DbType = DateTime), @p3='?' (Size = 100), @p4='?' (DbType = Guid), @p5='?' (DbType = Boolean), @p6='?' (Size = 4000), @p7='?' (DbType = Guid), @p8='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (Size = 100), @p13='?' (DbType = Guid), @p12='?' (Precision = 10) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([CreatedAt], [CreatedBy], [DeletedAt], [DeletedBy], [DishId], [IsDeleted], [Notes], [OrderId], [Price], [Quantity], [UpdatedAt], [UpdatedBy])
OUTPUT INSERTED.[Id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11);
UPDATE [Orders] SET [Total] = @p12
OUTPUT 1
WHERE [Id] = @p13;
[2025-12-23 11:02:01.501] [INF] [RestaurantAPI.Controllers.OrdersController] Заказ "5f80b2f0-3e9d-4245-ab31-583116278e6b" создан пользователем "601d547d-42ee-4d95-abc0-42bf30f4d94b". Сумма: 890.00, Блюд: 1
[2025-12-23 11:02:01.518] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing CreatedAtActionResult, writing value of type 'RestaurantAPI.DTOs.OrderReadDto'.
[2025-12-23 11:02:01.547] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi) in 486.9082ms
[2025-12-23 11:02:01.550] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.CreateOrder (RestaurantApi)'
[2025-12-23 11:02:01.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 POST https://localhost:7188/api/Orders - 201 null application/json; charset=utf-8 532.6751ms
[2025-12-23 11:02:01.559] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 11:02:01.563] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:02:01.565] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 5.9546ms
[2025-12-23 11:02:01.568] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 DELETE https://localhost:7188/api/Cart - null null
[2025-12-23 11:02:01.579] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:02:01.584] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi)'
[2025-12-23 11:02:01.595] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "ClearCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] ClearCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:02:01.614] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN [CartItems] AS [c0] ON [c1].[Id] = [c0].[CartId]
ORDER BY [c1].[Id]
[2025-12-23 11:02:01.631] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p2='?' (DbType = Guid), @p1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
DELETE FROM [CartItems]
OUTPUT 1
WHERE [Id] = @p0;
UPDATE [Carts] SET [UpdatedAt] = @p1
OUTPUT 1
WHERE [Id] = @p2;
[2025-12-23 11:02:01.639] [INF] [RestaurantAPI.Controllers.CartController] Корзина пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b" очищена
[2025-12-23 11:02:01.649] [INF] [Microsoft.AspNetCore.Mvc.StatusCodeResult] Executing StatusCodeResult, setting HTTP status code 204
[2025-12-23 11:02:01.652] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi) in 51.5811ms
[2025-12-23 11:02:01.656] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.ClearCart (RestaurantApi)'
[2025-12-23 11:02:01.660] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 DELETE https://localhost:7188/api/Cart - 204 null null 91.5879ms
[2025-12-23 11:07:41.870] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:07:41.875] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:41.870] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:07:41.876] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 5.5918ms
[2025-12-23 11:07:41.879] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:07:41.881] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:41.888] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:41.889] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 18.847ms
[2025-12-23 11:07:41.891] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:07:41.892] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:41.900] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:41.911] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:41.911] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:41.916] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.089] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.091] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (28ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.102] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.110] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.116] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.117] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.138] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.138] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.197] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 11:07:42.199] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:07:42.201] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 107850.00, Заказов: 27
[2025-12-23 11:07:42.203] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:07:42.205] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:07:42.207] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:07:42.217] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 302.9246ms
[2025-12-23 11:07:42.217] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 297.6182ms
[2025-12-23 11:07:42.219] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.221] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.222] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 343.5067ms
[2025-12-23 11:07:42.224] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 333.0618ms
[2025-12-23 11:07:42.230] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:42.230] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:42.236] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.239] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 9.3141ms
[2025-12-23 11:07:42.238] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.242] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:42.246] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 16.201ms
[2025-12-23 11:07:42.249] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:42.252] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.259] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.261] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:42.264] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.269] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.275] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.278] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.286] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.291] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.292] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 11:07:42.295] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.302] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:07:42.307] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 69290.00, Заказов: 24
[2025-12-23 11:07:42.309] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:07:42.309] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.311] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 36.8727ms
[2025-12-23 11:07:42.314] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.315] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 66.3176ms
[2025-12-23 11:07:42.322] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:42.328] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 48.5438ms
[2025-12-23 11:07:42.330] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:42.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 89.8586ms
[2025-12-23 11:07:42.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:07:42.336] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:07:42.343] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.346] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.347] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 11.8984ms
[2025-12-23 11:07:42.348] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.349] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:07:42.352] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.355] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.359] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:42.360] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.361] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.366] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.368] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 11:07:42.371] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.374] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.378] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.381] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:42.385] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:07:42.387] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.24ms
[2025-12-23 11:07:42.391] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:07:42.394] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:42.396] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:07:42.398] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 48.9291ms
[2025-12-23 11:07:42.400] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 43.1049ms
[2025-12-23 11:07:42.410] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.411] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 75.4339ms
[2025-12-23 11:07:42.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:07:42.421] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.416] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:07:42.423] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 7.6693ms
[2025-12-23 11:07:42.425] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:07:42.434] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.434] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.435] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.427] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.445] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.445] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 204 null null 29.8174ms
[2025-12-23 11:07:42.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:07:42.453] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.461] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.467] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.467] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.474] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.475] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.482] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:07:42.486] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.489] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 11:07:42.495] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.497] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:07:42.503] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.504] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 62.4782ms
[2025-12-23 11:07:42.509] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:42.510] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.516] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:07:42.518] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 92.9325ms
[2025-12-23 11:07:42.522] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 8670.00, Заказов: 4
[2025-12-23 11:07:42.539] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:07:42.543] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 59.7034ms
[2025-12-23 11:07:42.547] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:07:42.549] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 200 null application/json; charset=utf-8 101.0658ms
[2025-12-23 11:07:42.554] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:07:42.562] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.563] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 9.4658ms
[2025-12-23 11:07:42.566] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:07:42.577] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.579] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:07:42.590] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.679] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (43ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 11:07:42.687] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 11:07:42.689] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:42.699] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 103.779ms
[2025-12-23 11:07:42.702] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:07:42.706] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 140.3427ms
[2025-12-23 11:07:42.711] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:07:42.724] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.726] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 14.6222ms
[2025-12-23 11:07:42.728] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:07:42.742] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.746] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:07:42.759] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.812] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 11:07:42.818] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:42.829] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 65.4323ms
[2025-12-23 11:07:42.833] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:07:42.836] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 107.6096ms
[2025-12-23 11:07:42.867] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:42.875] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.876] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 9.0621ms
[2025-12-23 11:07:42.879] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:42.917] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:07:42.961] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.967] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.969] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:42.969] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 52.6912ms
[2025-12-23 11:07:42.971] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:42.972] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:07:42.980] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 11:07:42.983] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:42.987] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:42.988] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:07:42.992] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:42.996] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.2178ms
[2025-12-23 11:07:42.998] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:42.999] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:07:43.000] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 120.9021ms
[2025-12-23 11:07:43.004] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:43.012] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:43.014] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 10.058ms
[2025-12-23 11:07:43.015] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:43.016] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:07:43.029] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:43.030] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:43.033] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:07:43.038] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 11:07:43.043] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:07:43.048] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:43.052] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.4964ms
[2025-12-23 11:07:43.054] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:07:43.057] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 40.3061ms
[2025-12-23 11:07:43.060] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:07:43.073] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:07:43.075] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:43.086] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 83.3631ms
[2025-12-23 11:07:43.089] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:07:43.091] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 119.2017ms
[2025-12-23 11:07:43.097] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:07:43.102] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:43.104] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 6.753ms
[2025-12-23 11:07:43.106] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:07:43.116] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:43.118] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:07:43.120] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:07:43.127] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:43.138] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:07:43.143] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:07:43.147] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:43.151] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 26.9731ms
[2025-12-23 11:07:43.155] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:07:43.157] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 50.6133ms
[2025-12-23 11:07:43.161] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:07:43.166] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:43.169] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 7.7883ms
[2025-12-23 11:07:43.171] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:07:43.180] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:07:43.183] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:07:43.193] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:07:43.211] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:07:43.244] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:07:43.257] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:07:43.261] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:07:43.270] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 75.5637ms
[2025-12-23 11:07:43.273] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:07:43.276] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 104.6594ms
[2025-12-23 11:09:12.735] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Cart - null null
[2025-12-23 11:09:12.746] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:12.748] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Cart - 204 null null 13.725ms
[2025-12-23 11:09:12.780] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Cart - null null
[2025-12-23 11:09:12.785] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:12.787] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 11:09:12.790] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCart", controller = "Cart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.DTOs.CartReadDto]] GetCart() on controller RestaurantAPI.Controllers.CartController (RestaurantApi).
[2025-12-23 11:09:12.818] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (20ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT [c1].[Id], [c1].[CreatedAt], [c1].[UpdatedAt], [c1].[UserId], [s].[Id], [s].[CartId], [s].[CreatedAt], [s].[DishId], [s].[Notes], [s].[Quantity], [s].[UpdatedAt], [s].[Id0], [s].[CategoryId], [s].[CreatedAt0], [s].[CreatedBy], [s].[DeletedAt], [s].[DeletedBy], [s].[Description], [s].[IsDeleted], [s].[Name], [s].[Notes0], [s].[Price], [s].[UpdatedAt0], [s].[UpdatedBy]
FROM (
    SELECT TOP(1) [c].[Id], [c].[CreatedAt], [c].[UpdatedAt], [c].[UserId]
    FROM [Carts] AS [c]
    WHERE [c].[UserId] = @__userId_Value_0
) AS [c1]
LEFT JOIN (
    SELECT [c0].[Id], [c0].[CartId], [c0].[CreatedAt], [c0].[DishId], [c0].[Notes], [c0].[Quantity], [c0].[UpdatedAt], [d].[Id] AS [Id0], [d].[CategoryId], [d].[CreatedAt] AS [CreatedAt0], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes] AS [Notes0], [d].[Price], [d].[UpdatedAt] AS [UpdatedAt0], [d].[UpdatedBy]
    FROM [CartItems] AS [c0]
    INNER JOIN [Dishes] AS [d] ON [c0].[DishId] = [d].[Id]
) AS [s] ON [c1].[Id] = [s].[CartId]
ORDER BY [c1].[Id], [s].[Id]
[2025-12-23 11:09:12.830] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.DTOs.CartReadDto'.
[2025-12-23 11:09:12.834] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi) in 39.3807ms
[2025-12-23 11:09:12.841] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CartController.GetCart (RestaurantApi)'
[2025-12-23 11:09:12.861] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Cart - 200 null application/json; charset=utf-8 80.7937ms
[2025-12-23 11:09:13.399] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:09:13.634] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:13.689] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 289.4778ms
[2025-12-23 11:09:13.700] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:09:14.029] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:14.034] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:09:14.045] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:09:14.062] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:09:14.092] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:09:14.126] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:09:14.133] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:09:14.139] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 82.5881ms
[2025-12-23 11:09:14.167] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:09:14.212] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 512.0643ms
[2025-12-23 11:09:14.267] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:09:14.298] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:14.324] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 57.8035ms
[2025-12-23 11:09:14.328] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:09:14.358] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:14.383] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:09:14.387] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:09:14.399] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:09:14.412] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:09:14.418] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:09:14.423] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:09:14.426] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 31.8164ms
[2025-12-23 11:09:14.430] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:09:14.432] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 104.3384ms
[2025-12-23 11:09:14.441] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:09:14.448] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:14.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 8.7562ms
[2025-12-23 11:09:14.452] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:09:14.465] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:09:14.467] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:09:14.469] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:09:14.481] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:09:14.504] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:09:14.520] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:09:14.524] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:09:14.531] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 57.1883ms
[2025-12-23 11:09:14.535] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:09:14.538] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 85.3693ms
[2025-12-23 11:14:32.373] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - null null
[2025-12-23 11:14:32.380] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:32.383] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - 204 null null 9.694ms
[2025-12-23 11:14:32.389] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - null null
[2025-12-23 11:14:32.409] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:32.413] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi)'
[2025-12-23 11:14:32.424] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMyOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.OrderReadDto]]] GetMyOrders(Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:14:32.570] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (17ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[UserId] = @__userId_Value_0 AND [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:32.599] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (10ms) [Parameters=[@__userId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[UserId] = @__userId_Value_0 AND [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:14:32.606] [INF] [RestaurantAPI.Controllers.OrdersController] Получены заказы пользователя "601d547d-42ee-4d95-abc0-42bf30f4d94b". Количество: 5, Всего: 5, Страница: 1
[2025-12-23 11:14:32.610] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:32.614] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi) in 184.4117ms
[2025-12-23 11:14:32.617] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetMyOrders (RestaurantApi)'
[2025-12-23 11:14:32.619] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders/MyOrders?page=1&pageSize=100 - 200 null application/json; charset=utf-8 230.4203ms
[2025-12-23 11:14:37.016] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:14:37.019] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:14:37.020] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.027] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.029] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 12.2967ms
[2025-12-23 11:14:37.031] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:14:37.031] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 11.7282ms
[2025-12-23 11:14:37.034] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:14:37.191] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.200] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.202] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.202] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.204] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.206] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.221] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.233] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.244] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.252] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.257] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.260] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.267] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.268] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 11:14:37.273] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.277] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 107850.00, Заказов: 27
[2025-12-23 11:14:37.284] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:14:37.285] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 76.158ms
[2025-12-23 11:14:37.288] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:14:37.289] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.294] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:14:37.296] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 265.2232ms
[2025-12-23 11:14:37.297] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:14:37.310] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 96.9645ms
[2025-12-23 11:14:37.312] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.314] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 280.0755ms
[2025-12-23 11:14:37.320] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.320] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.326] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.331] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 12.3886ms
[2025-12-23 11:14:37.333] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 13.2915ms
[2025-12-23 11:14:37.335] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.336] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.351] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.356] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.359] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.361] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.364] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.365] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.371] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 11:14:37.378] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.383] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.383] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.389] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.393] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:37.399] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.400] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 30.2481ms
[2025-12-23 11:14:37.404] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:14:37.406] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.413] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 78.6522ms
[2025-12-23 11:14:37.411] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 69290.00, Заказов: 24
[2025-12-23 11:14:37.424] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:14:37.426] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 52.797ms
[2025-12-23 11:14:37.428] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.429] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 92.9055ms
[2025-12-23 11:14:37.432] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:14:37.433] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:14:37.438] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.443] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.445] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 13.3916ms
[2025-12-23 11:14:37.448] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:14:37.454] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.460] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.465] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.467] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.468] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.473] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.477] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 11:14:37.481] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.484] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.488] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.491] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:37.497] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:14:37.499] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.1037ms
[2025-12-23 11:14:37.504] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:14:37.506] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.509] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:14:37.511] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 63.1037ms
[2025-12-23 11:14:37.514] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 51.1166ms
[2025-12-23 11:14:37.521] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.524] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 90.9728ms
[2025-12-23 11:14:37.529] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:14:37.530] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:14:37.533] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.537] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.540] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 204 null null 11.5541ms
[2025-12-23 11:14:37.542] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 12.296ms
[2025-12-23 11:14:37.543] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:14:37.544] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:14:37.558] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.562] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.565] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.566] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.567] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.569] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.576] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.580] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.583] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.588] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.591] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.595] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.598] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.603] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:37.607] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:14:37.610] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:14:37.614] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 8670.00, Заказов: 4
[2025-12-23 11:14:37.618] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 11:14:37.619] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:14:37.622] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:14:37.625] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 51.6413ms
[2025-12-23 11:14:37.627] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 50.6219ms
[2025-12-23 11:14:37.629] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.631] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:14:37.633] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 200 null application/json; charset=utf-8 89.8946ms
[2025-12-23 11:14:37.634] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 89.9594ms
[2025-12-23 11:14:37.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:14:37.649] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.651] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 12.0376ms
[2025-12-23 11:14:37.654] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:14:37.662] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.664] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:14:37.667] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.718] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (45ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 11:14:37.724] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 11:14:37.726] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:37.730] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 59.1989ms
[2025-12-23 11:14:37.732] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:14:37.734] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 80.6498ms
[2025-12-23 11:14:37.740] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:14:37.746] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.747] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 6.9025ms
[2025-12-23 11:14:37.750] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:14:37.759] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.762] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:14:37.764] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.791] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 11:14:37.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:37.801] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 33.2263ms
[2025-12-23 11:14:37.803] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:14:37.806] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 56.2593ms
[2025-12-23 11:14:37.811] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.815] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.816] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 5.8185ms
[2025-12-23 11:14:37.819] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.829] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.831] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.834] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.839] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 11:14:37.847] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.851] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:37.853] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.6327ms
[2025-12-23 11:14:37.855] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.857] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 37.8678ms
[2025-12-23 11:14:37.868] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.874] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.877] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 8.5334ms
[2025-12-23 11:14:37.879] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:14:37.886] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:37.889] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.891] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:14:37.898] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 11:14:37.904] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:14:37.909] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:37.911] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 15.3927ms
[2025-12-23 11:14:37.914] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:14:37.915] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 36.4908ms
[2025-12-23 11:14:38.693] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:14:38.697] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:38.698] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 5.2374ms
[2025-12-23 11:14:38.701] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:14:38.708] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:38.710] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:14:38.711] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:14:38.716] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:38.730] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:14:38.733] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:14:38.737] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:38.739] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 25.9129ms
[2025-12-23 11:14:38.741] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:14:38.743] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 42.3722ms
[2025-12-23 11:14:38.746] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:14:38.751] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:38.753] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 6.7901ms
[2025-12-23 11:14:38.755] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:14:38.762] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:38.764] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:14:38.765] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:14:38.771] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:38.783] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:14:38.788] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:14:38.791] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:38.794] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 24.7954ms
[2025-12-23 11:14:38.795] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:14:38.798] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 42.851ms
[2025-12-23 11:14:38.802] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:14:38.804] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:38.804] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 2.6022ms
[2025-12-23 11:14:38.807] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:14:38.815] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:14:38.816] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:14:38.818] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:14:38.823] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:14:38.833] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:14:38.836] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:14:38.837] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:14:38.840] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 18.7393ms
[2025-12-23 11:14:38.841] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:14:38.843] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 36.6294ms
[2025-12-23 11:15:18.825] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:15:18.827] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:15:18.829] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.833] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.834] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 8.5359ms
[2025-12-23 11:15:18.835] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 7.5964ms
[2025-12-23 11:15:18.838] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:15:18.838] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:15:18.848] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.853] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.856] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:18.857] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:18.858] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:18.860] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:18.871] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.874] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:18.876] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.881] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:18.884] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.886] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.895] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.898] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.911] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 11:15:18.914] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 107850.00, Заказов: 27
[2025-12-23 11:15:18.917] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:15:18.918] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:15:18.920] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 56.272ms
[2025-12-23 11:15:18.923] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:15:18.926] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:18.927] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:15:18.929] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 91.0492ms
[2025-12-23 11:15:18.931] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 62.484ms
[2025-12-23 11:15:18.937] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:18.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 101.5849ms
[2025-12-23 11:15:18.945] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:18.945] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:18.948] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.950] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.952] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 6.7829ms
[2025-12-23 11:15:18.951] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 6.3431ms
[2025-12-23 11:15:18.953] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:18.954] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:18.965] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.970] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:18.972] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:18.973] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:18.975] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:18.977] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:18.980] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 11:15:18.984] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:18.989] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:18.989] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:18.994] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:18.996] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:19.001] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.003] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 23.8879ms
[2025-12-23 11:15:19.007] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:15:19.008] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.009] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 69290.00, Заказов: 24
[2025-12-23 11:15:19.011] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 57.0992ms
[2025-12-23 11:15:19.013] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:15:19.021] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 38.6748ms
[2025-12-23 11:15:19.022] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.024] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 70.3664ms
[2025-12-23 11:15:19.028] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:15:19.029] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:15:19.034] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.038] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.040] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 11.5494ms
[2025-12-23 11:15:19.041] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.047] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.042] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:15:19.051] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.054] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.056] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.058] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.061] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.063] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.067] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.071] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 11:15:19.076] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:15:19.081] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.081] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:15:19.086] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:19.088] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:15:19.091] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.7091ms
[2025-12-23 11:15:19.094] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.3237ms
[2025-12-23 11:15:19.096] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.098] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.101] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 58.4045ms
[2025-12-23 11:15:19.103] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 74.431ms
[2025-12-23 11:15:19.107] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:15:19.108] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:15:19.117] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.124] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.126] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 204 null null 18.1266ms
[2025-12-23 11:15:19.127] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 19.3954ms
[2025-12-23 11:15:19.128] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:15:19.130] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:15:19.144] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.148] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.151] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.153] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.154] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.157] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.165] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.169] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.171] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.176] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.180] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.184] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.188] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.193] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:19.198] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:15:19.202] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:15:19.206] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 8670.00, Заказов: 4
[2025-12-23 11:15:19.210] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 11:15:19.212] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:15:19.213] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:15:19.216] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 54.5694ms
[2025-12-23 11:15:19.218] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 51.8176ms
[2025-12-23 11:15:19.220] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.221] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:15:19.223] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 200 null application/json; charset=utf-8 95.0138ms
[2025-12-23 11:15:19.225] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 95.6874ms
[2025-12-23 11:15:19.231] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:15:19.244] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.246] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 14.9178ms
[2025-12-23 11:15:19.251] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:15:19.259] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.260] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:15:19.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.299] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (29ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 11:15:19.305] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 11:15:19.308] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:19.312] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 45.4765ms
[2025-12-23 11:15:19.314] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:15:19.317] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 65.9651ms
[2025-12-23 11:15:19.321] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:15:19.329] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.329] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 8.0176ms
[2025-12-23 11:15:19.332] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:15:19.343] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.345] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:15:19.346] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.377] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 11:15:19.382] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:19.386] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 36.6951ms
[2025-12-23 11:15:19.388] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:15:19.390] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 58.758ms
[2025-12-23 11:15:19.396] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:19.401] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.403] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 6.9629ms
[2025-12-23 11:15:19.405] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:19.413] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.414] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.416] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.423] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 11:15:19.429] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.436] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:19.438] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 16.9559ms
[2025-12-23 11:15:19.441] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.444] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 39.1282ms
[2025-12-23 11:15:19.451] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:19.458] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.460] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 9.3117ms
[2025-12-23 11:15:19.463] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:15:19.473] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:19.475] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.478] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:15:19.482] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 11:15:19.488] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:15:19.493] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:19.495] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 14.861ms
[2025-12-23 11:15:19.498] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:15:19.500] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 36.5888ms
[2025-12-23 11:15:20.078] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:15:20.079] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 11:15:20.084] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 11:15:20.103] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:20.108] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:20.123] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:20.129] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 50.1915ms
[2025-12-23 11:15:20.130] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 51.4771ms
[2025-12-23 11:15:20.132] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:15:20.133] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 50.1837ms
[2025-12-23 11:15:20.133] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 11:15:20.135] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 11:15:20.153] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:20.164] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:20.170] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:20.173] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:15:20.174] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:15:20.177] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:15:20.178] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:15:20.180] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:15:20.189] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 11:15:20.189] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:20.195] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:20.207] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:15:20.228] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (24ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:15:20.231] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:15:20.234] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:15:20.239] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:20.242] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:20.243] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:20.262] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 75.639ms
[2025-12-23 11:15:20.270] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 79.3988ms
[2025-12-23 11:15:20.273] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:15:20.277] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:15:20.279] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 146.9613ms
[2025-12-23 11:15:20.280] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 147.4985ms
[2025-12-23 11:15:20.287] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:15:20.348] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 11:15:20.351] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:20.359] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 163.2657ms
[2025-12-23 11:15:20.361] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:15:20.362] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 227.5576ms
[2025-12-23 11:15:25.975] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - null null
[2025-12-23 11:15:25.983] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:25.986] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - 204 null null 11.2921ms
[2025-12-23 11:15:25.989] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - null null
[2025-12-23 11:15:26.003] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:26.007] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:15:26.013] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:15:26.087] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (32ms) [Parameters=[@__search_0_contains='?' (Size = 200), @__search_0_contains_1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit) AND ([d].[Name] LIKE @__search_0_contains ESCAPE N'\' OR ([d].[Description] IS NOT NULL AND [d].[Description] LIKE @__search_0_contains_1 ESCAPE N'\'))
[2025-12-23 11:15:26.135] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__search_0_contains='?' (Size = 200), @__search_0_contains_1='?' (Size = 500), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit) AND ([d].[Name] LIKE @__search_0_contains ESCAPE N'\' OR ([d].[Description] IS NOT NULL AND [d].[Description] LIKE @__search_0_contains_1 ESCAPE N'\'))
    ORDER BY [d].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:15:26.148] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 2, Всего: 2, Страница: 1, Размер страницы: 1000
[2025-12-23 11:15:26.155] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:26.163] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 142.0678ms
[2025-12-23 11:15:26.166] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:15:26.169] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - 200 null application/json; charset=utf-8 180.4698ms
[2025-12-23 11:15:30.194] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:15:30.199] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:30.200] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 5.8416ms
[2025-12-23 11:15:30.203] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:15:30.213] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:30.215] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:15:30.217] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:15:30.223] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:30.236] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:15:30.241] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:15:30.250] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:30.252] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 30.8296ms
[2025-12-23 11:15:30.254] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:15:30.255] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 52.5291ms
[2025-12-23 11:15:30.258] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:15:30.265] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:30.267] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 8.5768ms
[2025-12-23 11:15:30.269] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:15:30.278] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:30.280] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:15:30.282] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:15:30.287] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:30.293] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:15:30.297] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:15:30.298] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:30.299] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 14.7338ms
[2025-12-23 11:15:30.301] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:15:30.302] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 33.2068ms
[2025-12-23 11:15:30.306] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:15:30.309] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:30.310] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 3.3567ms
[2025-12-23 11:15:30.312] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:15:30.320] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:15:30.322] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:15:30.324] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:15:30.331] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:15:30.343] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:15:30.348] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:15:30.352] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:15:30.354] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 26.845ms
[2025-12-23 11:15:30.356] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:15:30.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 45.4771ms
[2025-12-23 11:17:22.373] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:17:22.381] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:22.383] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 10.4493ms
[2025-12-23 11:17:22.390] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:17:22.431] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:22.434] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:17:22.437] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:17:22.469] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:22.486] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:17:22.494] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:17:22.498] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:22.501] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 40.7414ms
[2025-12-23 11:17:22.507] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:17:22.510] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 119.5824ms
[2025-12-23 11:17:22.519] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:17:22.541] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:22.544] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 25.1701ms
[2025-12-23 11:17:22.548] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:17:22.574] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:22.577] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:17:22.582] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:17:22.611] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:22.628] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:17:22.635] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:17:22.639] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:22.643] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 54.3585ms
[2025-12-23 11:17:22.646] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:17:22.650] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 101.5519ms
[2025-12-23 11:17:22.660] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:17:22.668] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:22.671] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 11.063ms
[2025-12-23 11:17:22.674] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:17:22.687] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:22.689] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:17:22.692] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:17:22.702] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:22.716] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:17:22.723] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:17:22.726] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:22.730] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 33.2721ms
[2025-12-23 11:17:22.733] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:17:22.736] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 62.6221ms
[2025-12-23 11:17:25.263] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:17:25.274] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:25.277] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:17:25.280] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:17:25.297] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:25.308] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:17:25.315] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:17:25.321] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:25.328] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 34.0742ms
[2025-12-23 11:17:25.333] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:17:25.337] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 73.4594ms
[2025-12-23 11:17:25.342] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:17:25.357] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:25.360] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:17:25.363] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:17:25.372] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:25.381] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:17:25.393] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:17:25.397] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:25.400] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 31.9714ms
[2025-12-23 11:17:25.403] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:17:25.406] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 63.4022ms
[2025-12-23 11:17:25.412] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:17:25.423] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:25.426] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:17:25.429] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:17:25.438] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:25.465] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:17:25.473] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:17:25.478] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:25.482] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 47.4062ms
[2025-12-23 11:17:25.485] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:17:25.488] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 75.7739ms
[2025-12-23 11:17:45.933] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:17:45.940] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:45.944] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 10.2819ms
[2025-12-23 11:17:45.948] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:17:45.959] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:45.961] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:17:45.965] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:17:45.972] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:45.978] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:17:45.984] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:17:45.988] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:45.991] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 20.7291ms
[2025-12-23 11:17:45.997] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:17:46.001] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 52.4422ms
[2025-12-23 11:17:46.008] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:17:46.016] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:46.019] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 10.4307ms
[2025-12-23 11:17:46.023] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:17:46.034] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:46.036] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:17:46.040] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:17:46.049] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:46.058] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:17:46.066] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:17:46.069] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:46.071] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 24.8712ms
[2025-12-23 11:17:46.077] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:17:46.079] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 55.7228ms
[2025-12-23 11:17:46.091] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:17:46.099] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:46.100] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 9.8289ms
[2025-12-23 11:17:46.104] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:17:46.114] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:17:46.116] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:17:46.118] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:17:46.123] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:17:46.149] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:17:46.154] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:17:46.157] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:17:46.160] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 39.6471ms
[2025-12-23 11:17:46.164] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:17:46.166] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 62.1539ms
[2025-12-23 11:21:23.155] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:21:23.156] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:21:23.161] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.164] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.166] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview - 204 null null 10.1864ms
[2025-12-23 11:21:23.168] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 12.4477ms
[2025-12-23 11:21:23.169] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview - null null
[2025-12-23 11:21:23.173] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:21:23.185] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.190] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.191] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.193] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.194] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.196] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.207] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.208] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (6ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.213] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.216] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.219] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.220] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.227] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.227] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.233] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[Status]
[2025-12-23 11:21:23.235] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:21:23.235] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 107850.00, Заказов: 27
[2025-12-23 11:21:23.239] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:21:23.240] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:21:23.242] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:21:23.244] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 44.7158ms
[2025-12-23 11:21:23.245] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 45.0112ms
[2025-12-23 11:21:23.247] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.249] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.250] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview - 200 null application/json; charset=utf-8 80.8379ms
[2025-12-23 11:21:23.251] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 78.5607ms
[2025-12-23 11:21:23.257] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.257] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.265] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.268] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.270] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 12.6018ms
[2025-12-23 11:21:23.272] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 204 null null 14.5983ms
[2025-12-23 11:21:23.274] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.275] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.285] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.289] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.291] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.292] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.294] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.295] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.300] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.300] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-12-01T00:00:00.0000000Z", EndDate: "2025-12-31T23:59:59.9990000Z"
[2025-12-23 11:21:23.306] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.313] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.313] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.316] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:23.319] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.320] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 20.6673ms
[2025-12-23 11:21:23.327] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:21:23.327] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.330] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 69290.00, Заказов: 24
[2025-12-23 11:21:23.331] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 56.3202ms
[2025-12-23 11:21:23.333] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:21:23.343] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 45.1517ms
[2025-12-23 11:21:23.345] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.347] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-01T00:00:00.000Z&endDate=2025-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 72.6468ms
[2025-12-23 11:21:23.350] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:21:23.351] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:21:23.359] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.365] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.369] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - null null
[2025-12-23 11:21:23.366] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 204 null null 15.6041ms
[2025-12-23 11:21:23.369] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.376] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.382] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.383] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.387] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.389] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.393] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2025-11-01T00:00:00.0000000Z", EndDate: "2025-11-30T23:59:59.9990000Z"
[2025-12-23 11:21:23.397] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.399] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.402] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.403] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:23.409] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.410] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 17.2614ms
[2025-12-23 11:21:23.414] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:21:23.414] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.417] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 13050.00, Заказов: 1
[2025-12-23 11:21:23.418] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 49.4418ms
[2025-12-23 11:21:23.420] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:21:23.428] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 42.7236ms
[2025-12-23 11:21:23.430] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.431] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-11-01T00:00:00.000Z&endDate=2025-11-30T23:59:59.999Z - 200 null application/json; charset=utf-8 79.7571ms
[2025-12-23 11:21:23.435] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:21:23.436] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:21:23.442] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.445] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.447] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 204 null null 11.1438ms
[2025-12-23 11:21:23.448] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 204 null null 12.1738ms
[2025-12-23 11:21:23.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - null null
[2025-12-23 11:21:23.450] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - null null
[2025-12-23 11:21:23.463] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.468] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.469] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.470] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.472] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.473] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOverview", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOverview(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.478] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.480] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([o].[Total]), 0.0)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.483] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.486] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.489] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.492] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.494] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.497] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:23.499] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:21:23.503] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[Status], COUNT(*) AS [Count]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
GROUP BY [o].[Status]
[2025-12-23 11:21:23.504] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 8670.00, Заказов: 4
[2025-12-23 11:21:23.508] [INF] [RestaurantAPI.Controllers.StatisticsController] Получена общая статистика. Выручка: 20260.00, Заказов: 9
[2025-12-23 11:21:23.510] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:21:23.511] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type '<>f__AnonymousType3`6[[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType2`2[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
[2025-12-23 11:21:23.513] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 36.7262ms
[2025-12-23 11:21:23.515] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi) in 36.1048ms
[2025-12-23 11:21:23.517] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.519] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetOverview (RestaurantApi)'
[2025-12-23 11:21:23.521] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-23T00:00:00.000Z&endDate=2025-12-23T23:59:59.999Z - 200 null application/json; charset=utf-8 71.4442ms
[2025-12-23 11:21:23.523] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/overview?startDate=2025-12-22T00:00:00.000Z&endDate=2025-12-22T23:59:59.999Z - 200 null application/json; charset=utf-8 72.5599ms
[2025-12-23 11:21:23.528] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:21:23.537] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.539] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/top-dishes?top=10 - 204 null null 11.0123ms
[2025-12-23 11:21:23.541] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - null null
[2025-12-23 11:21:23.547] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.548] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:21:23.550] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetTopDishes", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetTopDishes(Int32, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.569] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_0) [o].[DishId], [d].[Name] AS [DishName], [c].[Name] AS [CategoryName], [c].[Id] AS [CategoryId], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COUNT(DISTINCT ([o].[OrderId])) AS [OrderCount]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [o].[DishId], [d].[Name], [c].[Name], [c].[Id]
ORDER BY COALESCE(SUM([o].[Quantity]), 0) DESC
[2025-12-23 11:21:23.573] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен топ 10 блюд
[2025-12-23 11:21:23.575] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType10`7[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:23.576] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi) in 24.2055ms
[2025-12-23 11:21:23.578] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetTopDishes (RestaurantApi)'
[2025-12-23 11:21:23.580] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/top-dishes?top=10 - 200 null application/json; charset=utf-8 38.5803ms
[2025-12-23 11:21:23.585] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:21:23.589] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.591] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-category - 204 null null 6.2689ms
[2025-12-23 11:21:23.594] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - null null
[2025-12-23 11:21:23.600] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.601] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:21:23.603] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByCategory", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByCategory(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime]) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.618] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id] AS [CategoryId], [c].[Name] AS [CategoryName], COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) AS [TotalRevenue], COALESCE(SUM([o].[Quantity]), 0) AS [TotalQuantity]
FROM [OrderItems] AS [o]
INNER JOIN [Orders] AS [o0] ON [o].[OrderId] = [o0].[Id]
INNER JOIN [Dishes] AS [d] ON [o].[DishId] = [d].[Id]
INNER JOIN [Categories] AS [c] ON [d].[CategoryId] = [c].[Id]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o0].[IsDeleted] = CAST(0 AS bit)
GROUP BY [c].[Id], [c].[Name]
ORDER BY COALESCE(SUM([o].[Price] * CAST([o].[Quantity] AS decimal(10,2))), 0.0) DESC
[2025-12-23 11:21:23.622] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType12`4[[System.Guid, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:23.624] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi) in 17.978ms
[2025-12-23 11:21:23.627] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByCategory (RestaurantApi)'
[2025-12-23 11:21:23.628] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-category - 200 null application/json; charset=utf-8 34.6463ms
[2025-12-23 11:21:23.632] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.635] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.636] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 204 null null 3.5217ms
[2025-12-23 11:21:23.638] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.645] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.647] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.649] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.652] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2015-01-01T00:00:00.0000000Z", EndDate: "2035-12-31T23:59:59.9990000Z"
[2025-12-23 11:21:23.656] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.659] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:23.661] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 9.5296ms
[2025-12-23 11:21:23.663] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.664] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2015-01-01T00:00:00.000Z&endDate=2035-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 25.9865ms
[2025-12-23 11:21:23.669] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.673] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.675] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 204 null null 5.5697ms
[2025-12-23 11:21:23.677] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - null null
[2025-12-23 11:21:23.683] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:23.684] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.686] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRevenueByDate", controller = "Statistics"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetRevenueByDate(System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.String) on controller RestaurantAPI.Controllers.StatisticsController (RestaurantApi).
[2025-12-23 11:21:23.690] [INF] [RestaurantAPI.Controllers.StatisticsController] Получен запрос статистики выручки по датам. Period: day (нормализован: day), StartDate: "2023-01-01T00:00:00.0000000Z", EndDate: "2026-12-31T23:59:59.9990000Z"
[2025-12-23 11:21:23.693] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__utcStartDate_0='?' (DbType = DateTime), @__utcEndDate_1='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
SELECT [o].[CreatedAt] AS [Date], [o].[Total]
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit) AND [o].[CreatedAt] >= @__utcStartDate_0 AND [o].[CreatedAt] <= @__utcEndDate_1
[2025-12-23 11:21:23.696] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[<>f__AnonymousType5`3[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:23.702] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi) in 13.2165ms
[2025-12-23 11:21:23.704] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.StatisticsController.GetRevenueByDate (RestaurantApi)'
[2025-12-23 11:21:23.706] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Statistics/revenue-by-date?period=day&startDate=2023-01-01T00:00:00.000Z&endDate=2026-12-31T23:59:59.999Z - 200 null application/json; charset=utf-8 28.8797ms
[2025-12-23 11:21:24.696] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:21:24.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories - null null
[2025-12-23 11:21:24.699] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 11:21:24.702] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:24.708] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:24.716] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:24.719] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 22.8442ms
[2025-12-23 11:21:24.724] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories - 204 null null 25.3137ms
[2025-12-23 11:21:24.725] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:21:24.726] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 26.7679ms
[2025-12-23 11:21:24.728] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories - null null
[2025-12-23 11:21:24.729] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 11:21:24.743] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:24.751] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:24.756] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:24.758] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:21:24.759] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:21:24.760] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:21:24.762] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:21:24.763] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:21:24.764] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 11:21:24.768] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:24.775] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:24.778] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:24.781] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:21:24.783] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:21:24.786] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:21:24.786] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:21:24.789] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:21:24.793] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 11:21:24.794] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:24.796] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:24.798] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:24.800] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 33.6861ms
[2025-12-23 11:21:24.802] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 32.9727ms
[2025-12-23 11:21:24.805] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 32.1763ms
[2025-12-23 11:21:24.807] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:21:24.809] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:21:24.811] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:21:24.812] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 87.1916ms
[2025-12-23 11:21:24.814] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories - 200 null application/json; charset=utf-8 85.9654ms
[2025-12-23 11:21:24.816] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 87.0334ms
[2025-12-23 11:21:27.152] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - null null
[2025-12-23 11:21:27.162] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:27.164] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - 204 null null 11.9011ms
[2025-12-23 11:21:27.166] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - null null
[2025-12-23 11:21:27.170] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:27.172] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:21:27.173] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:21:27.180] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__search_0_contains='?' (Size = 200), @__search_0_contains_1='?' (Size = 500)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit) AND ([d].[Name] LIKE @__search_0_contains ESCAPE N'\' OR ([d].[Description] IS NOT NULL AND [d].[Description] LIKE @__search_0_contains_1 ESCAPE N'\'))
[2025-12-23 11:21:27.188] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__search_0_contains='?' (Size = 200), @__search_0_contains_1='?' (Size = 500), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit) AND ([d].[Name] LIKE @__search_0_contains ESCAPE N'\' OR ([d].[Description] IS NOT NULL AND [d].[Description] LIKE @__search_0_contains_1 ESCAPE N'\'))
    ORDER BY [d].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:21:27.191] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 2, Всего: 2, Страница: 1, Размер страницы: 1000
[2025-12-23 11:21:27.194] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:27.196] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 19.9953ms
[2025-12-23 11:21:27.197] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:21:27.199] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?search=bowl&pageSize=1000 - 200 null application/json; charset=utf-8 33.0922ms
[2025-12-23 11:21:29.611] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 11:21:29.617] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:29.620] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=1000 - 204 null null 9.0808ms
[2025-12-23 11:21:29.623] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - null null
[2025-12-23 11:21:29.633] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:29.635] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:21:29.639] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 11:21:29.648] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:29.659] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:21:29.665] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 11:21:29.668] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:29.669] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 26.7318ms
[2025-12-23 11:21:29.672] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:21:29.674] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=1000 - 200 null application/json; charset=utf-8 51.0093ms
[2025-12-23 11:21:32.130] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?search=%D0%BE%D1%81%D0%BD%D0%BE&pageSize=1000 - null null
[2025-12-23 11:21:32.136] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:32.137] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?search=%D0%BE%D1%81%D0%BD%D0%BE&pageSize=1000 - 204 null null 6.7241ms
[2025-12-23 11:21:32.139] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?search=%D0%BE%D1%81%D0%BD%D0%BE&pageSize=1000 - null null
[2025-12-23 11:21:32.144] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:32.145] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:21:32.146] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 11:21:32.156] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__search_0_contains='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[Name] LIKE @__search_0_contains ESCAPE N'\'
[2025-12-23 11:21:32.179] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (14ms) [Parameters=[@__search_0_contains='?' (Size = 100), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[Name] LIKE @__search_0_contains ESCAPE N'\'
ORDER BY [m].[Name]
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
[2025-12-23 11:21:32.183] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 1, Всего: 1, Страница: 1
[2025-12-23 11:21:32.185] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:32.186] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 37.7958ms
[2025-12-23 11:21:32.189] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:21:32.190] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?search=%D0%BE%D1%81%D0%BD%D0%BE&pageSize=1000 - 200 null application/json; charset=utf-8 51.2438ms
[2025-12-23 11:21:33.630] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 11:21:33.637] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:33.639] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?pageSize=1000 - 204 null null 8.6406ms
[2025-12-23 11:21:33.642] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - null null
[2025-12-23 11:21:33.651] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:33.654] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:21:33.657] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 11:21:33.665] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:33.676] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit)
ORDER BY [i].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:21:33.680] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 24, Всего: 24, Страница: 1
[2025-12-23 11:21:33.682] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:33.683] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 22.0343ms
[2025-12-23 11:21:33.685] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:21:33.686] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?pageSize=1000 - 200 null application/json; charset=utf-8 43.8935ms
[2025-12-23 11:21:36.306] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?search=%D0%B1%D1%83%D0%BB%D0%BE%D1%87&pageSize=1000 - null null
[2025-12-23 11:21:36.311] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:36.312] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Ingredients?search=%D0%B1%D1%83%D0%BB%D0%BE%D1%87&pageSize=1000 - 204 null null 6.2262ms
[2025-12-23 11:21:36.314] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Ingredients?search=%D0%B1%D1%83%D0%BB%D0%BE%D1%87&pageSize=1000 - null null
[2025-12-23 11:21:36.319] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:36.321] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:21:36.322] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetIngredients", controller = "Ingredients"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.IngredientReadDto]]] GetIngredients(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.IngredientsController (RestaurantApi).
[2025-12-23 11:21:36.334] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__search_0_contains='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit) AND [i].[Name] LIKE @__search_0_contains ESCAPE N'\'
[2025-12-23 11:21:36.346] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__search_0_contains='?' (Size = 100), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [i].[Id], [i].[CreatedAt], [i].[CreatedBy], [i].[DeletedAt], [i].[DeletedBy], [i].[IsDeleted], [i].[Name], [i].[Notes], [i].[UpdatedAt], [i].[UpdatedBy]
FROM [Ingredients] AS [i]
WHERE [i].[IsDeleted] = CAST(0 AS bit) AND [i].[Name] LIKE @__search_0_contains ESCAPE N'\'
ORDER BY [i].[Name]
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
[2025-12-23 11:21:36.349] [INF] [RestaurantAPI.Controllers.IngredientsController] Получен список ингредиентов. Количество: 1, Всего: 1, Страница: 1
[2025-12-23 11:21:36.351] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.IngredientReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:36.353] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi) in 28.1633ms
[2025-12-23 11:21:36.356] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.IngredientsController.GetIngredients (RestaurantApi)'
[2025-12-23 11:21:36.357] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Ingredients?search=%D0%B1%D1%83%D0%BB%D0%BE%D1%87&pageSize=1000 - 200 null application/json; charset=utf-8 43.4289ms
[2025-12-23 11:21:37.470] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=1000 - null null
[2025-12-23 11:21:37.478] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:37.480] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=1000 - 204 null null 9.7498ms
[2025-12-23 11:21:37.483] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=1000 - null null
[2025-12-23 11:21:37.493] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:37.495] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:21:37.499] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:21:37.508] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:37.514] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:21:37.517] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:21:37.519] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:37.521] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 18.8258ms
[2025-12-23 11:21:37.524] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:21:37.526] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=1000 - 200 null application/json; charset=utf-8 42.9006ms
[2025-12-23 11:21:39.931] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?search=%D0%B1%D1%83%D1%80&pageSize=1000 - null null
[2025-12-23 11:21:39.937] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:39.938] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?search=%D0%B1%D1%83%D1%80&pageSize=1000 - 204 null null 7.4922ms
[2025-12-23 11:21:39.940] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?search=%D0%B1%D1%83%D1%80&pageSize=1000 - null null
[2025-12-23 11:21:39.946] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:39.948] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:21:39.948] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:21:39.959] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__search_0_contains='?' (Size = 100), @__search_0_contains_1='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND ([c].[Name] LIKE @__search_0_contains ESCAPE N'\' OR ([c].[Notes] IS NOT NULL AND [c].[Notes] LIKE @__search_0_contains_1 ESCAPE N'\'))
[2025-12-23 11:21:39.973] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__search_0_contains='?' (Size = 100), @__search_0_contains_1='?' (Size = 4000), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit) AND ([c].[Name] LIKE @__search_0_contains ESCAPE N'\' OR ([c].[Notes] IS NOT NULL AND [c].[Notes] LIKE @__search_0_contains_1 ESCAPE N'\'))
ORDER BY [c].[Name]
OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
[2025-12-23 11:21:39.976] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 1, Всего: 1, Страница: 1
[2025-12-23 11:21:39.977] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:39.978] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 28.2099ms
[2025-12-23 11:21:39.980] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:21:39.981] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?search=%D0%B1%D1%83%D1%80&pageSize=1000 - 200 null application/json; charset=utf-8 40.9965ms
[2025-12-23 11:21:41.153] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:21:41.154] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Roles - null null
[2025-12-23 11:21:41.159] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:41.167] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:41.168] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Users?pageSize=1000 - 204 null null 15.3651ms
[2025-12-23 11:21:41.170] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Roles - 204 null null 16.1984ms
[2025-12-23 11:21:41.172] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:21:41.178] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Roles - null null
[2025-12-23 11:21:41.187] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:41.192] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:41.193] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:21:41.196] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 11:21:41.197] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:21:41.203] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetRoles", controller = "Roles"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.RoleReadDto]]] GetRoles(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.RolesController (RestaurantApi).
[2025-12-23 11:21:41.206] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:41.216] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:21:41.220] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:21:41.222] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:41.225] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 24.2205ms
[2025-12-23 11:21:41.227] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:21:41.229] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 57.474ms
[2025-12-23 11:21:41.231] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:41.257] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM [Roles] AS [r]
WHERE [r].[IsDeleted] = CAST(0 AS bit)
ORDER BY [r].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:21:41.265] [INF] [RestaurantAPI.Controllers.RolesController] Получен список ролей. Количество: 3, Всего: 3, Страница: 1
[2025-12-23 11:21:41.269] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.RoleReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:41.279] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi) in 71.8703ms
[2025-12-23 11:21:41.282] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.RolesController.GetRoles (RestaurantApi)'
[2025-12-23 11:21:41.283] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Roles - 200 null application/json; charset=utf-8 105.2975ms
[2025-12-23 11:21:44.162] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - null null
[2025-12-23 11:21:44.167] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:44.169] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:21:44.171] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetUsers", controller = "Users"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.UserReadDto]]] GetUsers(System.Nullable`1[System.Guid], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.UsersController (RestaurantApi).
[2025-12-23 11:21:44.178] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Users] AS [u]
WHERE [u].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:44.184] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [u0].[Id], [u0].[CreatedAt], [u0].[CreatedBy], [u0].[DeletedAt], [u0].[DeletedBy], [u0].[IsDeleted], [u0].[Notes], [u0].[PasswordHash], [u0].[RoleId], [u0].[UpdatedAt], [u0].[UpdatedBy], [u0].[Username], [r].[Id], [r].[CreatedAt], [r].[CreatedBy], [r].[DeletedAt], [r].[DeletedBy], [r].[IsDeleted], [r].[Name], [r].[Notes], [r].[UpdatedAt], [r].[UpdatedBy]
FROM (
    SELECT [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
    FROM [Users] AS [u]
    WHERE [u].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [u].[Username]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [u0]
INNER JOIN [Roles] AS [r] ON [u0].[RoleId] = [r].[Id]
ORDER BY [u0].[Username]
[2025-12-23 11:21:44.189] [INF] [RestaurantAPI.Controllers.UsersController] Получен список пользователей. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:21:44.191] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.UserReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:44.193] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi) in 17.6714ms
[2025-12-23 11:21:44.195] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.UsersController.GetUsers (RestaurantApi)'
[2025-12-23 11:21:44.197] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Users?pageSize=1000 - 200 null application/json; charset=utf-8 34.9807ms
[2025-12-23 11:21:44.200] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:21:44.204] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:44.205] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 5.7359ms
[2025-12-23 11:21:44.208] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:21:44.213] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:44.214] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:21:44.215] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:21:44.221] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:44.228] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:21:44.232] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:21:44.234] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:44.236] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 18.3382ms
[2025-12-23 11:21:44.238] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:21:44.240] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 31.8866ms
[2025-12-23 11:21:44.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:21:44.249] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:44.250] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 204 null null 5.0274ms
[2025-12-23 11:21:44.252] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - null null
[2025-12-23 11:21:44.258] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:21:44.259] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:21:44.260] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetOrders", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetOrders(System.Nullable`1[System.Guid], System.String, System.Nullable`1[System.DateTime], System.Nullable`1[System.DateTime], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.OrdersController (RestaurantApi).
[2025-12-23 11:21:44.265] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
WHERE [o].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:21:44.274] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [o0].[Id], [o0].[CreatedAt], [o0].[CreatedBy], [o0].[DeletedAt], [o0].[DeletedBy], [o0].[IsDeleted], [o0].[Notes], [o0].[Status], [o0].[Total], [o0].[UpdatedAt], [o0].[UpdatedBy], [o0].[UserId], [u].[Id], [u].[CreatedAt], [u].[CreatedBy], [u].[DeletedAt], [u].[DeletedBy], [u].[IsDeleted], [u].[Notes], [u].[PasswordHash], [u].[RoleId], [u].[UpdatedAt], [u].[UpdatedBy], [u].[Username]
FROM (
    SELECT [o].[Id], [o].[CreatedAt], [o].[CreatedBy], [o].[DeletedAt], [o].[DeletedBy], [o].[IsDeleted], [o].[Notes], [o].[Status], [o].[Total], [o].[UpdatedAt], [o].[UpdatedBy], [o].[UserId]
    FROM [Orders] AS [o]
    WHERE [o].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [o].[CreatedAt] DESC
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [o0]
INNER JOIN [Users] AS [u] ON [o0].[UserId] = [u].[Id]
ORDER BY [o0].[CreatedAt] DESC
[2025-12-23 11:21:44.277] [INF] [RestaurantAPI.Controllers.OrdersController] Получен список заказов. Количество: 20, Всего: 27, Страница: 1
[2025-12-23 11:21:44.279] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.OrderReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:21:44.280] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi) in 17.9857ms
[2025-12-23 11:21:44.282] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.OrdersController.GetOrders (RestaurantApi)'
[2025-12-23 11:21:44.284] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Orders?page=1&pageSize=20&sortBy=createdAt&order=desc - 200 null application/json; charset=utf-8 31.7585ms
[2025-12-23 11:22:56.564] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 11:22:56.565] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 11:22:56.566] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:22:56.570] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.575] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.579] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.580] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Menus?pageSize=100 - 204 null null 15.6227ms
[2025-12-23 11:22:56.581] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Categories?pageSize=100 - 204 null null 16.4704ms
[2025-12-23 11:22:56.583] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/Dishes?pageSize=1000 - 204 null null 16.6774ms
[2025-12-23 11:22:56.587] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - null null
[2025-12-23 11:22:56.588] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - null null
[2025-12-23 11:22:56.588] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - null null
[2025-12-23 11:22:56.601] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.606] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.609] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.610] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:22:56.611] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:22:56.612] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:22:56.613] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenus", controller = "Menus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.MenuReadDto]]] GetMenus(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenusController (RestaurantApi).
[2025-12-23 11:22:56.614] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetCategories", controller = "Categories"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.CategoryReadDto]]] GetCategories(System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.CategoriesController (RestaurantApi).
[2025-12-23 11:22:56.616] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetDishes", controller = "Dishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[RestaurantAPI.Helpers.PagedResult`1[RestaurantAPI.DTOs.DishReadDto]]] GetDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Decimal], System.Nullable`1[System.Decimal], System.String, System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.DishesController (RestaurantApi).
[2025-12-23 11:22:56.624] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:22:56.625] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:22:56.627] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Dishes] AS [d]
WHERE [d].[IsDeleted] = CAST(0 AS bit)
[2025-12-23 11:22:56.630] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[CreatedAt], [m].[CreatedBy], [m].[DeletedAt], [m].[DeletedBy], [m].[IsDeleted], [m].[Name], [m].[Notes], [m].[UpdatedAt], [m].[UpdatedBy]
FROM [Menus] AS [m]
WHERE [m].[IsDeleted] = CAST(0 AS bit)
ORDER BY [m].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:22:56.632] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM [Categories] AS [c]
WHERE [c].[IsDeleted] = CAST(0 AS bit)
ORDER BY [c].[Name]
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
[2025-12-23 11:22:56.637] [INF] [RestaurantAPI.Controllers.MenusController] Получен список меню. Количество: 2, Всего: 2, Страница: 1
[2025-12-23 11:22:56.639] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [d0].[Id], [d0].[CategoryId], [d0].[CreatedAt], [d0].[CreatedBy], [d0].[DeletedAt], [d0].[DeletedBy], [d0].[Description], [d0].[IsDeleted], [d0].[Name], [d0].[Notes], [d0].[Price], [d0].[UpdatedAt], [d0].[UpdatedBy], [c].[Id], [c].[CreatedAt], [c].[CreatedBy], [c].[DeletedAt], [c].[DeletedBy], [c].[IsDeleted], [c].[Name], [c].[Notes], [c].[UpdatedAt], [c].[UpdatedBy]
FROM (
    SELECT [d].[Id], [d].[CategoryId], [d].[CreatedAt], [d].[CreatedBy], [d].[DeletedAt], [d].[DeletedBy], [d].[Description], [d].[IsDeleted], [d].[Name], [d].[Notes], [d].[Price], [d].[UpdatedAt], [d].[UpdatedBy]
    FROM [Dishes] AS [d]
    WHERE [d].[IsDeleted] = CAST(0 AS bit)
    ORDER BY [d].[Name]
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [d0]
INNER JOIN [Categories] AS [c] ON [d0].[CategoryId] = [c].[Id]
ORDER BY [d0].[Name]
[2025-12-23 11:22:56.640] [INF] [RestaurantAPI.Controllers.CategoriesController] Получен список категорий. Количество: 6, Всего: 6, Страница: 1
[2025-12-23 11:22:56.641] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:22:56.644] [INF] [RestaurantAPI.Controllers.DishesController] Получен список блюд. Количество: 13, Всего: 13, Страница: 1, Размер страницы: 1000
[2025-12-23 11:22:56.645] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.CategoryReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:22:56.647] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi) in 28.8903ms
[2025-12-23 11:22:56.649] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.DishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:22:56.650] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi) in 29.2904ms
[2025-12-23 11:22:56.652] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenusController.GetMenus (RestaurantApi)'
[2025-12-23 11:22:56.654] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi) in 30.7512ms
[2025-12-23 11:22:56.656] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.CategoriesController.GetCategories (RestaurantApi)'
[2025-12-23 11:22:56.658] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Menus?pageSize=100 - 200 null application/json; charset=utf-8 70.4856ms
[2025-12-23 11:22:56.659] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.DishesController.GetDishes (RestaurantApi)'
[2025-12-23 11:22:56.661] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Categories?pageSize=100 - 200 null application/json; charset=utf-8 73.0006ms
[2025-12-23 11:22:56.661] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 11:22:56.665] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/Dishes?pageSize=1000 - 200 null application/json; charset=utf-8 77.0671ms
[2025-12-23 11:22:56.674] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.678] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 204 null null 17.3817ms
[2025-12-23 11:22:56.680] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 11:22:56.686] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:56.687] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:22:56.689] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 11:22:56.696] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (4ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 11:22:56.705] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (5ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 11:22:56.708] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 11:22:56.710] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:22:56.712] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 20.7761ms
[2025-12-23 11:22:56.714] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:22:56.715] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 34.4181ms
[2025-12-23 11:22:58.238] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=d924f034-6328-41f0-8171-8cd320874a7f&pageSize=1000 - null null
[2025-12-23 11:22:58.242] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:58.243] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=d924f034-6328-41f0-8171-8cd320874a7f&pageSize=1000 - 204 null null 5.2507ms
[2025-12-23 11:22:58.245] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=d924f034-6328-41f0-8171-8cd320874a7f&pageSize=1000 - null null
[2025-12-23 11:22:58.250] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:22:58.250] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:22:58.252] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 11:22:58.257] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 11:22:58.260] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 11:22:58.263] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 4, Всего: 4, Страница: 1
[2025-12-23 11:22:58.264] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:22:58.266] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 11.0141ms
[2025-12-23 11:22:58.267] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:22:58.269] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=d924f034-6328-41f0-8171-8cd320874a7f&pageSize=1000 - 200 null application/json; charset=utf-8 23.6947ms
[2025-12-23 11:23:05.423] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 11:23:05.426] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:23:05.427] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 OPTIONS https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 204 null null 4.5048ms
[2025-12-23 11:23:05.429] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request starting HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - null null
[2025-12-23 11:23:05.433] [INF] [Microsoft.AspNetCore.Cors.Infrastructure.CorsService] CORS policy execution successful.
[2025-12-23 11:23:05.434] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executing endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:23:05.437] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Route matched with {action = "GetMenuDishes", controller = "MenuDishes"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult] GetMenuDishes(System.Nullable`1[System.Guid], System.Nullable`1[System.Guid], System.String, System.String, Int32, Int32) on controller RestaurantAPI.Controllers.MenuDishesController (RestaurantApi).
[2025-12-23 11:23:05.441] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid)], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [MenuDishes] AS [m]
INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
[2025-12-23 11:23:05.445] [INF] [Microsoft.EntityFrameworkCore.Database.Command] Executed DbCommand (1ms) [Parameters=[@__menuId_Value_0='?' (DbType = Guid), @__p_1='?' (DbType = Int32), @__p_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[MenuId], [s].[Name] AS [MenuName], [s].[DishId], [d].[Name] AS [DishName]
FROM (
    SELECT [m].[Id], [m].[DishId], [m].[MenuId], [m0].[Name]
    FROM [MenuDishes] AS [m]
    INNER JOIN [Menus] AS [m0] ON [m].[MenuId] = [m0].[Id]
    WHERE [m].[IsDeleted] = CAST(0 AS bit) AND [m].[MenuId] = @__menuId_Value_0
    ORDER BY [m0].[Name]
    OFFSET @__p_1 ROWS FETCH NEXT @__p_2 ROWS ONLY
) AS [s]
INNER JOIN [Dishes] AS [d] ON [s].[DishId] = [d].[Id]
ORDER BY [s].[Name]
[2025-12-23 11:23:05.447] [INF] [RestaurantAPI.Controllers.MenuDishesController] Получен список блюд в меню. Количество: 9, Всего: 9, Страница: 1
[2025-12-23 11:23:05.449] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ObjectResultExecutor] Executing OkObjectResult, writing value of type 'RestaurantAPI.Helpers.PagedResult`1[[RestaurantAPI.DTOs.MenuDishReadDto, RestaurantApi, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
[2025-12-23 11:23:05.450] [INF] [Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker] Executed action RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi) in 11.4154ms
[2025-12-23 11:23:05.453] [INF] [Microsoft.AspNetCore.Routing.EndpointMiddleware] Executed endpoint 'RestaurantAPI.Controllers.MenuDishesController.GetMenuDishes (RestaurantApi)'
[2025-12-23 11:23:05.454] [INF] [Microsoft.AspNetCore.Hosting.Diagnostics] Request finished HTTP/2 GET https://localhost:7188/api/MenuDishes?menuId=b7126bb9-2192-4a2c-a076-283d39c30d68&pageSize=1000 - 200 null application/json; charset=utf-8 24.9746ms
